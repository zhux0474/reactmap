{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.TimeLayerSliderPanel = void 0;\n\nrequire(\"antd/es/popover/style\");\n\nvar _popover = _interopRequireDefault(require(\"antd/es/popover\"));\n\nrequire(\"antd/es/select/style\");\n\nvar _select = _interopRequireDefault(require(\"antd/es/select\"));\n\nrequire(\"antd/es/date-picker/style\");\n\nvar _datePicker = _interopRequireDefault(require(\"antd/es/date-picker\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _ol = require(\"ol\");\n\nvar _isFinite2 = _interopRequireDefault(require(\"lodash/isFinite\"));\n\nvar _isEqual2 = _interopRequireDefault(require(\"lodash/isEqual\"));\n\nvar _TimeLayerAware = _interopRequireDefault(require(\"../../HigherOrderComponent/TimeLayerAware/TimeLayerAware\"));\n\nvar _TimeSlider = _interopRequireDefault(require(\"../../Slider/TimeSlider/TimeSlider\"));\n\nvar _SimpleButton = _interopRequireDefault(require(\"../../Button/SimpleButton/SimpleButton\"));\n\nvar _ToggleButton = _interopRequireDefault(require(\"../../Button/ToggleButton/ToggleButton\"));\n\nrequire(\"./TimeLayerSliderPanel.less\");\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar RangePicker = _datePicker[\"default\"].RangePicker;\nvar Option = _select[\"default\"].Option;\n/**\n * The panel combining all time slider related parts.\n */\n\nvar TimeLayerSliderPanel = /*#__PURE__*/function (_React$Component) {\n  _inherits(TimeLayerSliderPanel, _React$Component);\n\n  var _super = _createSuper(TimeLayerSliderPanel);\n  /**\n   * The default props of LayerSetBaseMapChooser\n   *\n   * @static\n   * @memberof LayerSetBaseMapChooser\n   */\n\n  /**\n   * Constructs time panel.\n   */\n\n\n  function TimeLayerSliderPanel(props) {\n    var _this;\n\n    _classCallCheck(this, TimeLayerSliderPanel);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"_TimeLayerAwareSlider\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_wmsTimeLayers\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_interval\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"wrapTimeSlider\", function () {\n      _this._wmsTimeLayers = [];\n\n      _this.props.timeAwareLayers.forEach(function (l) {\n        if (l.get('type') === 'WMSTime') {\n          _this._wmsTimeLayers.push({\n            layer: l\n          });\n        }\n      }); // make sure an initial value is set\n\n\n      _this.wmsTimeHandler(_this.state.value);\n\n      _this._TimeLayerAwareSlider = (0, _TimeLayerAware[\"default\"])(_TimeSlider[\"default\"], _this._wmsTimeLayers);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"findRangeForLayers\", function () {\n      var timeAwareLayers = _this.props.timeAwareLayers;\n      var _this$state = _this.state,\n          startDate = _this$state.startDate,\n          endDate = _this$state.endDate;\n\n      if (timeAwareLayers.length === 0) {\n        return;\n      }\n\n      var startDatesFromLayers = [];\n      var endDatesFromLayers = [];\n\n      _this._wmsTimeLayers.forEach(function (l) {\n        var layerStartDate = l.layer.get('startDate');\n        var layerEndDate = l.layer.get('endDate');\n        var sdm;\n        var edm;\n\n        if (layerStartDate) {\n          sdm = (0, _moment[\"default\"])(l.layer.get('startDate'));\n        }\n\n        if (layerEndDate) {\n          edm = (0, _moment[\"default\"])(l.layer.get('endDate'));\n        }\n\n        if (sdm) {\n          startDatesFromLayers.push(sdm);\n        }\n\n        if (edm) {\n          endDatesFromLayers.push(edm);\n        }\n      });\n\n      var newStartDate = startDatesFromLayers.length > 0 ? _moment[\"default\"].min(startDatesFromLayers) : startDate;\n      var newEndDate = endDatesFromLayers.length > 0 ? _moment[\"default\"].max(endDatesFromLayers) : endDate;\n\n      _this.updateDataRange([newStartDate, newEndDate]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"timeSliderCustomHandler\", function (value) {\n      var currentMoment = (0, _moment[\"default\"])(value).milliseconds(0);\n      var newValue = currentMoment.clone();\n\n      _this.setState({\n        value: newValue\n      });\n\n      if (_this.props.onChange) {\n        _this.props.onChange(newValue);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"wmsTimeHandler\", function (value) {\n      _this._wmsTimeLayers.forEach(function (config) {\n        if (config.layer && config.layer.get('type') === 'WMSTime') {\n          var _config$layer$getSour, _config$layer$getSour2;\n\n          var params = (_config$layer$getSour = config.layer.getSource()) === null || _config$layer$getSour === void 0 ? void 0 : _config$layer$getSour.getParams();\n          var time;\n\n          if (Array.isArray(value)) {\n            time = value[0];\n          } else {\n            time = value;\n          }\n\n          if (!_moment[\"default\"].isMoment(time)) {\n            time = (0, _moment[\"default\"])(time);\n          }\n\n          var timeFormat = config.layer.get('timeFormat');\n\n          if (timeFormat.toLowerCase().indexOf('hh') > 0 && config.layer.get('roundToFullHours')) {\n            time.set('minute', 0);\n            time.set('second', 0);\n            params.TIME = time.toISOString();\n          } else {\n            params.TIME = time.format(timeFormat);\n          }\n\n          (_config$layer$getSour2 = config.layer.getSource()) === null || _config$layer$getSour2 === void 0 ? void 0 : _config$layer$getSour2.updateParams(params);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onPlaybackSpeedChange\", function (val) {\n      var valueToSet;\n\n      if ((0, _isFinite2[\"default\"])(parseFloat(val))) {\n        valueToSet = parseFloat(val);\n      } else {\n        valueToSet = val;\n      }\n\n      _this.setState({\n        playbackSpeed: valueToSet\n      }, function () {\n        if (_this.state.autoPlayActive) {\n          _this.autoPlay(true);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSliderToNow\", function () {\n      var now = (0, _moment[\"default\"])().milliseconds(0);\n\n      _this.setState({\n        value: now,\n        endDate: now\n      }, function () {\n        _this.timeSliderCustomHandler(now);\n\n        _this.wmsTimeHandler(now);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"render\", function () {\n      var _this$props = _this.props,\n          className = _this$props.className,\n          timeAwareLayers = _this$props.timeAwareLayers,\n          dateFormat = _this$props.dateFormat,\n          tooltips = _this$props.tooltips,\n          autoPlaySpeedOptions = _this$props.autoPlaySpeedOptions;\n      var _this$state2 = _this.state,\n          autoPlayActive = _this$state2.autoPlayActive,\n          value = _this$state2.value,\n          startDate = _this$state2.startDate,\n          endDate = _this$state2.endDate;\n      var resetVisible = true;\n      var startDateString = startDate.toISOString();\n      var endDateString = endDate.toISOString();\n      var valueString = value.toISOString();\n      var mid = startDate.clone().add(endDate.diff(startDate) / 2);\n      var marks = {};\n      var futureClass = (0, _moment[\"default\"])().isBefore(value) ? ' timeslider-in-future' : '';\n      var extraCls = className ? className : '';\n      var disabledCls = timeAwareLayers.length < 1 ? 'no-layers-available' : '';\n      marks[startDateString] = {\n        label: startDate.format(dateFormat)\n      };\n      marks[endDateString] = {\n        label: endDate.format(dateFormat),\n        style: {\n          left: 'unset',\n          right: 0,\n          transform: 'translate(50%)'\n        }\n      };\n      marks[mid.toISOString()] = {\n        label: mid.format(dateFormat)\n      };\n      var speedOptions = autoPlaySpeedOptions.map(function (val) {\n        return /*#__PURE__*/React.createElement(Option, {\n          key: val,\n          value: val\n        }, val);\n      });\n      var TimeLayerAwareSlider = _this._TimeLayerAwareSlider;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"time-layer-slider \".concat(disabledCls).trim()\n      }, /*#__PURE__*/React.createElement(_popover[\"default\"], {\n        placement: \"topRight\",\n        title: tooltips.dataRange,\n        trigger: \"click\",\n        content: /*#__PURE__*/React.createElement(RangePicker, {\n          showTime: {\n            format: 'HH:mm'\n          },\n          defaultValue: [startDate, endDate],\n          onOk: _this.updateDataRange\n        })\n      }, /*#__PURE__*/React.createElement(_SimpleButton[\"default\"], {\n        className: \"change-datarange-button\",\n        iconName: \"calendar\"\n      })), resetVisible ? /*#__PURE__*/React.createElement(_SimpleButton[\"default\"], {\n        type: \"primary\",\n        iconName: \"sync\",\n        onClick: _this.setSliderToNow,\n        tooltip: tooltips.setToNow\n      }) : null, /*#__PURE__*/React.createElement(TimeLayerAwareSlider, {\n        className: \"\".concat(extraCls, \" timeslider \").concat(futureClass).trim(),\n        formatString: dateFormat,\n        defaultValue: startDateString,\n        min: startDateString,\n        max: endDateString,\n        value: valueString,\n        marks: marks,\n        onChange: _this.onTimeChanged\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"time-value\"\n      }, value.format('DD.MM.YYYY HH:mm:ss')), /*#__PURE__*/React.createElement(_ToggleButton[\"default\"], {\n        type: \"primary\",\n        iconName: \"play-circle\",\n        className: extraCls + ' playback',\n        pressed: autoPlayActive,\n        onToggle: _this.autoPlay,\n        tooltip: autoPlayActive ? 'Pause' : 'Autoplay',\n        \"aria-label\": autoPlayActive ? 'Pause' : 'Autoplay',\n        pressedIconName: \"pause-circle\"\n      }), /*#__PURE__*/React.createElement(_select[\"default\"], {\n        defaultValue: '1',\n        className: extraCls + ' speed-picker',\n        onChange: _this.onPlaybackSpeedChange\n      }, speedOptions, /*#__PURE__*/React.createElement(Option, {\n        value: \"hours\"\n      }, tooltips.hours), /*#__PURE__*/React.createElement(Option, {\n        value: \"days\"\n      }, tooltips.days), /*#__PURE__*/React.createElement(Option, {\n        value: \"weeks\"\n      }, tooltips.weeks), /*#__PURE__*/React.createElement(Option, {\n        value: \"months\"\n      }, tooltips.months), /*#__PURE__*/React.createElement(Option, {\n        value: \"years\"\n      }, tooltips.years)));\n    });\n\n    _this.state = {\n      value: (0, _moment[\"default\"])().milliseconds(0),\n      playbackSpeed: 1,\n      autoPlayActive: false,\n      startDate: (0, _moment[\"default\"])().milliseconds(0),\n      endDate: (0, _moment[\"default\"])().milliseconds(0)\n    };\n    _this._interval = 1000;\n\n    _this.wrapTimeSlider(); // binds\n\n\n    _this.onTimeChanged = _this.onTimeChanged.bind(_assertThisInitialized(_this));\n    _this.autoPlay = _this.autoPlay.bind(_assertThisInitialized(_this));\n    _this.updateDataRange = _this.updateDataRange.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(TimeLayerSliderPanel, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props2 = this.props,\n          initStartDate = _this$props2.initStartDate,\n          initEndDate = _this$props2.initEndDate;\n      this.setState({\n        startDate: initStartDate,\n        endDate: initEndDate\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this2 = this;\n\n      prevProps.timeAwareLayers.forEach(function (pl, i) {\n        var tpl = _this2.props.timeAwareLayers[i];\n\n        if (!(0, _isEqual2[\"default\"])((0, _ol.getUid)(pl), (0, _ol.getUid)(tpl))) {\n          // update slider properties if layers were updated\n          _this2.wrapTimeSlider();\n\n          _this2.findRangeForLayers();\n        }\n      });\n    }\n    /**\n     *\n     * @param nextProps\n     * @param nextState\n     */\n\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      var _this$state3 = this.state,\n          value = _this$state3.value,\n          autoPlayActive = _this$state3.autoPlayActive,\n          startDate = _this$state3.startDate,\n          endDate = _this$state3.endDate;\n      var _this$props3 = this.props,\n          timeAwareLayers = _this$props3.timeAwareLayers,\n          tooltips = _this$props3.tooltips;\n\n      if (nextState.value !== value) {\n        return true;\n      }\n\n      if (nextState.autoPlayActive !== autoPlayActive) {\n        return true;\n      }\n\n      if (nextState.startDate !== startDate) {\n        return true;\n      }\n\n      if (nextState.endDate !== endDate) {\n        return true;\n      }\n\n      if (!(0, _isEqual2[\"default\"])(nextProps.timeAwareLayers, timeAwareLayers)) {\n        return true;\n      }\n\n      if (!(0, _isEqual2[\"default\"])(nextProps.tooltips, tooltips)) {\n        return true;\n      }\n\n      return false;\n    }\n    /**\n     * Wraps the TimeSlider component in timeLayerAware.\n     */\n\n  }, {\n    key: \"autoPlay\",\n    value:\n    /**\n     * start or stop auto playback\n     * TODO: we should do the request for new features less aggresive,\n     * e.g. a precache would be helpful\n     */\n    function autoPlay(pressed) {\n      var _this3 = this;\n\n      if (pressed) {\n        window.clearInterval(this._interval);\n        this._interval = window.setInterval(function () {\n          var endDate = _this3.state.endDate;\n          var _this3$state = _this3.state,\n              value = _this3$state.value,\n              playbackSpeed = _this3$state.playbackSpeed;\n\n          if (value >= endDate) {\n            window.clearInterval(_this3._interval);\n\n            _this3.setState({\n              autoPlayActive: false\n            });\n\n            return;\n          }\n\n          var newValue;\n\n          if ((0, _isFinite2[\"default\"])(playbackSpeed)) {\n            newValue = value.clone().add(playbackSpeed, 'seconds');\n          } else {\n            newValue = value.clone().add(1, playbackSpeed);\n          }\n\n          _this3.timeSliderCustomHandler(newValue);\n\n          _this3.wmsTimeHandler(newValue); // value is handled in timeSliderCustomHandler\n\n\n          _this3.setState({\n            autoPlayActive: true\n          });\n        }, 1000, this);\n      } else {\n        window.clearInterval(this._interval);\n        this.setState({\n          autoPlayActive: false\n        });\n      }\n    }\n    /**\n     * handle playback speed change\n     */\n\n  }, {\n    key: \"updateDataRange\",\n    value:\n    /**\n     *\n     */\n    function updateDataRange(_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          startDate = _ref2[0],\n          endDate = _ref2[1];\n\n      this.setState({\n        startDate: startDate,\n        endDate: endDate\n      });\n    }\n    /**\n     *\n     * @param val\n     */\n\n  }, {\n    key: \"onTimeChanged\",\n    value: function onTimeChanged(val) {\n      var _this4 = this;\n\n      this.setState({\n        value: (0, _moment[\"default\"])(val)\n      }, function () {\n        _this4.wmsTimeHandler(_this4.state.value);\n      });\n    }\n    /**\n     *\n     *\n     * @memberof TimeLayerSliderPanel\n     */\n\n  }]);\n\n  return TimeLayerSliderPanel;\n}(React.Component);\n\nexports.TimeLayerSliderPanel = TimeLayerSliderPanel;\n\n_defineProperty(TimeLayerSliderPanel, \"defaultProps\", {\n  className: '',\n  onChange: function onChange() {},\n  timeAwareLayers: [],\n  value: (0, _moment[\"default\"])(_moment[\"default\"].now()),\n  dateFormat: 'YYYY-MM-DD',\n  tooltips: {\n    setToNow: 'Set to now',\n    hours: 'Hours',\n    days: 'Days',\n    weeks: 'Weeks',\n    months: 'Months',\n    years: 'Years',\n    dataRange: 'Set data range'\n  },\n  autoPlaySpeedOptions: [0.5, 1, 2, 5, 10, 100, 300]\n});\n\nvar _default = TimeLayerSliderPanel;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/rongxuan/Desktop/reactmap/reactmap/node_modules/@terrestris/react-geo/dist/Panel/TimeLayerSliderPanel/TimeLayerSliderPanel.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","TimeLayerSliderPanel","require","_popover","_interopRequireDefault","_select","_datePicker","React","_interopRequireWildcard","_moment","_ol","_isFinite2","_isEqual2","_TimeLayerAware","_TimeSlider","_SimpleButton","_ToggleButton","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","__esModule","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","toString","slice","name","Array","from","test","len","length","arr2","_i","_arr","_n","_d","_s","_e","next","done","push","err","isArray","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_defineProperty","RangePicker","Option","_React$Component","_super","_this","_wmsTimeLayers","timeAwareLayers","forEach","l","layer","wmsTimeHandler","state","_TimeLayerAwareSlider","_this$state","startDate","endDate","startDatesFromLayers","endDatesFromLayers","layerStartDate","layerEndDate","sdm","edm","newStartDate","min","newEndDate","max","updateDataRange","currentMoment","milliseconds","newValue","clone","setState","onChange","config","_config$layer$getSour","_config$layer$getSour2","params","getSource","getParams","time","isMoment","timeFormat","toLowerCase","indexOf","TIME","toISOString","format","updateParams","val","valueToSet","parseFloat","playbackSpeed","autoPlayActive","autoPlay","now","timeSliderCustomHandler","_this$props","className","dateFormat","tooltips","autoPlaySpeedOptions","_this$state2","resetVisible","startDateString","endDateString","valueString","mid","add","diff","marks","futureClass","isBefore","extraCls","disabledCls","label","style","left","right","transform","speedOptions","map","createElement","TimeLayerAwareSlider","concat","trim","placement","title","dataRange","trigger","content","showTime","defaultValue","onOk","iconName","type","onClick","setSliderToNow","tooltip","setToNow","formatString","onTimeChanged","pressed","onToggle","pressedIconName","onPlaybackSpeedChange","hours","days","weeks","months","years","_interval","wrapTimeSlider","bind","componentDidMount","_this$props2","initStartDate","initEndDate","componentDidUpdate","prevProps","_this2","pl","tpl","getUid","findRangeForLayers","shouldComponentUpdate","nextProps","nextState","_this$state3","_this$props3","_this3","window","clearInterval","setInterval","_this3$state","_ref","_ref2","_this4","Component","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.TimeLayerSliderPanel = void 0;\n\nrequire(\"antd/es/popover/style\");\n\nvar _popover = _interopRequireDefault(require(\"antd/es/popover\"));\n\nrequire(\"antd/es/select/style\");\n\nvar _select = _interopRequireDefault(require(\"antd/es/select\"));\n\nrequire(\"antd/es/date-picker/style\");\n\nvar _datePicker = _interopRequireDefault(require(\"antd/es/date-picker\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _ol = require(\"ol\");\n\nvar _isFinite2 = _interopRequireDefault(require(\"lodash/isFinite\"));\n\nvar _isEqual2 = _interopRequireDefault(require(\"lodash/isEqual\"));\n\nvar _TimeLayerAware = _interopRequireDefault(require(\"../../HigherOrderComponent/TimeLayerAware/TimeLayerAware\"));\n\nvar _TimeSlider = _interopRequireDefault(require(\"../../Slider/TimeSlider/TimeSlider\"));\n\nvar _SimpleButton = _interopRequireDefault(require(\"../../Button/SimpleButton/SimpleButton\"));\n\nvar _ToggleButton = _interopRequireDefault(require(\"../../Button/ToggleButton/ToggleButton\"));\n\nrequire(\"./TimeLayerSliderPanel.less\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar RangePicker = _datePicker[\"default\"].RangePicker;\nvar Option = _select[\"default\"].Option;\n\n/**\n * The panel combining all time slider related parts.\n */\nvar TimeLayerSliderPanel = /*#__PURE__*/function (_React$Component) {\n  _inherits(TimeLayerSliderPanel, _React$Component);\n\n  var _super = _createSuper(TimeLayerSliderPanel);\n\n  /**\n   * The default props of LayerSetBaseMapChooser\n   *\n   * @static\n   * @memberof LayerSetBaseMapChooser\n   */\n\n  /**\n   * Constructs time panel.\n   */\n  function TimeLayerSliderPanel(props) {\n    var _this;\n\n    _classCallCheck(this, TimeLayerSliderPanel);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"_TimeLayerAwareSlider\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_wmsTimeLayers\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_interval\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"wrapTimeSlider\", function () {\n      _this._wmsTimeLayers = [];\n\n      _this.props.timeAwareLayers.forEach(function (l) {\n        if (l.get('type') === 'WMSTime') {\n          _this._wmsTimeLayers.push({\n            layer: l\n          });\n        }\n      }); // make sure an initial value is set\n\n\n      _this.wmsTimeHandler(_this.state.value);\n\n      _this._TimeLayerAwareSlider = (0, _TimeLayerAware[\"default\"])(_TimeSlider[\"default\"], _this._wmsTimeLayers);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"findRangeForLayers\", function () {\n      var timeAwareLayers = _this.props.timeAwareLayers;\n      var _this$state = _this.state,\n          startDate = _this$state.startDate,\n          endDate = _this$state.endDate;\n\n      if (timeAwareLayers.length === 0) {\n        return;\n      }\n\n      var startDatesFromLayers = [];\n      var endDatesFromLayers = [];\n\n      _this._wmsTimeLayers.forEach(function (l) {\n        var layerStartDate = l.layer.get('startDate');\n        var layerEndDate = l.layer.get('endDate');\n        var sdm;\n        var edm;\n\n        if (layerStartDate) {\n          sdm = (0, _moment[\"default\"])(l.layer.get('startDate'));\n        }\n\n        if (layerEndDate) {\n          edm = (0, _moment[\"default\"])(l.layer.get('endDate'));\n        }\n\n        if (sdm) {\n          startDatesFromLayers.push(sdm);\n        }\n\n        if (edm) {\n          endDatesFromLayers.push(edm);\n        }\n      });\n\n      var newStartDate = startDatesFromLayers.length > 0 ? _moment[\"default\"].min(startDatesFromLayers) : startDate;\n      var newEndDate = endDatesFromLayers.length > 0 ? _moment[\"default\"].max(endDatesFromLayers) : endDate;\n\n      _this.updateDataRange([newStartDate, newEndDate]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"timeSliderCustomHandler\", function (value) {\n      var currentMoment = (0, _moment[\"default\"])(value).milliseconds(0);\n      var newValue = currentMoment.clone();\n\n      _this.setState({\n        value: newValue\n      });\n\n      if (_this.props.onChange) {\n        _this.props.onChange(newValue);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"wmsTimeHandler\", function (value) {\n      _this._wmsTimeLayers.forEach(function (config) {\n        if (config.layer && config.layer.get('type') === 'WMSTime') {\n          var _config$layer$getSour, _config$layer$getSour2;\n\n          var params = (_config$layer$getSour = config.layer.getSource()) === null || _config$layer$getSour === void 0 ? void 0 : _config$layer$getSour.getParams();\n          var time;\n\n          if (Array.isArray(value)) {\n            time = value[0];\n          } else {\n            time = value;\n          }\n\n          if (!_moment[\"default\"].isMoment(time)) {\n            time = (0, _moment[\"default\"])(time);\n          }\n\n          var timeFormat = config.layer.get('timeFormat');\n\n          if (timeFormat.toLowerCase().indexOf('hh') > 0 && config.layer.get('roundToFullHours')) {\n            time.set('minute', 0);\n            time.set('second', 0);\n            params.TIME = time.toISOString();\n          } else {\n            params.TIME = time.format(timeFormat);\n          }\n\n          (_config$layer$getSour2 = config.layer.getSource()) === null || _config$layer$getSour2 === void 0 ? void 0 : _config$layer$getSour2.updateParams(params);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onPlaybackSpeedChange\", function (val) {\n      var valueToSet;\n\n      if ((0, _isFinite2[\"default\"])(parseFloat(val))) {\n        valueToSet = parseFloat(val);\n      } else {\n        valueToSet = val;\n      }\n\n      _this.setState({\n        playbackSpeed: valueToSet\n      }, function () {\n        if (_this.state.autoPlayActive) {\n          _this.autoPlay(true);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSliderToNow\", function () {\n      var now = (0, _moment[\"default\"])().milliseconds(0);\n\n      _this.setState({\n        value: now,\n        endDate: now\n      }, function () {\n        _this.timeSliderCustomHandler(now);\n\n        _this.wmsTimeHandler(now);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"render\", function () {\n      var _this$props = _this.props,\n          className = _this$props.className,\n          timeAwareLayers = _this$props.timeAwareLayers,\n          dateFormat = _this$props.dateFormat,\n          tooltips = _this$props.tooltips,\n          autoPlaySpeedOptions = _this$props.autoPlaySpeedOptions;\n      var _this$state2 = _this.state,\n          autoPlayActive = _this$state2.autoPlayActive,\n          value = _this$state2.value,\n          startDate = _this$state2.startDate,\n          endDate = _this$state2.endDate;\n      var resetVisible = true;\n      var startDateString = startDate.toISOString();\n      var endDateString = endDate.toISOString();\n      var valueString = value.toISOString();\n      var mid = startDate.clone().add(endDate.diff(startDate) / 2);\n      var marks = {};\n      var futureClass = (0, _moment[\"default\"])().isBefore(value) ? ' timeslider-in-future' : '';\n      var extraCls = className ? className : '';\n      var disabledCls = timeAwareLayers.length < 1 ? 'no-layers-available' : '';\n      marks[startDateString] = {\n        label: startDate.format(dateFormat)\n      };\n      marks[endDateString] = {\n        label: endDate.format(dateFormat),\n        style: {\n          left: 'unset',\n          right: 0,\n          transform: 'translate(50%)'\n        }\n      };\n      marks[mid.toISOString()] = {\n        label: mid.format(dateFormat)\n      };\n      var speedOptions = autoPlaySpeedOptions.map(function (val) {\n        return /*#__PURE__*/React.createElement(Option, {\n          key: val,\n          value: val\n        }, val);\n      });\n      var TimeLayerAwareSlider = _this._TimeLayerAwareSlider;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"time-layer-slider \".concat(disabledCls).trim()\n      }, /*#__PURE__*/React.createElement(_popover[\"default\"], {\n        placement: \"topRight\",\n        title: tooltips.dataRange,\n        trigger: \"click\",\n        content: /*#__PURE__*/React.createElement(RangePicker, {\n          showTime: {\n            format: 'HH:mm'\n          },\n          defaultValue: [startDate, endDate],\n          onOk: _this.updateDataRange\n        })\n      }, /*#__PURE__*/React.createElement(_SimpleButton[\"default\"], {\n        className: \"change-datarange-button\",\n        iconName: \"calendar\"\n      })), resetVisible ? /*#__PURE__*/React.createElement(_SimpleButton[\"default\"], {\n        type: \"primary\",\n        iconName: \"sync\",\n        onClick: _this.setSliderToNow,\n        tooltip: tooltips.setToNow\n      }) : null, /*#__PURE__*/React.createElement(TimeLayerAwareSlider, {\n        className: \"\".concat(extraCls, \" timeslider \").concat(futureClass).trim(),\n        formatString: dateFormat,\n        defaultValue: startDateString,\n        min: startDateString,\n        max: endDateString,\n        value: valueString,\n        marks: marks,\n        onChange: _this.onTimeChanged\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"time-value\"\n      }, value.format('DD.MM.YYYY HH:mm:ss')), /*#__PURE__*/React.createElement(_ToggleButton[\"default\"], {\n        type: \"primary\",\n        iconName: \"play-circle\",\n        className: extraCls + ' playback',\n        pressed: autoPlayActive,\n        onToggle: _this.autoPlay,\n        tooltip: autoPlayActive ? 'Pause' : 'Autoplay',\n        \"aria-label\": autoPlayActive ? 'Pause' : 'Autoplay',\n        pressedIconName: \"pause-circle\"\n      }), /*#__PURE__*/React.createElement(_select[\"default\"], {\n        defaultValue: '1',\n        className: extraCls + ' speed-picker',\n        onChange: _this.onPlaybackSpeedChange\n      }, speedOptions, /*#__PURE__*/React.createElement(Option, {\n        value: \"hours\"\n      }, tooltips.hours), /*#__PURE__*/React.createElement(Option, {\n        value: \"days\"\n      }, tooltips.days), /*#__PURE__*/React.createElement(Option, {\n        value: \"weeks\"\n      }, tooltips.weeks), /*#__PURE__*/React.createElement(Option, {\n        value: \"months\"\n      }, tooltips.months), /*#__PURE__*/React.createElement(Option, {\n        value: \"years\"\n      }, tooltips.years)));\n    });\n\n    _this.state = {\n      value: (0, _moment[\"default\"])().milliseconds(0),\n      playbackSpeed: 1,\n      autoPlayActive: false,\n      startDate: (0, _moment[\"default\"])().milliseconds(0),\n      endDate: (0, _moment[\"default\"])().milliseconds(0)\n    };\n    _this._interval = 1000;\n\n    _this.wrapTimeSlider(); // binds\n\n\n    _this.onTimeChanged = _this.onTimeChanged.bind(_assertThisInitialized(_this));\n    _this.autoPlay = _this.autoPlay.bind(_assertThisInitialized(_this));\n    _this.updateDataRange = _this.updateDataRange.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(TimeLayerSliderPanel, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props2 = this.props,\n          initStartDate = _this$props2.initStartDate,\n          initEndDate = _this$props2.initEndDate;\n      this.setState({\n        startDate: initStartDate,\n        endDate: initEndDate\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this2 = this;\n\n      prevProps.timeAwareLayers.forEach(function (pl, i) {\n        var tpl = _this2.props.timeAwareLayers[i];\n\n        if (!(0, _isEqual2[\"default\"])((0, _ol.getUid)(pl), (0, _ol.getUid)(tpl))) {\n          // update slider properties if layers were updated\n          _this2.wrapTimeSlider();\n\n          _this2.findRangeForLayers();\n        }\n      });\n    }\n    /**\n     *\n     * @param nextProps\n     * @param nextState\n     */\n\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      var _this$state3 = this.state,\n          value = _this$state3.value,\n          autoPlayActive = _this$state3.autoPlayActive,\n          startDate = _this$state3.startDate,\n          endDate = _this$state3.endDate;\n      var _this$props3 = this.props,\n          timeAwareLayers = _this$props3.timeAwareLayers,\n          tooltips = _this$props3.tooltips;\n\n      if (nextState.value !== value) {\n        return true;\n      }\n\n      if (nextState.autoPlayActive !== autoPlayActive) {\n        return true;\n      }\n\n      if (nextState.startDate !== startDate) {\n        return true;\n      }\n\n      if (nextState.endDate !== endDate) {\n        return true;\n      }\n\n      if (!(0, _isEqual2[\"default\"])(nextProps.timeAwareLayers, timeAwareLayers)) {\n        return true;\n      }\n\n      if (!(0, _isEqual2[\"default\"])(nextProps.tooltips, tooltips)) {\n        return true;\n      }\n\n      return false;\n    }\n    /**\n     * Wraps the TimeSlider component in timeLayerAware.\n     */\n\n  }, {\n    key: \"autoPlay\",\n    value:\n    /**\n     * start or stop auto playback\n     * TODO: we should do the request for new features less aggresive,\n     * e.g. a precache would be helpful\n     */\n    function autoPlay(pressed) {\n      var _this3 = this;\n\n      if (pressed) {\n        window.clearInterval(this._interval);\n        this._interval = window.setInterval(function () {\n          var endDate = _this3.state.endDate;\n          var _this3$state = _this3.state,\n              value = _this3$state.value,\n              playbackSpeed = _this3$state.playbackSpeed;\n\n          if (value >= endDate) {\n            window.clearInterval(_this3._interval);\n\n            _this3.setState({\n              autoPlayActive: false\n            });\n\n            return;\n          }\n\n          var newValue;\n\n          if ((0, _isFinite2[\"default\"])(playbackSpeed)) {\n            newValue = value.clone().add(playbackSpeed, 'seconds');\n          } else {\n            newValue = value.clone().add(1, playbackSpeed);\n          }\n\n          _this3.timeSliderCustomHandler(newValue);\n\n          _this3.wmsTimeHandler(newValue); // value is handled in timeSliderCustomHandler\n\n\n          _this3.setState({\n            autoPlayActive: true\n          });\n        }, 1000, this);\n      } else {\n        window.clearInterval(this._interval);\n        this.setState({\n          autoPlayActive: false\n        });\n      }\n    }\n    /**\n     * handle playback speed change\n     */\n\n  }, {\n    key: \"updateDataRange\",\n    value:\n    /**\n     *\n     */\n    function updateDataRange(_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          startDate = _ref2[0],\n          endDate = _ref2[1];\n\n      this.setState({\n        startDate: startDate,\n        endDate: endDate\n      });\n    }\n    /**\n     *\n     * @param val\n     */\n\n  }, {\n    key: \"onTimeChanged\",\n    value: function onTimeChanged(val) {\n      var _this4 = this;\n\n      this.setState({\n        value: (0, _moment[\"default\"])(val)\n      }, function () {\n        _this4.wmsTimeHandler(_this4.state.value);\n      });\n    }\n    /**\n     *\n     *\n     * @memberof TimeLayerSliderPanel\n     */\n\n  }]);\n\n  return TimeLayerSliderPanel;\n}(React.Component);\n\nexports.TimeLayerSliderPanel = TimeLayerSliderPanel;\n\n_defineProperty(TimeLayerSliderPanel, \"defaultProps\", {\n  className: '',\n  onChange: function onChange() {},\n  timeAwareLayers: [],\n  value: (0, _moment[\"default\"])(_moment[\"default\"].now()),\n  dateFormat: 'YYYY-MM-DD',\n  tooltips: {\n    setToNow: 'Set to now',\n    hours: 'Hours',\n    days: 'Days',\n    weeks: 'Weeks',\n    months: 'Months',\n    years: 'Years',\n    dataRange: 'Set data range'\n  },\n  autoPlaySpeedOptions: [0.5, 1, 2, 5, 10, 100, 300]\n});\n\nvar _default = TimeLayerSliderPanel;\nexports[\"default\"] = _default;"]},"metadata":{},"sourceType":"script"}