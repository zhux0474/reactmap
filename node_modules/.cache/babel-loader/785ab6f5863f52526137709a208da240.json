{"ast":null,"code":"/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v26.2.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { KeyCode } from '../../../constants/keyCode';\nimport { Autowired, PreDestroy } from \"../../../context/context\";\nimport { DragAndDropService, DragSourceType } from \"../../../dragAndDrop/dragAndDropService\";\nimport { Column } from \"../../../entities/column\";\nimport { Events } from \"../../../eventKeys\";\nimport { SetLeftFeature } from \"../../../rendering/features/setLeftFeature\";\nimport { getAriaSortState } from \"../../../utils/aria\";\nimport { ManagedFocusFeature } from \"../../../widgets/managedFocusFeature\";\nimport { TooltipFeature } from \"../../../widgets/tooltipFeature\";\nimport { AbstractHeaderCellCtrl } from \"../abstractCell/abstractHeaderCellCtrl\";\nimport { CssClassApplier } from \"../cssClassApplier\";\nimport { HoverFeature } from \"../hoverFeature\";\nimport { ResizeFeature } from \"./resizeFeature\";\nimport { SelectAllFeature } from \"./selectAllFeature\";\n\nvar HeaderCellCtrl =\n/** @class */\nfunction (_super) {\n  __extends(HeaderCellCtrl, _super);\n\n  function HeaderCellCtrl(column, parentRowCtrl) {\n    var _this = _super.call(this, column, parentRowCtrl) || this;\n\n    _this.refreshFunctions = [];\n    _this.userHeaderClasses = new Set();\n    _this.column = column;\n    return _this;\n  }\n\n  HeaderCellCtrl.prototype.setComp = function (comp, eGui, eResize) {\n    var _this = this;\n\n    _super.prototype.setGui.call(this, eGui);\n\n    this.comp = comp;\n    this.colDefVersion = this.columnModel.getColDefVersion();\n    this.updateState();\n    this.setupWidth();\n    this.setupMovingCss();\n    this.setupMenuClass();\n    this.setupSortableClass();\n    this.addColumnHoverListener();\n    this.setupFilterCss();\n    this.setupColId();\n    this.setupClassesFromColDef();\n    this.setupTooltip();\n    this.addActiveHeaderMouseListeners();\n    this.setupSelectAll();\n    this.setupUserComp();\n    this.createManagedBean(new ResizeFeature(this.getPinned(), this.column, eResize, comp, this));\n    this.createManagedBean(new HoverFeature([this.column], eGui));\n    this.createManagedBean(new SetLeftFeature(this.column, eGui, this.beans));\n    this.createManagedBean(new ManagedFocusFeature(eGui, {\n      shouldStopEventPropagation: function (e) {\n        return _this.shouldStopEventPropagation(e);\n      },\n      onTabKeyDown: function () {\n        return null;\n      },\n      handleKeyDown: this.handleKeyDown.bind(this),\n      onFocusIn: this.onFocusIn.bind(this),\n      onFocusOut: this.onFocusOut.bind(this)\n    }));\n    this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.onNewColumnsLoaded.bind(this));\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VALUE_CHANGED, this.onColumnValueChanged.bind(this));\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.onColumnRowGroupChanged.bind(this));\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_CHANGED, this.onColumnPivotChanged.bind(this));\n  };\n\n  HeaderCellCtrl.prototype.setupUserComp = function () {\n    var compDetails = this.lookupUserCompDetails();\n    this.setCompDetails(compDetails);\n  };\n\n  HeaderCellCtrl.prototype.setCompDetails = function (compDetails) {\n    this.userCompDetails = compDetails;\n    this.comp.setUserCompDetails(compDetails);\n  };\n\n  HeaderCellCtrl.prototype.lookupUserCompDetails = function () {\n    var params = this.createParams();\n    var colDef = this.column.getColDef();\n    return this.userComponentFactory.getHeaderCompDetails(colDef, params);\n  };\n\n  HeaderCellCtrl.prototype.createParams = function () {\n    var _this = this;\n\n    var colDef = this.column.getColDef();\n    var params = {\n      column: this.column,\n      displayName: this.displayName,\n      enableSorting: colDef.sortable,\n      enableMenu: this.menuEnabled,\n      showColumnMenu: function (source) {\n        _this.gridApi.showColumnMenuAfterButtonClick(_this.column, source);\n      },\n      progressSort: function (multiSort) {\n        _this.sortController.progressSort(_this.column, !!multiSort, \"uiColumnSorted\");\n      },\n      setSort: function (sort, multiSort) {\n        _this.sortController.setSortForColumn(_this.column, sort, !!multiSort, \"uiColumnSorted\");\n      },\n      api: this.gridApi,\n      columnApi: this.columnApi,\n      context: this.gridOptionsWrapper.getContext(),\n      eGridHeader: this.getGui()\n    };\n    return params;\n  };\n\n  HeaderCellCtrl.prototype.setupSelectAll = function () {\n    this.selectAllFeature = this.createManagedBean(new SelectAllFeature(this.column));\n    this.selectAllFeature.setComp(this.comp);\n  };\n\n  HeaderCellCtrl.prototype.getSelectAllGui = function () {\n    return this.selectAllFeature.getCheckboxGui();\n  };\n\n  HeaderCellCtrl.prototype.handleKeyDown = function (e) {\n    if (e.keyCode === KeyCode.SPACE) {\n      this.selectAllFeature.onSpaceKeyPressed(e);\n    }\n\n    if (e.keyCode === KeyCode.ENTER) {\n      this.onEnterKeyPressed(e);\n    }\n  };\n\n  HeaderCellCtrl.prototype.onEnterKeyPressed = function (e) {\n    /// THIS IS BAD - we are assuming the header is not a user provided comp\n    var headerComp = this.comp.getUserCompInstance();\n\n    if (!headerComp) {\n      return;\n    }\n\n    if (e.ctrlKey || e.metaKey) {\n      if (this.menuEnabled && headerComp.showMenu) {\n        e.preventDefault();\n        headerComp.showMenu();\n      }\n    } else if (this.sortable) {\n      var multiSort = e.shiftKey;\n      this.sortController.progressSort(this.column, multiSort, \"uiColumnSorted\");\n    }\n  };\n\n  HeaderCellCtrl.prototype.isMenuEnabled = function () {\n    return this.menuEnabled;\n  };\n\n  HeaderCellCtrl.prototype.onFocusIn = function (e) {\n    if (!this.getGui().contains(e.relatedTarget)) {\n      var rowIndex = this.getRowIndex();\n      this.focusService.setFocusedHeader(rowIndex, this.column);\n    }\n\n    this.setActiveHeader(true);\n  };\n\n  HeaderCellCtrl.prototype.onFocusOut = function (e) {\n    if (this.getGui().contains(e.relatedTarget)) {\n      return;\n    }\n\n    this.setActiveHeader(false);\n  };\n\n  HeaderCellCtrl.prototype.setupTooltip = function () {\n    var _this = this;\n\n    var tooltipCtrl = {\n      getColumn: function () {\n        return _this.column;\n      },\n      getColDef: function () {\n        return _this.column.getColDef();\n      },\n      getGui: function () {\n        return _this.eGui;\n      },\n      getLocation: function () {\n        return 'header';\n      },\n      getTooltipValue: function () {\n        var res = _this.column.getColDef().headerTooltip;\n\n        return res;\n      }\n    };\n    var tooltipFeature = this.createManagedBean(new TooltipFeature(tooltipCtrl, this.beans));\n    tooltipFeature.setComp(this.comp);\n    this.refreshFunctions.push(function () {\n      return tooltipFeature.refreshToolTip();\n    });\n  };\n\n  HeaderCellCtrl.prototype.setupClassesFromColDef = function () {\n    var _this = this;\n\n    var refreshHeaderClasses = function () {\n      var colDef = _this.column.getColDef();\n\n      var goa = _this.gridOptionsWrapper;\n      var classes = CssClassApplier.getHeaderClassesFromColDef(colDef, goa, _this.column, null);\n      var oldClasses = _this.userHeaderClasses;\n      _this.userHeaderClasses = new Set(classes);\n      classes.forEach(function (c) {\n        if (oldClasses.has(c)) {\n          // class already added, no need to apply it, but remove from old set\n          oldClasses.delete(c);\n        } else {\n          // class new since last time, so apply it\n          _this.comp.addOrRemoveCssClass(c, true);\n        }\n      }); // now old set only has classes that were applied last time, but not this time, so remove them\n\n      oldClasses.forEach(function (c) {\n        return _this.comp.addOrRemoveCssClass(c, false);\n      });\n    };\n\n    this.refreshFunctions.push(refreshHeaderClasses);\n    refreshHeaderClasses();\n  };\n\n  HeaderCellCtrl.prototype.getGui = function () {\n    return this.eGui;\n  };\n\n  HeaderCellCtrl.prototype.setDragSource = function (eSource) {\n    var _this = this;\n\n    this.dragSourceElement = eSource;\n    this.removeDragSource();\n\n    if (!eSource) {\n      return;\n    }\n\n    if (!this.draggable) {\n      return;\n    }\n\n    this.moveDragSource = {\n      type: DragSourceType.HeaderCell,\n      eElement: eSource,\n      defaultIconName: DragAndDropService.ICON_HIDE,\n      getDragItem: function () {\n        return _this.createDragItem();\n      },\n      dragItemName: this.displayName,\n      onDragStarted: function () {\n        return _this.column.setMoving(true, \"uiColumnMoved\");\n      },\n      onDragStopped: function () {\n        return _this.column.setMoving(false, \"uiColumnMoved\");\n      }\n    };\n    this.dragAndDropService.addDragSource(this.moveDragSource, true);\n  };\n\n  HeaderCellCtrl.prototype.createDragItem = function () {\n    var visibleState = {};\n    visibleState[this.column.getId()] = this.column.isVisible();\n    return {\n      columns: [this.column],\n      visibleState: visibleState\n    };\n  };\n\n  HeaderCellCtrl.prototype.removeDragSource = function () {\n    if (this.moveDragSource) {\n      this.dragAndDropService.removeDragSource(this.moveDragSource);\n      this.moveDragSource = undefined;\n    }\n  };\n\n  HeaderCellCtrl.prototype.onNewColumnsLoaded = function () {\n    var colDefVersionNow = this.columnModel.getColDefVersion();\n\n    if (colDefVersionNow != this.colDefVersion) {\n      this.colDefVersion = colDefVersionNow;\n      this.refresh();\n    }\n  };\n\n  HeaderCellCtrl.prototype.updateState = function () {\n    var colDef = this.column.getColDef();\n    this.menuEnabled = this.menuFactory.isMenuEnabled(this.column) && !colDef.suppressMenu;\n    this.sortable = colDef.sortable;\n    this.displayName = this.calculateDisplayName();\n    this.draggable = this.workOutDraggable();\n  };\n\n  HeaderCellCtrl.prototype.addRefreshFunction = function (func) {\n    this.refreshFunctions.push(func);\n  };\n\n  HeaderCellCtrl.prototype.refresh = function () {\n    this.updateState();\n    this.refreshHeaderComp();\n    this.refreshFunctions.forEach(function (f) {\n      return f();\n    });\n  };\n\n  HeaderCellCtrl.prototype.refreshHeaderComp = function () {\n    var newCompDetails = this.lookupUserCompDetails();\n    var compInstance = this.comp.getUserCompInstance(); // only try refresh if old comp exists adn it is the correct type\n\n    var attemptRefresh = compInstance != null && this.userCompDetails.componentClass == newCompDetails.componentClass;\n    var headerCompRefreshed = attemptRefresh ? this.attemptHeaderCompRefresh(newCompDetails.params) : false;\n\n    if (headerCompRefreshed) {\n      // we do this as a refresh happens after colDefs change, and it's possible the column has had it's\n      // draggable property toggled. no need to call this if not refreshing, as setDragSource is done\n      // as part of appendHeaderComp\n      this.setDragSource(this.dragSourceElement);\n    } else {\n      this.setCompDetails(newCompDetails);\n    }\n  };\n\n  HeaderCellCtrl.prototype.attemptHeaderCompRefresh = function (params) {\n    var headerComp = this.comp.getUserCompInstance();\n\n    if (!headerComp) {\n      return false;\n    } // if no refresh method, then we want to replace the headerComp\n\n\n    if (!headerComp.refresh) {\n      return false;\n    }\n\n    var res = headerComp.refresh(params);\n    return res;\n  };\n\n  HeaderCellCtrl.prototype.calculateDisplayName = function () {\n    return this.columnModel.getDisplayNameForColumn(this.column, 'header', true);\n  };\n\n  HeaderCellCtrl.prototype.checkDisplayName = function () {\n    // display name can change if aggFunc different, eg sum(Gold) is now max(Gold)\n    if (this.displayName !== this.calculateDisplayName()) {\n      this.refresh();\n    }\n  };\n\n  HeaderCellCtrl.prototype.workOutDraggable = function () {\n    var colDef = this.column.getColDef();\n    var isSuppressMovableColumns = this.gridOptionsWrapper.isSuppressMovableColumns();\n    var colCanMove = !isSuppressMovableColumns && !colDef.suppressMovable && !colDef.lockPosition; // we should still be allowed drag the column, even if it can't be moved, if the column\n    // can be dragged to a rowGroup or pivot drop zone\n\n    return !!colCanMove || !!colDef.enableRowGroup || !!colDef.enablePivot;\n  };\n\n  HeaderCellCtrl.prototype.onColumnRowGroupChanged = function () {\n    this.checkDisplayName();\n  };\n\n  HeaderCellCtrl.prototype.onColumnPivotChanged = function () {\n    this.checkDisplayName();\n  };\n\n  HeaderCellCtrl.prototype.onColumnValueChanged = function () {\n    this.checkDisplayName();\n  };\n\n  HeaderCellCtrl.prototype.setupWidth = function () {\n    var _this = this;\n\n    var listener = function () {\n      _this.comp.setWidth(_this.column.getActualWidth() + 'px');\n    };\n\n    this.addManagedListener(this.column, Column.EVENT_WIDTH_CHANGED, listener);\n    listener();\n  };\n\n  HeaderCellCtrl.prototype.setupMovingCss = function () {\n    var _this = this;\n\n    var listener = function () {\n      // this is what makes the header go dark when it is been moved (gives impression to\n      // user that the column was picked up).\n      _this.comp.addOrRemoveCssClass('ag-header-cell-moving', _this.column.isMoving());\n    };\n\n    this.addManagedListener(this.column, Column.EVENT_MOVING_CHANGED, listener);\n    listener();\n  };\n\n  HeaderCellCtrl.prototype.setupMenuClass = function () {\n    var _this = this;\n\n    var listener = function () {\n      _this.comp.addOrRemoveCssClass('ag-column-menu-visible', _this.column.isMenuVisible());\n    };\n\n    this.addManagedListener(this.column, Column.EVENT_MENU_VISIBLE_CHANGED, listener);\n    listener();\n  };\n\n  HeaderCellCtrl.prototype.setupSortableClass = function () {\n    var _this = this;\n\n    var updateSortableCssClass = function () {\n      _this.comp.addOrRemoveCssClass('ag-header-cell-sortable', !!_this.sortable);\n    };\n\n    var updateAriaSort = function () {\n      if (_this.sortable) {\n        _this.comp.setAriaSort(getAriaSortState(_this.column));\n      } else {\n        _this.comp.setAriaSort(undefined);\n      }\n    };\n\n    updateSortableCssClass();\n    updateAriaSort();\n    this.addRefreshFunction(updateSortableCssClass);\n    this.addRefreshFunction(updateAriaSort);\n    this.addManagedListener(this.column, Column.EVENT_SORT_CHANGED, updateAriaSort);\n  };\n\n  HeaderCellCtrl.prototype.addColumnHoverListener = function () {\n    var _this = this;\n\n    var listener = function () {\n      if (!_this.gridOptionsWrapper.isColumnHoverHighlight()) {\n        return;\n      }\n\n      var isHovered = _this.columnHoverService.isHovered(_this.column);\n\n      _this.comp.addOrRemoveCssClass('ag-column-hover', isHovered);\n    };\n\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_HOVER_CHANGED, listener);\n    listener();\n  };\n\n  HeaderCellCtrl.prototype.setupFilterCss = function () {\n    var _this = this;\n\n    var listener = function () {\n      _this.comp.addOrRemoveCssClass('ag-header-cell-filtered', _this.column.isFilterActive());\n    };\n\n    this.addManagedListener(this.column, Column.EVENT_FILTER_ACTIVE_CHANGED, listener);\n    listener();\n  };\n\n  HeaderCellCtrl.prototype.setupColId = function () {\n    this.comp.setColId(this.column.getColId());\n  };\n\n  HeaderCellCtrl.prototype.addActiveHeaderMouseListeners = function () {\n    var _this = this;\n\n    var listener = function (e) {\n      return _this.setActiveHeader(e.type === 'mouseenter');\n    };\n\n    this.addManagedListener(this.getGui(), 'mouseenter', listener);\n    this.addManagedListener(this.getGui(), 'mouseleave', listener);\n  };\n\n  HeaderCellCtrl.prototype.setActiveHeader = function (active) {\n    this.comp.addOrRemoveCssClass('ag-header-active', active);\n  };\n\n  __decorate([Autowired('columnModel')], HeaderCellCtrl.prototype, \"columnModel\", void 0);\n\n  __decorate([Autowired('columnHoverService')], HeaderCellCtrl.prototype, \"columnHoverService\", void 0);\n\n  __decorate([Autowired('beans')], HeaderCellCtrl.prototype, \"beans\", void 0);\n\n  __decorate([Autowired('sortController')], HeaderCellCtrl.prototype, \"sortController\", void 0);\n\n  __decorate([Autowired('menuFactory')], HeaderCellCtrl.prototype, \"menuFactory\", void 0);\n\n  __decorate([Autowired('dragAndDropService')], HeaderCellCtrl.prototype, \"dragAndDropService\", void 0);\n\n  __decorate([Autowired('gridApi')], HeaderCellCtrl.prototype, \"gridApi\", void 0);\n\n  __decorate([Autowired('columnApi')], HeaderCellCtrl.prototype, \"columnApi\", void 0);\n\n  __decorate([Autowired('userComponentFactory')], HeaderCellCtrl.prototype, \"userComponentFactory\", void 0);\n\n  __decorate([PreDestroy], HeaderCellCtrl.prototype, \"removeDragSource\", null);\n\n  return HeaderCellCtrl;\n}(AbstractHeaderCellCtrl);\n\nexport { HeaderCellCtrl };","map":{"version":3,"sources":["/Users/rongxuan/Desktop/reactmap/reactmap/node_modules/@ag-grid-community/core/dist/es6/headerRendering/cells/column/headerCellCtrl.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","KeyCode","Autowired","PreDestroy","DragAndDropService","DragSourceType","Column","Events","SetLeftFeature","getAriaSortState","ManagedFocusFeature","TooltipFeature","AbstractHeaderCellCtrl","CssClassApplier","HoverFeature","ResizeFeature","SelectAllFeature","HeaderCellCtrl","_super","column","parentRowCtrl","_this","call","refreshFunctions","userHeaderClasses","Set","setComp","comp","eGui","eResize","setGui","colDefVersion","columnModel","getColDefVersion","updateState","setupWidth","setupMovingCss","setupMenuClass","setupSortableClass","addColumnHoverListener","setupFilterCss","setupColId","setupClassesFromColDef","setupTooltip","addActiveHeaderMouseListeners","setupSelectAll","setupUserComp","createManagedBean","getPinned","beans","shouldStopEventPropagation","e","onTabKeyDown","handleKeyDown","bind","onFocusIn","onFocusOut","addManagedListener","eventService","EVENT_NEW_COLUMNS_LOADED","onNewColumnsLoaded","EVENT_COLUMN_VALUE_CHANGED","onColumnValueChanged","EVENT_COLUMN_ROW_GROUP_CHANGED","onColumnRowGroupChanged","EVENT_COLUMN_PIVOT_CHANGED","onColumnPivotChanged","compDetails","lookupUserCompDetails","setCompDetails","userCompDetails","setUserCompDetails","params","createParams","colDef","getColDef","userComponentFactory","getHeaderCompDetails","displayName","enableSorting","sortable","enableMenu","menuEnabled","showColumnMenu","source","gridApi","showColumnMenuAfterButtonClick","progressSort","multiSort","sortController","setSort","sort","setSortForColumn","api","columnApi","context","gridOptionsWrapper","getContext","eGridHeader","getGui","selectAllFeature","getSelectAllGui","getCheckboxGui","keyCode","SPACE","onSpaceKeyPressed","ENTER","onEnterKeyPressed","headerComp","getUserCompInstance","ctrlKey","metaKey","showMenu","preventDefault","shiftKey","isMenuEnabled","contains","relatedTarget","rowIndex","getRowIndex","focusService","setFocusedHeader","setActiveHeader","tooltipCtrl","getColumn","getLocation","getTooltipValue","res","headerTooltip","tooltipFeature","push","refreshToolTip","refreshHeaderClasses","goa","classes","getHeaderClassesFromColDef","oldClasses","forEach","has","delete","addOrRemoveCssClass","setDragSource","eSource","dragSourceElement","removeDragSource","draggable","moveDragSource","type","HeaderCell","eElement","defaultIconName","ICON_HIDE","getDragItem","createDragItem","dragItemName","onDragStarted","setMoving","onDragStopped","dragAndDropService","addDragSource","visibleState","getId","isVisible","columns","undefined","colDefVersionNow","refresh","menuFactory","suppressMenu","calculateDisplayName","workOutDraggable","addRefreshFunction","func","refreshHeaderComp","f","newCompDetails","compInstance","attemptRefresh","componentClass","headerCompRefreshed","attemptHeaderCompRefresh","getDisplayNameForColumn","checkDisplayName","isSuppressMovableColumns","colCanMove","suppressMovable","lockPosition","enableRowGroup","enablePivot","listener","setWidth","getActualWidth","EVENT_WIDTH_CHANGED","isMoving","EVENT_MOVING_CHANGED","isMenuVisible","EVENT_MENU_VISIBLE_CHANGED","updateSortableCssClass","updateAriaSort","setAriaSort","EVENT_SORT_CHANGED","isColumnHoverHighlight","isHovered","columnHoverService","EVENT_COLUMN_HOVER_CHANGED","isFilterActive","EVENT_FILTER_ACTIVE_CHANGED","setColId","getColId","active"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;AACrD,MAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,IAAAA,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;AAAEC,MAAAA,SAAS,EAAE;AAAb,iBAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AAAkB,KAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AAAc,KAF9E;;AAGA,WAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;AACH,GALD;;AAMA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnBF,IAAAA,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;AACA,aAASO,EAAT,GAAc;AAAE,WAAKC,WAAL,GAAmBT,CAAnB;AAAuB;;AACvCA,IAAAA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;AACH,GAJD;AAKH,CAZ2C,EAA5C;;AAaA,IAAII,UAAU,GAAI,QAAQ,KAAKA,UAAd,IAA6B,UAAUC,UAAV,EAAsBC,MAAtB,EAA8BC,GAA9B,EAAmCC,IAAnC,EAAyC;AACnF,MAAIC,CAAC,GAAGC,SAAS,CAACC,MAAlB;AAAA,MAA0BC,CAAC,GAAGH,CAAC,GAAG,CAAJ,GAAQH,MAAR,GAAiBE,IAAI,KAAK,IAAT,GAAgBA,IAAI,GAAGd,MAAM,CAACmB,wBAAP,CAAgCP,MAAhC,EAAwCC,GAAxC,CAAvB,GAAsEC,IAArH;AAAA,MAA2HhB,CAA3H;AACA,MAAI,OAAOsB,OAAP,KAAmB,QAAnB,IAA+B,OAAOA,OAAO,CAACC,QAAf,KAA4B,UAA/D,EAA2EH,CAAC,GAAGE,OAAO,CAACC,QAAR,CAAiBV,UAAjB,EAA6BC,MAA7B,EAAqCC,GAArC,EAA0CC,IAA1C,CAAJ,CAA3E,KACK,KAAK,IAAIQ,CAAC,GAAGX,UAAU,CAACM,MAAX,GAAoB,CAAjC,EAAoCK,CAAC,IAAI,CAAzC,EAA4CA,CAAC,EAA7C,EAAiD,IAAIxB,CAAC,GAAGa,UAAU,CAACW,CAAD,CAAlB,EAAuBJ,CAAC,GAAG,CAACH,CAAC,GAAG,CAAJ,GAAQjB,CAAC,CAACoB,CAAD,CAAT,GAAeH,CAAC,GAAG,CAAJ,GAAQjB,CAAC,CAACc,MAAD,EAASC,GAAT,EAAcK,CAAd,CAAT,GAA4BpB,CAAC,CAACc,MAAD,EAASC,GAAT,CAA7C,KAA+DK,CAAnE;AAC7E,SAAOH,CAAC,GAAG,CAAJ,IAASG,CAAT,IAAclB,MAAM,CAACuB,cAAP,CAAsBX,MAAtB,EAA8BC,GAA9B,EAAmCK,CAAnC,CAAd,EAAqDA,CAA5D;AACH,CALD;;AAMA,SAASM,OAAT,QAAwB,4BAAxB;AACA,SAASC,SAAT,EAAoBC,UAApB,QAAsC,0BAAtC;AACA,SAASC,kBAAT,EAA6BC,cAA7B,QAAmD,yCAAnD;AACA,SAASC,MAAT,QAAuB,0BAAvB;AACA,SAASC,MAAT,QAAuB,oBAAvB;AACA,SAASC,cAAT,QAA+B,4CAA/B;AACA,SAASC,gBAAT,QAAiC,qBAAjC;AACA,SAASC,mBAAT,QAAoC,sCAApC;AACA,SAASC,cAAT,QAA+B,iCAA/B;AACA,SAASC,sBAAT,QAAuC,wCAAvC;AACA,SAASC,eAAT,QAAgC,oBAAhC;AACA,SAASC,YAAT,QAA6B,iBAA7B;AACA,SAASC,aAAT,QAA8B,iBAA9B;AACA,SAASC,gBAAT,QAAiC,oBAAjC;;AACA,IAAIC,cAAc;AAAG;AAAe,UAAUC,MAAV,EAAkB;AAClD7C,EAAAA,SAAS,CAAC4C,cAAD,EAAiBC,MAAjB,CAAT;;AACA,WAASD,cAAT,CAAwBE,MAAxB,EAAgCC,aAAhC,EAA+C;AAC3C,QAAIC,KAAK,GAAGH,MAAM,CAACI,IAAP,CAAY,IAAZ,EAAkBH,MAAlB,EAA0BC,aAA1B,KAA4C,IAAxD;;AACAC,IAAAA,KAAK,CAACE,gBAAN,GAAyB,EAAzB;AACAF,IAAAA,KAAK,CAACG,iBAAN,GAA0B,IAAIC,GAAJ,EAA1B;AACAJ,IAAAA,KAAK,CAACF,MAAN,GAAeA,MAAf;AACA,WAAOE,KAAP;AACH;;AACDJ,EAAAA,cAAc,CAAChC,SAAf,CAAyByC,OAAzB,GAAmC,UAAUC,IAAV,EAAgBC,IAAhB,EAAsBC,OAAtB,EAA+B;AAC9D,QAAIR,KAAK,GAAG,IAAZ;;AACAH,IAAAA,MAAM,CAACjC,SAAP,CAAiB6C,MAAjB,CAAwBR,IAAxB,CAA6B,IAA7B,EAAmCM,IAAnC;;AACA,SAAKD,IAAL,GAAYA,IAAZ;AACA,SAAKI,aAAL,GAAqB,KAAKC,WAAL,CAAiBC,gBAAjB,EAArB;AACA,SAAKC,WAAL;AACA,SAAKC,UAAL;AACA,SAAKC,cAAL;AACA,SAAKC,cAAL;AACA,SAAKC,kBAAL;AACA,SAAKC,sBAAL;AACA,SAAKC,cAAL;AACA,SAAKC,UAAL;AACA,SAAKC,sBAAL;AACA,SAAKC,YAAL;AACA,SAAKC,6BAAL;AACA,SAAKC,cAAL;AACA,SAAKC,aAAL;AACA,SAAKC,iBAAL,CAAuB,IAAIhC,aAAJ,CAAkB,KAAKiC,SAAL,EAAlB,EAAoC,KAAK7B,MAAzC,EAAiDU,OAAjD,EAA0DF,IAA1D,EAAgE,IAAhE,CAAvB;AACA,SAAKoB,iBAAL,CAAuB,IAAIjC,YAAJ,CAAiB,CAAC,KAAKK,MAAN,CAAjB,EAAgCS,IAAhC,CAAvB;AACA,SAAKmB,iBAAL,CAAuB,IAAIvC,cAAJ,CAAmB,KAAKW,MAAxB,EAAgCS,IAAhC,EAAsC,KAAKqB,KAA3C,CAAvB;AACA,SAAKF,iBAAL,CAAuB,IAAIrC,mBAAJ,CAAwBkB,IAAxB,EAA8B;AACjDsB,MAAAA,0BAA0B,EAAE,UAAUC,CAAV,EAAa;AAAE,eAAO9B,KAAK,CAAC6B,0BAAN,CAAiCC,CAAjC,CAAP;AAA6C,OADvC;AAEjDC,MAAAA,YAAY,EAAE,YAAY;AAAE,eAAO,IAAP;AAAc,OAFO;AAGjDC,MAAAA,aAAa,EAAE,KAAKA,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAHkC;AAIjDC,MAAAA,SAAS,EAAE,KAAKA,SAAL,CAAeD,IAAf,CAAoB,IAApB,CAJsC;AAKjDE,MAAAA,UAAU,EAAE,KAAKA,UAAL,CAAgBF,IAAhB,CAAqB,IAArB;AALqC,KAA9B,CAAvB;AAOA,SAAKG,kBAAL,CAAwB,KAAKC,YAA7B,EAA2CnD,MAAM,CAACoD,wBAAlD,EAA4E,KAAKC,kBAAL,CAAwBN,IAAxB,CAA6B,IAA7B,CAA5E;AACA,SAAKG,kBAAL,CAAwB,KAAKC,YAA7B,EAA2CnD,MAAM,CAACsD,0BAAlD,EAA8E,KAAKC,oBAAL,CAA0BR,IAA1B,CAA+B,IAA/B,CAA9E;AACA,SAAKG,kBAAL,CAAwB,KAAKC,YAA7B,EAA2CnD,MAAM,CAACwD,8BAAlD,EAAkF,KAAKC,uBAAL,CAA6BV,IAA7B,CAAkC,IAAlC,CAAlF;AACA,SAAKG,kBAAL,CAAwB,KAAKC,YAA7B,EAA2CnD,MAAM,CAAC0D,0BAAlD,EAA8E,KAAKC,oBAAL,CAA0BZ,IAA1B,CAA+B,IAA/B,CAA9E;AACH,GAhCD;;AAiCArC,EAAAA,cAAc,CAAChC,SAAf,CAAyB6D,aAAzB,GAAyC,YAAY;AACjD,QAAIqB,WAAW,GAAG,KAAKC,qBAAL,EAAlB;AACA,SAAKC,cAAL,CAAoBF,WAApB;AACH,GAHD;;AAIAlD,EAAAA,cAAc,CAAChC,SAAf,CAAyBoF,cAAzB,GAA0C,UAAUF,WAAV,EAAuB;AAC7D,SAAKG,eAAL,GAAuBH,WAAvB;AACA,SAAKxC,IAAL,CAAU4C,kBAAV,CAA6BJ,WAA7B;AACH,GAHD;;AAIAlD,EAAAA,cAAc,CAAChC,SAAf,CAAyBmF,qBAAzB,GAAiD,YAAY;AACzD,QAAII,MAAM,GAAG,KAAKC,YAAL,EAAb;AACA,QAAIC,MAAM,GAAG,KAAKvD,MAAL,CAAYwD,SAAZ,EAAb;AACA,WAAO,KAAKC,oBAAL,CAA0BC,oBAA1B,CAA+CH,MAA/C,EAAuDF,MAAvD,CAAP;AACH,GAJD;;AAKAvD,EAAAA,cAAc,CAAChC,SAAf,CAAyBwF,YAAzB,GAAwC,YAAY;AAChD,QAAIpD,KAAK,GAAG,IAAZ;;AACA,QAAIqD,MAAM,GAAG,KAAKvD,MAAL,CAAYwD,SAAZ,EAAb;AACA,QAAIH,MAAM,GAAG;AACTrD,MAAAA,MAAM,EAAE,KAAKA,MADJ;AAET2D,MAAAA,WAAW,EAAE,KAAKA,WAFT;AAGTC,MAAAA,aAAa,EAAEL,MAAM,CAACM,QAHb;AAITC,MAAAA,UAAU,EAAE,KAAKC,WAJR;AAKTC,MAAAA,cAAc,EAAE,UAAUC,MAAV,EAAkB;AAC9B/D,QAAAA,KAAK,CAACgE,OAAN,CAAcC,8BAAd,CAA6CjE,KAAK,CAACF,MAAnD,EAA2DiE,MAA3D;AACH,OAPQ;AAQTG,MAAAA,YAAY,EAAE,UAAUC,SAAV,EAAqB;AAC/BnE,QAAAA,KAAK,CAACoE,cAAN,CAAqBF,YAArB,CAAkClE,KAAK,CAACF,MAAxC,EAAgD,CAAC,CAACqE,SAAlD,EAA6D,gBAA7D;AACH,OAVQ;AAWTE,MAAAA,OAAO,EAAE,UAAUC,IAAV,EAAgBH,SAAhB,EAA2B;AAChCnE,QAAAA,KAAK,CAACoE,cAAN,CAAqBG,gBAArB,CAAsCvE,KAAK,CAACF,MAA5C,EAAoDwE,IAApD,EAA0D,CAAC,CAACH,SAA5D,EAAuE,gBAAvE;AACH,OAbQ;AAcTK,MAAAA,GAAG,EAAE,KAAKR,OAdD;AAeTS,MAAAA,SAAS,EAAE,KAAKA,SAfP;AAgBTC,MAAAA,OAAO,EAAE,KAAKC,kBAAL,CAAwBC,UAAxB,EAhBA;AAiBTC,MAAAA,WAAW,EAAE,KAAKC,MAAL;AAjBJ,KAAb;AAmBA,WAAO3B,MAAP;AACH,GAvBD;;AAwBAvD,EAAAA,cAAc,CAAChC,SAAf,CAAyB4D,cAAzB,GAA0C,YAAY;AAClD,SAAKuD,gBAAL,GAAwB,KAAKrD,iBAAL,CAAuB,IAAI/B,gBAAJ,CAAqB,KAAKG,MAA1B,CAAvB,CAAxB;AACA,SAAKiF,gBAAL,CAAsB1E,OAAtB,CAA8B,KAAKC,IAAnC;AACH,GAHD;;AAIAV,EAAAA,cAAc,CAAChC,SAAf,CAAyBoH,eAAzB,GAA2C,YAAY;AACnD,WAAO,KAAKD,gBAAL,CAAsBE,cAAtB,EAAP;AACH,GAFD;;AAGArF,EAAAA,cAAc,CAAChC,SAAf,CAAyBoE,aAAzB,GAAyC,UAAUF,CAAV,EAAa;AAClD,QAAIA,CAAC,CAACoD,OAAF,KAActG,OAAO,CAACuG,KAA1B,EAAiC;AAC7B,WAAKJ,gBAAL,CAAsBK,iBAAtB,CAAwCtD,CAAxC;AACH;;AACD,QAAIA,CAAC,CAACoD,OAAF,KAActG,OAAO,CAACyG,KAA1B,EAAiC;AAC7B,WAAKC,iBAAL,CAAuBxD,CAAvB;AACH;AACJ,GAPD;;AAQAlC,EAAAA,cAAc,CAAChC,SAAf,CAAyB0H,iBAAzB,GAA6C,UAAUxD,CAAV,EAAa;AACtD;AACA,QAAIyD,UAAU,GAAG,KAAKjF,IAAL,CAAUkF,mBAAV,EAAjB;;AACA,QAAI,CAACD,UAAL,EAAiB;AACb;AACH;;AACD,QAAIzD,CAAC,CAAC2D,OAAF,IAAa3D,CAAC,CAAC4D,OAAnB,EAA4B;AACxB,UAAI,KAAK7B,WAAL,IAAoB0B,UAAU,CAACI,QAAnC,EAA6C;AACzC7D,QAAAA,CAAC,CAAC8D,cAAF;AACAL,QAAAA,UAAU,CAACI,QAAX;AACH;AACJ,KALD,MAMK,IAAI,KAAKhC,QAAT,EAAmB;AACpB,UAAIQ,SAAS,GAAGrC,CAAC,CAAC+D,QAAlB;AACA,WAAKzB,cAAL,CAAoBF,YAApB,CAAiC,KAAKpE,MAAtC,EAA8CqE,SAA9C,EAAyD,gBAAzD;AACH;AACJ,GAhBD;;AAiBAvE,EAAAA,cAAc,CAAChC,SAAf,CAAyBkI,aAAzB,GAAyC,YAAY;AACjD,WAAO,KAAKjC,WAAZ;AACH,GAFD;;AAGAjE,EAAAA,cAAc,CAAChC,SAAf,CAAyBsE,SAAzB,GAAqC,UAAUJ,CAAV,EAAa;AAC9C,QAAI,CAAC,KAAKgD,MAAL,GAAciB,QAAd,CAAuBjE,CAAC,CAACkE,aAAzB,CAAL,EAA8C;AAC1C,UAAIC,QAAQ,GAAG,KAAKC,WAAL,EAAf;AACA,WAAKC,YAAL,CAAkBC,gBAAlB,CAAmCH,QAAnC,EAA6C,KAAKnG,MAAlD;AACH;;AACD,SAAKuG,eAAL,CAAqB,IAArB;AACH,GAND;;AAOAzG,EAAAA,cAAc,CAAChC,SAAf,CAAyBuE,UAAzB,GAAsC,UAAUL,CAAV,EAAa;AAC/C,QAAI,KAAKgD,MAAL,GAAciB,QAAd,CAAuBjE,CAAC,CAACkE,aAAzB,CAAJ,EAA6C;AACzC;AACH;;AACD,SAAKK,eAAL,CAAqB,KAArB;AACH,GALD;;AAMAzG,EAAAA,cAAc,CAAChC,SAAf,CAAyB0D,YAAzB,GAAwC,YAAY;AAChD,QAAItB,KAAK,GAAG,IAAZ;;AACA,QAAIsG,WAAW,GAAG;AACdC,MAAAA,SAAS,EAAE,YAAY;AAAE,eAAOvG,KAAK,CAACF,MAAb;AAAsB,OADjC;AAEdwD,MAAAA,SAAS,EAAE,YAAY;AAAE,eAAOtD,KAAK,CAACF,MAAN,CAAawD,SAAb,EAAP;AAAkC,OAF7C;AAGdwB,MAAAA,MAAM,EAAE,YAAY;AAAE,eAAO9E,KAAK,CAACO,IAAb;AAAoB,OAH5B;AAIdiG,MAAAA,WAAW,EAAE,YAAY;AAAE,eAAO,QAAP;AAAkB,OAJ/B;AAKdC,MAAAA,eAAe,EAAE,YAAY;AACzB,YAAIC,GAAG,GAAG1G,KAAK,CAACF,MAAN,CAAawD,SAAb,GAAyBqD,aAAnC;;AACA,eAAOD,GAAP;AACH;AARa,KAAlB;AAUA,QAAIE,cAAc,GAAG,KAAKlF,iBAAL,CAAuB,IAAIpC,cAAJ,CAAmBgH,WAAnB,EAAgC,KAAK1E,KAArC,CAAvB,CAArB;AACAgF,IAAAA,cAAc,CAACvG,OAAf,CAAuB,KAAKC,IAA5B;AACA,SAAKJ,gBAAL,CAAsB2G,IAAtB,CAA2B,YAAY;AAAE,aAAOD,cAAc,CAACE,cAAf,EAAP;AAAyC,KAAlF;AACH,GAfD;;AAgBAlH,EAAAA,cAAc,CAAChC,SAAf,CAAyByD,sBAAzB,GAAkD,YAAY;AAC1D,QAAIrB,KAAK,GAAG,IAAZ;;AACA,QAAI+G,oBAAoB,GAAG,YAAY;AACnC,UAAI1D,MAAM,GAAGrD,KAAK,CAACF,MAAN,CAAawD,SAAb,EAAb;;AACA,UAAI0D,GAAG,GAAGhH,KAAK,CAAC2E,kBAAhB;AACA,UAAIsC,OAAO,GAAGzH,eAAe,CAAC0H,0BAAhB,CAA2C7D,MAA3C,EAAmD2D,GAAnD,EAAwDhH,KAAK,CAACF,MAA9D,EAAsE,IAAtE,CAAd;AACA,UAAIqH,UAAU,GAAGnH,KAAK,CAACG,iBAAvB;AACAH,MAAAA,KAAK,CAACG,iBAAN,GAA0B,IAAIC,GAAJ,CAAQ6G,OAAR,CAA1B;AACAA,MAAAA,OAAO,CAACG,OAAR,CAAgB,UAAUjJ,CAAV,EAAa;AACzB,YAAIgJ,UAAU,CAACE,GAAX,CAAelJ,CAAf,CAAJ,EAAuB;AACnB;AACAgJ,UAAAA,UAAU,CAACG,MAAX,CAAkBnJ,CAAlB;AACH,SAHD,MAIK;AACD;AACA6B,UAAAA,KAAK,CAACM,IAAN,CAAWiH,mBAAX,CAA+BpJ,CAA/B,EAAkC,IAAlC;AACH;AACJ,OATD,EANmC,CAgBnC;;AACAgJ,MAAAA,UAAU,CAACC,OAAX,CAAmB,UAAUjJ,CAAV,EAAa;AAAE,eAAO6B,KAAK,CAACM,IAAN,CAAWiH,mBAAX,CAA+BpJ,CAA/B,EAAkC,KAAlC,CAAP;AAAkD,OAApF;AACH,KAlBD;;AAmBA,SAAK+B,gBAAL,CAAsB2G,IAAtB,CAA2BE,oBAA3B;AACAA,IAAAA,oBAAoB;AACvB,GAvBD;;AAwBAnH,EAAAA,cAAc,CAAChC,SAAf,CAAyBkH,MAAzB,GAAkC,YAAY;AAC1C,WAAO,KAAKvE,IAAZ;AACH,GAFD;;AAGAX,EAAAA,cAAc,CAAChC,SAAf,CAAyB4J,aAAzB,GAAyC,UAAUC,OAAV,EAAmB;AACxD,QAAIzH,KAAK,GAAG,IAAZ;;AACA,SAAK0H,iBAAL,GAAyBD,OAAzB;AACA,SAAKE,gBAAL;;AACA,QAAI,CAACF,OAAL,EAAc;AACV;AACH;;AACD,QAAI,CAAC,KAAKG,SAAV,EAAqB;AACjB;AACH;;AACD,SAAKC,cAAL,GAAsB;AAClBC,MAAAA,IAAI,EAAE9I,cAAc,CAAC+I,UADH;AAElBC,MAAAA,QAAQ,EAAEP,OAFQ;AAGlBQ,MAAAA,eAAe,EAAElJ,kBAAkB,CAACmJ,SAHlB;AAIlBC,MAAAA,WAAW,EAAE,YAAY;AAAE,eAAOnI,KAAK,CAACoI,cAAN,EAAP;AAAgC,OAJzC;AAKlBC,MAAAA,YAAY,EAAE,KAAK5E,WALD;AAMlB6E,MAAAA,aAAa,EAAE,YAAY;AAAE,eAAOtI,KAAK,CAACF,MAAN,CAAayI,SAAb,CAAuB,IAAvB,EAA6B,eAA7B,CAAP;AAAuD,OANlE;AAOlBC,MAAAA,aAAa,EAAE,YAAY;AAAE,eAAOxI,KAAK,CAACF,MAAN,CAAayI,SAAb,CAAuB,KAAvB,EAA8B,eAA9B,CAAP;AAAwD;AAPnE,KAAtB;AASA,SAAKE,kBAAL,CAAwBC,aAAxB,CAAsC,KAAKb,cAA3C,EAA2D,IAA3D;AACH,GApBD;;AAqBAjI,EAAAA,cAAc,CAAChC,SAAf,CAAyBwK,cAAzB,GAA0C,YAAY;AAClD,QAAIO,YAAY,GAAG,EAAnB;AACAA,IAAAA,YAAY,CAAC,KAAK7I,MAAL,CAAY8I,KAAZ,EAAD,CAAZ,GAAoC,KAAK9I,MAAL,CAAY+I,SAAZ,EAApC;AACA,WAAO;AACHC,MAAAA,OAAO,EAAE,CAAC,KAAKhJ,MAAN,CADN;AAEH6I,MAAAA,YAAY,EAAEA;AAFX,KAAP;AAIH,GAPD;;AAQA/I,EAAAA,cAAc,CAAChC,SAAf,CAAyB+J,gBAAzB,GAA4C,YAAY;AACpD,QAAI,KAAKE,cAAT,EAAyB;AACrB,WAAKY,kBAAL,CAAwBd,gBAAxB,CAAyC,KAAKE,cAA9C;AACA,WAAKA,cAAL,GAAsBkB,SAAtB;AACH;AACJ,GALD;;AAMAnJ,EAAAA,cAAc,CAAChC,SAAf,CAAyB2E,kBAAzB,GAA8C,YAAY;AACtD,QAAIyG,gBAAgB,GAAG,KAAKrI,WAAL,CAAiBC,gBAAjB,EAAvB;;AACA,QAAIoI,gBAAgB,IAAI,KAAKtI,aAA7B,EAA4C;AACxC,WAAKA,aAAL,GAAqBsI,gBAArB;AACA,WAAKC,OAAL;AACH;AACJ,GAND;;AAOArJ,EAAAA,cAAc,CAAChC,SAAf,CAAyBiD,WAAzB,GAAuC,YAAY;AAC/C,QAAIwC,MAAM,GAAG,KAAKvD,MAAL,CAAYwD,SAAZ,EAAb;AACA,SAAKO,WAAL,GAAmB,KAAKqF,WAAL,CAAiBpD,aAAjB,CAA+B,KAAKhG,MAApC,KAA+C,CAACuD,MAAM,CAAC8F,YAA1E;AACA,SAAKxF,QAAL,GAAgBN,MAAM,CAACM,QAAvB;AACA,SAAKF,WAAL,GAAmB,KAAK2F,oBAAL,EAAnB;AACA,SAAKxB,SAAL,GAAiB,KAAKyB,gBAAL,EAAjB;AACH,GAND;;AAOAzJ,EAAAA,cAAc,CAAChC,SAAf,CAAyB0L,kBAAzB,GAA8C,UAAUC,IAAV,EAAgB;AAC1D,SAAKrJ,gBAAL,CAAsB2G,IAAtB,CAA2B0C,IAA3B;AACH,GAFD;;AAGA3J,EAAAA,cAAc,CAAChC,SAAf,CAAyBqL,OAAzB,GAAmC,YAAY;AAC3C,SAAKpI,WAAL;AACA,SAAK2I,iBAAL;AACA,SAAKtJ,gBAAL,CAAsBkH,OAAtB,CAA8B,UAAUqC,CAAV,EAAa;AAAE,aAAOA,CAAC,EAAR;AAAa,KAA1D;AACH,GAJD;;AAKA7J,EAAAA,cAAc,CAAChC,SAAf,CAAyB4L,iBAAzB,GAA6C,YAAY;AACrD,QAAIE,cAAc,GAAG,KAAK3G,qBAAL,EAArB;AACA,QAAI4G,YAAY,GAAG,KAAKrJ,IAAL,CAAUkF,mBAAV,EAAnB,CAFqD,CAGrD;;AACA,QAAIoE,cAAc,GAAGD,YAAY,IAAI,IAAhB,IAAwB,KAAK1G,eAAL,CAAqB4G,cAArB,IAAuCH,cAAc,CAACG,cAAnG;AACA,QAAIC,mBAAmB,GAAGF,cAAc,GAAG,KAAKG,wBAAL,CAA8BL,cAAc,CAACvG,MAA7C,CAAH,GAA0D,KAAlG;;AACA,QAAI2G,mBAAJ,EAAyB;AACrB;AACA;AACA;AACA,WAAKtC,aAAL,CAAmB,KAAKE,iBAAxB;AACH,KALD,MAMK;AACD,WAAK1E,cAAL,CAAoB0G,cAApB;AACH;AACJ,GAfD;;AAgBA9J,EAAAA,cAAc,CAAChC,SAAf,CAAyBmM,wBAAzB,GAAoD,UAAU5G,MAAV,EAAkB;AAClE,QAAIoC,UAAU,GAAG,KAAKjF,IAAL,CAAUkF,mBAAV,EAAjB;;AACA,QAAI,CAACD,UAAL,EAAiB;AACb,aAAO,KAAP;AACH,KAJiE,CAKlE;;;AACA,QAAI,CAACA,UAAU,CAAC0D,OAAhB,EAAyB;AACrB,aAAO,KAAP;AACH;;AACD,QAAIvC,GAAG,GAAGnB,UAAU,CAAC0D,OAAX,CAAmB9F,MAAnB,CAAV;AACA,WAAOuD,GAAP;AACH,GAXD;;AAYA9G,EAAAA,cAAc,CAAChC,SAAf,CAAyBwL,oBAAzB,GAAgD,YAAY;AACxD,WAAO,KAAKzI,WAAL,CAAiBqJ,uBAAjB,CAAyC,KAAKlK,MAA9C,EAAsD,QAAtD,EAAgE,IAAhE,CAAP;AACH,GAFD;;AAGAF,EAAAA,cAAc,CAAChC,SAAf,CAAyBqM,gBAAzB,GAA4C,YAAY;AACpD;AACA,QAAI,KAAKxG,WAAL,KAAqB,KAAK2F,oBAAL,EAAzB,EAAsD;AAClD,WAAKH,OAAL;AACH;AACJ,GALD;;AAMArJ,EAAAA,cAAc,CAAChC,SAAf,CAAyByL,gBAAzB,GAA4C,YAAY;AACpD,QAAIhG,MAAM,GAAG,KAAKvD,MAAL,CAAYwD,SAAZ,EAAb;AACA,QAAI4G,wBAAwB,GAAG,KAAKvF,kBAAL,CAAwBuF,wBAAxB,EAA/B;AACA,QAAIC,UAAU,GAAG,CAACD,wBAAD,IAA6B,CAAC7G,MAAM,CAAC+G,eAArC,IAAwD,CAAC/G,MAAM,CAACgH,YAAjF,CAHoD,CAIpD;AACA;;AACA,WAAO,CAAC,CAACF,UAAF,IAAgB,CAAC,CAAC9G,MAAM,CAACiH,cAAzB,IAA2C,CAAC,CAACjH,MAAM,CAACkH,WAA3D;AACH,GAPD;;AAQA3K,EAAAA,cAAc,CAAChC,SAAf,CAAyB+E,uBAAzB,GAAmD,YAAY;AAC3D,SAAKsH,gBAAL;AACH,GAFD;;AAGArK,EAAAA,cAAc,CAAChC,SAAf,CAAyBiF,oBAAzB,GAAgD,YAAY;AACxD,SAAKoH,gBAAL;AACH,GAFD;;AAGArK,EAAAA,cAAc,CAAChC,SAAf,CAAyB6E,oBAAzB,GAAgD,YAAY;AACxD,SAAKwH,gBAAL;AACH,GAFD;;AAGArK,EAAAA,cAAc,CAAChC,SAAf,CAAyBkD,UAAzB,GAAsC,YAAY;AAC9C,QAAId,KAAK,GAAG,IAAZ;;AACA,QAAIwK,QAAQ,GAAG,YAAY;AACvBxK,MAAAA,KAAK,CAACM,IAAN,CAAWmK,QAAX,CAAoBzK,KAAK,CAACF,MAAN,CAAa4K,cAAb,KAAgC,IAApD;AACH,KAFD;;AAGA,SAAKtI,kBAAL,CAAwB,KAAKtC,MAA7B,EAAqCb,MAAM,CAAC0L,mBAA5C,EAAiEH,QAAjE;AACAA,IAAAA,QAAQ;AACX,GAPD;;AAQA5K,EAAAA,cAAc,CAAChC,SAAf,CAAyBmD,cAAzB,GAA0C,YAAY;AAClD,QAAIf,KAAK,GAAG,IAAZ;;AACA,QAAIwK,QAAQ,GAAG,YAAY;AACvB;AACA;AACAxK,MAAAA,KAAK,CAACM,IAAN,CAAWiH,mBAAX,CAA+B,uBAA/B,EAAwDvH,KAAK,CAACF,MAAN,CAAa8K,QAAb,EAAxD;AACH,KAJD;;AAKA,SAAKxI,kBAAL,CAAwB,KAAKtC,MAA7B,EAAqCb,MAAM,CAAC4L,oBAA5C,EAAkEL,QAAlE;AACAA,IAAAA,QAAQ;AACX,GATD;;AAUA5K,EAAAA,cAAc,CAAChC,SAAf,CAAyBoD,cAAzB,GAA0C,YAAY;AAClD,QAAIhB,KAAK,GAAG,IAAZ;;AACA,QAAIwK,QAAQ,GAAG,YAAY;AACvBxK,MAAAA,KAAK,CAACM,IAAN,CAAWiH,mBAAX,CAA+B,wBAA/B,EAAyDvH,KAAK,CAACF,MAAN,CAAagL,aAAb,EAAzD;AACH,KAFD;;AAGA,SAAK1I,kBAAL,CAAwB,KAAKtC,MAA7B,EAAqCb,MAAM,CAAC8L,0BAA5C,EAAwEP,QAAxE;AACAA,IAAAA,QAAQ;AACX,GAPD;;AAQA5K,EAAAA,cAAc,CAAChC,SAAf,CAAyBqD,kBAAzB,GAA8C,YAAY;AACtD,QAAIjB,KAAK,GAAG,IAAZ;;AACA,QAAIgL,sBAAsB,GAAG,YAAY;AACrChL,MAAAA,KAAK,CAACM,IAAN,CAAWiH,mBAAX,CAA+B,yBAA/B,EAA0D,CAAC,CAACvH,KAAK,CAAC2D,QAAlE;AACH,KAFD;;AAGA,QAAIsH,cAAc,GAAG,YAAY;AAC7B,UAAIjL,KAAK,CAAC2D,QAAV,EAAoB;AAChB3D,QAAAA,KAAK,CAACM,IAAN,CAAW4K,WAAX,CAAuB9L,gBAAgB,CAACY,KAAK,CAACF,MAAP,CAAvC;AACH,OAFD,MAGK;AACDE,QAAAA,KAAK,CAACM,IAAN,CAAW4K,WAAX,CAAuBnC,SAAvB;AACH;AACJ,KAPD;;AAQAiC,IAAAA,sBAAsB;AACtBC,IAAAA,cAAc;AACd,SAAK3B,kBAAL,CAAwB0B,sBAAxB;AACA,SAAK1B,kBAAL,CAAwB2B,cAAxB;AACA,SAAK7I,kBAAL,CAAwB,KAAKtC,MAA7B,EAAqCb,MAAM,CAACkM,kBAA5C,EAAgEF,cAAhE;AACH,GAlBD;;AAmBArL,EAAAA,cAAc,CAAChC,SAAf,CAAyBsD,sBAAzB,GAAkD,YAAY;AAC1D,QAAIlB,KAAK,GAAG,IAAZ;;AACA,QAAIwK,QAAQ,GAAG,YAAY;AACvB,UAAI,CAACxK,KAAK,CAAC2E,kBAAN,CAAyByG,sBAAzB,EAAL,EAAwD;AACpD;AACH;;AACD,UAAIC,SAAS,GAAGrL,KAAK,CAACsL,kBAAN,CAAyBD,SAAzB,CAAmCrL,KAAK,CAACF,MAAzC,CAAhB;;AACAE,MAAAA,KAAK,CAACM,IAAN,CAAWiH,mBAAX,CAA+B,iBAA/B,EAAkD8D,SAAlD;AACH,KAND;;AAOA,SAAKjJ,kBAAL,CAAwB,KAAKC,YAA7B,EAA2CnD,MAAM,CAACqM,0BAAlD,EAA8Ef,QAA9E;AACAA,IAAAA,QAAQ;AACX,GAXD;;AAYA5K,EAAAA,cAAc,CAAChC,SAAf,CAAyBuD,cAAzB,GAA0C,YAAY;AAClD,QAAInB,KAAK,GAAG,IAAZ;;AACA,QAAIwK,QAAQ,GAAG,YAAY;AACvBxK,MAAAA,KAAK,CAACM,IAAN,CAAWiH,mBAAX,CAA+B,yBAA/B,EAA0DvH,KAAK,CAACF,MAAN,CAAa0L,cAAb,EAA1D;AACH,KAFD;;AAGA,SAAKpJ,kBAAL,CAAwB,KAAKtC,MAA7B,EAAqCb,MAAM,CAACwM,2BAA5C,EAAyEjB,QAAzE;AACAA,IAAAA,QAAQ;AACX,GAPD;;AAQA5K,EAAAA,cAAc,CAAChC,SAAf,CAAyBwD,UAAzB,GAAsC,YAAY;AAC9C,SAAKd,IAAL,CAAUoL,QAAV,CAAmB,KAAK5L,MAAL,CAAY6L,QAAZ,EAAnB;AACH,GAFD;;AAGA/L,EAAAA,cAAc,CAAChC,SAAf,CAAyB2D,6BAAzB,GAAyD,YAAY;AACjE,QAAIvB,KAAK,GAAG,IAAZ;;AACA,QAAIwK,QAAQ,GAAG,UAAU1I,CAAV,EAAa;AAAE,aAAO9B,KAAK,CAACqG,eAAN,CAAsBvE,CAAC,CAACgG,IAAF,KAAW,YAAjC,CAAP;AAAwD,KAAtF;;AACA,SAAK1F,kBAAL,CAAwB,KAAK0C,MAAL,EAAxB,EAAuC,YAAvC,EAAqD0F,QAArD;AACA,SAAKpI,kBAAL,CAAwB,KAAK0C,MAAL,EAAxB,EAAuC,YAAvC,EAAqD0F,QAArD;AACH,GALD;;AAMA5K,EAAAA,cAAc,CAAChC,SAAf,CAAyByI,eAAzB,GAA2C,UAAUuF,MAAV,EAAkB;AACzD,SAAKtL,IAAL,CAAUiH,mBAAV,CAA8B,kBAA9B,EAAkDqE,MAAlD;AACH,GAFD;;AAGA9N,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,aAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,aAFnB,EAEkC,KAAK,CAFvC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,oBAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,oBAFnB,EAEyC,KAAK,CAF9C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,OAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,OAFnB,EAE4B,KAAK,CAFjC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,gBAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,gBAFnB,EAEqC,KAAK,CAF1C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,aAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,aAFnB,EAEkC,KAAK,CAFvC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,oBAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,oBAFnB,EAEyC,KAAK,CAF9C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,SAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,SAFnB,EAE8B,KAAK,CAFnC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,WAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,WAFnB,EAEgC,KAAK,CAFrC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,SAAS,CAAC,sBAAD,CADF,CAAD,EAEPe,cAAc,CAAChC,SAFR,EAEmB,sBAFnB,EAE2C,KAAK,CAFhD,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPgB,UADO,CAAD,EAEPc,cAAc,CAAChC,SAFR,EAEmB,kBAFnB,EAEuC,IAFvC,CAAV;;AAGA,SAAOgC,cAAP;AACH,CArYmC,CAqYlCL,sBArYkC,CAApC;;AAsYA,SAASK,cAAT","sourcesContent":["/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v26.2.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { KeyCode } from '../../../constants/keyCode';\nimport { Autowired, PreDestroy } from \"../../../context/context\";\nimport { DragAndDropService, DragSourceType } from \"../../../dragAndDrop/dragAndDropService\";\nimport { Column } from \"../../../entities/column\";\nimport { Events } from \"../../../eventKeys\";\nimport { SetLeftFeature } from \"../../../rendering/features/setLeftFeature\";\nimport { getAriaSortState } from \"../../../utils/aria\";\nimport { ManagedFocusFeature } from \"../../../widgets/managedFocusFeature\";\nimport { TooltipFeature } from \"../../../widgets/tooltipFeature\";\nimport { AbstractHeaderCellCtrl } from \"../abstractCell/abstractHeaderCellCtrl\";\nimport { CssClassApplier } from \"../cssClassApplier\";\nimport { HoverFeature } from \"../hoverFeature\";\nimport { ResizeFeature } from \"./resizeFeature\";\nimport { SelectAllFeature } from \"./selectAllFeature\";\nvar HeaderCellCtrl = /** @class */ (function (_super) {\n    __extends(HeaderCellCtrl, _super);\n    function HeaderCellCtrl(column, parentRowCtrl) {\n        var _this = _super.call(this, column, parentRowCtrl) || this;\n        _this.refreshFunctions = [];\n        _this.userHeaderClasses = new Set();\n        _this.column = column;\n        return _this;\n    }\n    HeaderCellCtrl.prototype.setComp = function (comp, eGui, eResize) {\n        var _this = this;\n        _super.prototype.setGui.call(this, eGui);\n        this.comp = comp;\n        this.colDefVersion = this.columnModel.getColDefVersion();\n        this.updateState();\n        this.setupWidth();\n        this.setupMovingCss();\n        this.setupMenuClass();\n        this.setupSortableClass();\n        this.addColumnHoverListener();\n        this.setupFilterCss();\n        this.setupColId();\n        this.setupClassesFromColDef();\n        this.setupTooltip();\n        this.addActiveHeaderMouseListeners();\n        this.setupSelectAll();\n        this.setupUserComp();\n        this.createManagedBean(new ResizeFeature(this.getPinned(), this.column, eResize, comp, this));\n        this.createManagedBean(new HoverFeature([this.column], eGui));\n        this.createManagedBean(new SetLeftFeature(this.column, eGui, this.beans));\n        this.createManagedBean(new ManagedFocusFeature(eGui, {\n            shouldStopEventPropagation: function (e) { return _this.shouldStopEventPropagation(e); },\n            onTabKeyDown: function () { return null; },\n            handleKeyDown: this.handleKeyDown.bind(this),\n            onFocusIn: this.onFocusIn.bind(this),\n            onFocusOut: this.onFocusOut.bind(this)\n        }));\n        this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.onNewColumnsLoaded.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VALUE_CHANGED, this.onColumnValueChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.onColumnRowGroupChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_CHANGED, this.onColumnPivotChanged.bind(this));\n    };\n    HeaderCellCtrl.prototype.setupUserComp = function () {\n        var compDetails = this.lookupUserCompDetails();\n        this.setCompDetails(compDetails);\n    };\n    HeaderCellCtrl.prototype.setCompDetails = function (compDetails) {\n        this.userCompDetails = compDetails;\n        this.comp.setUserCompDetails(compDetails);\n    };\n    HeaderCellCtrl.prototype.lookupUserCompDetails = function () {\n        var params = this.createParams();\n        var colDef = this.column.getColDef();\n        return this.userComponentFactory.getHeaderCompDetails(colDef, params);\n    };\n    HeaderCellCtrl.prototype.createParams = function () {\n        var _this = this;\n        var colDef = this.column.getColDef();\n        var params = {\n            column: this.column,\n            displayName: this.displayName,\n            enableSorting: colDef.sortable,\n            enableMenu: this.menuEnabled,\n            showColumnMenu: function (source) {\n                _this.gridApi.showColumnMenuAfterButtonClick(_this.column, source);\n            },\n            progressSort: function (multiSort) {\n                _this.sortController.progressSort(_this.column, !!multiSort, \"uiColumnSorted\");\n            },\n            setSort: function (sort, multiSort) {\n                _this.sortController.setSortForColumn(_this.column, sort, !!multiSort, \"uiColumnSorted\");\n            },\n            api: this.gridApi,\n            columnApi: this.columnApi,\n            context: this.gridOptionsWrapper.getContext(),\n            eGridHeader: this.getGui()\n        };\n        return params;\n    };\n    HeaderCellCtrl.prototype.setupSelectAll = function () {\n        this.selectAllFeature = this.createManagedBean(new SelectAllFeature(this.column));\n        this.selectAllFeature.setComp(this.comp);\n    };\n    HeaderCellCtrl.prototype.getSelectAllGui = function () {\n        return this.selectAllFeature.getCheckboxGui();\n    };\n    HeaderCellCtrl.prototype.handleKeyDown = function (e) {\n        if (e.keyCode === KeyCode.SPACE) {\n            this.selectAllFeature.onSpaceKeyPressed(e);\n        }\n        if (e.keyCode === KeyCode.ENTER) {\n            this.onEnterKeyPressed(e);\n        }\n    };\n    HeaderCellCtrl.prototype.onEnterKeyPressed = function (e) {\n        /// THIS IS BAD - we are assuming the header is not a user provided comp\n        var headerComp = this.comp.getUserCompInstance();\n        if (!headerComp) {\n            return;\n        }\n        if (e.ctrlKey || e.metaKey) {\n            if (this.menuEnabled && headerComp.showMenu) {\n                e.preventDefault();\n                headerComp.showMenu();\n            }\n        }\n        else if (this.sortable) {\n            var multiSort = e.shiftKey;\n            this.sortController.progressSort(this.column, multiSort, \"uiColumnSorted\");\n        }\n    };\n    HeaderCellCtrl.prototype.isMenuEnabled = function () {\n        return this.menuEnabled;\n    };\n    HeaderCellCtrl.prototype.onFocusIn = function (e) {\n        if (!this.getGui().contains(e.relatedTarget)) {\n            var rowIndex = this.getRowIndex();\n            this.focusService.setFocusedHeader(rowIndex, this.column);\n        }\n        this.setActiveHeader(true);\n    };\n    HeaderCellCtrl.prototype.onFocusOut = function (e) {\n        if (this.getGui().contains(e.relatedTarget)) {\n            return;\n        }\n        this.setActiveHeader(false);\n    };\n    HeaderCellCtrl.prototype.setupTooltip = function () {\n        var _this = this;\n        var tooltipCtrl = {\n            getColumn: function () { return _this.column; },\n            getColDef: function () { return _this.column.getColDef(); },\n            getGui: function () { return _this.eGui; },\n            getLocation: function () { return 'header'; },\n            getTooltipValue: function () {\n                var res = _this.column.getColDef().headerTooltip;\n                return res;\n            },\n        };\n        var tooltipFeature = this.createManagedBean(new TooltipFeature(tooltipCtrl, this.beans));\n        tooltipFeature.setComp(this.comp);\n        this.refreshFunctions.push(function () { return tooltipFeature.refreshToolTip(); });\n    };\n    HeaderCellCtrl.prototype.setupClassesFromColDef = function () {\n        var _this = this;\n        var refreshHeaderClasses = function () {\n            var colDef = _this.column.getColDef();\n            var goa = _this.gridOptionsWrapper;\n            var classes = CssClassApplier.getHeaderClassesFromColDef(colDef, goa, _this.column, null);\n            var oldClasses = _this.userHeaderClasses;\n            _this.userHeaderClasses = new Set(classes);\n            classes.forEach(function (c) {\n                if (oldClasses.has(c)) {\n                    // class already added, no need to apply it, but remove from old set\n                    oldClasses.delete(c);\n                }\n                else {\n                    // class new since last time, so apply it\n                    _this.comp.addOrRemoveCssClass(c, true);\n                }\n            });\n            // now old set only has classes that were applied last time, but not this time, so remove them\n            oldClasses.forEach(function (c) { return _this.comp.addOrRemoveCssClass(c, false); });\n        };\n        this.refreshFunctions.push(refreshHeaderClasses);\n        refreshHeaderClasses();\n    };\n    HeaderCellCtrl.prototype.getGui = function () {\n        return this.eGui;\n    };\n    HeaderCellCtrl.prototype.setDragSource = function (eSource) {\n        var _this = this;\n        this.dragSourceElement = eSource;\n        this.removeDragSource();\n        if (!eSource) {\n            return;\n        }\n        if (!this.draggable) {\n            return;\n        }\n        this.moveDragSource = {\n            type: DragSourceType.HeaderCell,\n            eElement: eSource,\n            defaultIconName: DragAndDropService.ICON_HIDE,\n            getDragItem: function () { return _this.createDragItem(); },\n            dragItemName: this.displayName,\n            onDragStarted: function () { return _this.column.setMoving(true, \"uiColumnMoved\"); },\n            onDragStopped: function () { return _this.column.setMoving(false, \"uiColumnMoved\"); }\n        };\n        this.dragAndDropService.addDragSource(this.moveDragSource, true);\n    };\n    HeaderCellCtrl.prototype.createDragItem = function () {\n        var visibleState = {};\n        visibleState[this.column.getId()] = this.column.isVisible();\n        return {\n            columns: [this.column],\n            visibleState: visibleState\n        };\n    };\n    HeaderCellCtrl.prototype.removeDragSource = function () {\n        if (this.moveDragSource) {\n            this.dragAndDropService.removeDragSource(this.moveDragSource);\n            this.moveDragSource = undefined;\n        }\n    };\n    HeaderCellCtrl.prototype.onNewColumnsLoaded = function () {\n        var colDefVersionNow = this.columnModel.getColDefVersion();\n        if (colDefVersionNow != this.colDefVersion) {\n            this.colDefVersion = colDefVersionNow;\n            this.refresh();\n        }\n    };\n    HeaderCellCtrl.prototype.updateState = function () {\n        var colDef = this.column.getColDef();\n        this.menuEnabled = this.menuFactory.isMenuEnabled(this.column) && !colDef.suppressMenu;\n        this.sortable = colDef.sortable;\n        this.displayName = this.calculateDisplayName();\n        this.draggable = this.workOutDraggable();\n    };\n    HeaderCellCtrl.prototype.addRefreshFunction = function (func) {\n        this.refreshFunctions.push(func);\n    };\n    HeaderCellCtrl.prototype.refresh = function () {\n        this.updateState();\n        this.refreshHeaderComp();\n        this.refreshFunctions.forEach(function (f) { return f(); });\n    };\n    HeaderCellCtrl.prototype.refreshHeaderComp = function () {\n        var newCompDetails = this.lookupUserCompDetails();\n        var compInstance = this.comp.getUserCompInstance();\n        // only try refresh if old comp exists adn it is the correct type\n        var attemptRefresh = compInstance != null && this.userCompDetails.componentClass == newCompDetails.componentClass;\n        var headerCompRefreshed = attemptRefresh ? this.attemptHeaderCompRefresh(newCompDetails.params) : false;\n        if (headerCompRefreshed) {\n            // we do this as a refresh happens after colDefs change, and it's possible the column has had it's\n            // draggable property toggled. no need to call this if not refreshing, as setDragSource is done\n            // as part of appendHeaderComp\n            this.setDragSource(this.dragSourceElement);\n        }\n        else {\n            this.setCompDetails(newCompDetails);\n        }\n    };\n    HeaderCellCtrl.prototype.attemptHeaderCompRefresh = function (params) {\n        var headerComp = this.comp.getUserCompInstance();\n        if (!headerComp) {\n            return false;\n        }\n        // if no refresh method, then we want to replace the headerComp\n        if (!headerComp.refresh) {\n            return false;\n        }\n        var res = headerComp.refresh(params);\n        return res;\n    };\n    HeaderCellCtrl.prototype.calculateDisplayName = function () {\n        return this.columnModel.getDisplayNameForColumn(this.column, 'header', true);\n    };\n    HeaderCellCtrl.prototype.checkDisplayName = function () {\n        // display name can change if aggFunc different, eg sum(Gold) is now max(Gold)\n        if (this.displayName !== this.calculateDisplayName()) {\n            this.refresh();\n        }\n    };\n    HeaderCellCtrl.prototype.workOutDraggable = function () {\n        var colDef = this.column.getColDef();\n        var isSuppressMovableColumns = this.gridOptionsWrapper.isSuppressMovableColumns();\n        var colCanMove = !isSuppressMovableColumns && !colDef.suppressMovable && !colDef.lockPosition;\n        // we should still be allowed drag the column, even if it can't be moved, if the column\n        // can be dragged to a rowGroup or pivot drop zone\n        return !!colCanMove || !!colDef.enableRowGroup || !!colDef.enablePivot;\n    };\n    HeaderCellCtrl.prototype.onColumnRowGroupChanged = function () {\n        this.checkDisplayName();\n    };\n    HeaderCellCtrl.prototype.onColumnPivotChanged = function () {\n        this.checkDisplayName();\n    };\n    HeaderCellCtrl.prototype.onColumnValueChanged = function () {\n        this.checkDisplayName();\n    };\n    HeaderCellCtrl.prototype.setupWidth = function () {\n        var _this = this;\n        var listener = function () {\n            _this.comp.setWidth(_this.column.getActualWidth() + 'px');\n        };\n        this.addManagedListener(this.column, Column.EVENT_WIDTH_CHANGED, listener);\n        listener();\n    };\n    HeaderCellCtrl.prototype.setupMovingCss = function () {\n        var _this = this;\n        var listener = function () {\n            // this is what makes the header go dark when it is been moved (gives impression to\n            // user that the column was picked up).\n            _this.comp.addOrRemoveCssClass('ag-header-cell-moving', _this.column.isMoving());\n        };\n        this.addManagedListener(this.column, Column.EVENT_MOVING_CHANGED, listener);\n        listener();\n    };\n    HeaderCellCtrl.prototype.setupMenuClass = function () {\n        var _this = this;\n        var listener = function () {\n            _this.comp.addOrRemoveCssClass('ag-column-menu-visible', _this.column.isMenuVisible());\n        };\n        this.addManagedListener(this.column, Column.EVENT_MENU_VISIBLE_CHANGED, listener);\n        listener();\n    };\n    HeaderCellCtrl.prototype.setupSortableClass = function () {\n        var _this = this;\n        var updateSortableCssClass = function () {\n            _this.comp.addOrRemoveCssClass('ag-header-cell-sortable', !!_this.sortable);\n        };\n        var updateAriaSort = function () {\n            if (_this.sortable) {\n                _this.comp.setAriaSort(getAriaSortState(_this.column));\n            }\n            else {\n                _this.comp.setAriaSort(undefined);\n            }\n        };\n        updateSortableCssClass();\n        updateAriaSort();\n        this.addRefreshFunction(updateSortableCssClass);\n        this.addRefreshFunction(updateAriaSort);\n        this.addManagedListener(this.column, Column.EVENT_SORT_CHANGED, updateAriaSort);\n    };\n    HeaderCellCtrl.prototype.addColumnHoverListener = function () {\n        var _this = this;\n        var listener = function () {\n            if (!_this.gridOptionsWrapper.isColumnHoverHighlight()) {\n                return;\n            }\n            var isHovered = _this.columnHoverService.isHovered(_this.column);\n            _this.comp.addOrRemoveCssClass('ag-column-hover', isHovered);\n        };\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_HOVER_CHANGED, listener);\n        listener();\n    };\n    HeaderCellCtrl.prototype.setupFilterCss = function () {\n        var _this = this;\n        var listener = function () {\n            _this.comp.addOrRemoveCssClass('ag-header-cell-filtered', _this.column.isFilterActive());\n        };\n        this.addManagedListener(this.column, Column.EVENT_FILTER_ACTIVE_CHANGED, listener);\n        listener();\n    };\n    HeaderCellCtrl.prototype.setupColId = function () {\n        this.comp.setColId(this.column.getColId());\n    };\n    HeaderCellCtrl.prototype.addActiveHeaderMouseListeners = function () {\n        var _this = this;\n        var listener = function (e) { return _this.setActiveHeader(e.type === 'mouseenter'); };\n        this.addManagedListener(this.getGui(), 'mouseenter', listener);\n        this.addManagedListener(this.getGui(), 'mouseleave', listener);\n    };\n    HeaderCellCtrl.prototype.setActiveHeader = function (active) {\n        this.comp.addOrRemoveCssClass('ag-header-active', active);\n    };\n    __decorate([\n        Autowired('columnModel')\n    ], HeaderCellCtrl.prototype, \"columnModel\", void 0);\n    __decorate([\n        Autowired('columnHoverService')\n    ], HeaderCellCtrl.prototype, \"columnHoverService\", void 0);\n    __decorate([\n        Autowired('beans')\n    ], HeaderCellCtrl.prototype, \"beans\", void 0);\n    __decorate([\n        Autowired('sortController')\n    ], HeaderCellCtrl.prototype, \"sortController\", void 0);\n    __decorate([\n        Autowired('menuFactory')\n    ], HeaderCellCtrl.prototype, \"menuFactory\", void 0);\n    __decorate([\n        Autowired('dragAndDropService')\n    ], HeaderCellCtrl.prototype, \"dragAndDropService\", void 0);\n    __decorate([\n        Autowired('gridApi')\n    ], HeaderCellCtrl.prototype, \"gridApi\", void 0);\n    __decorate([\n        Autowired('columnApi')\n    ], HeaderCellCtrl.prototype, \"columnApi\", void 0);\n    __decorate([\n        Autowired('userComponentFactory')\n    ], HeaderCellCtrl.prototype, \"userComponentFactory\", void 0);\n    __decorate([\n        PreDestroy\n    ], HeaderCellCtrl.prototype, \"removeDragSource\", null);\n    return HeaderCellCtrl;\n}(AbstractHeaderCellCtrl));\nexport { HeaderCellCtrl };\n"]},"metadata":{},"sourceType":"module"}