{"ast":null,"code":"/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v26.2.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { BeanStub } from \"../context/beanStub\";\nimport { Autowired, Optional } from \"../context/context\";\nimport { LayoutFeature } from \"../styling/layoutFeature\";\nimport { Constants } from \"../constants/constants\";\nimport { Events } from \"../eventKeys\";\nimport { getTarget } from \"../utils/event\";\nimport { GridBodyScrollFeature } from \"./gridBodyScrollFeature\";\nimport { getInnerWidth, isVerticalScrollShowing, addCssClass, removeCssClass } from \"../utils/dom\";\nimport { RowDragFeature } from \"./rowDragFeature\";\nimport { getTabIndex, isBrowserIE } from \"../utils/browser\";\nexport var RowAnimationCssClasses;\n\n(function (RowAnimationCssClasses) {\n  RowAnimationCssClasses[\"ANIMATION_ON\"] = \"ag-row-animation\";\n  RowAnimationCssClasses[\"ANIMATION_OFF\"] = \"ag-row-no-animation\";\n})(RowAnimationCssClasses || (RowAnimationCssClasses = {}));\n\nexport var CSS_CLASS_CELL_SELECTABLE = 'ag-selectable';\nexport var CSS_CLASS_FORCE_VERTICAL_SCROLL = 'ag-force-vertical-scroll';\nexport var CSS_CLASS_COLUMN_MOVING = 'ag-column-moving';\n\nvar GridBodyCtrl =\n/** @class */\nfunction (_super) {\n  __extends(GridBodyCtrl, _super);\n\n  function GridBodyCtrl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.angularApplyTriggered = false;\n    return _this;\n  }\n\n  GridBodyCtrl.prototype.getScrollFeature = function () {\n    return this.bodyScrollFeature;\n  };\n\n  GridBodyCtrl.prototype.getBodyViewportElement = function () {\n    return this.eBodyViewport;\n  };\n\n  GridBodyCtrl.prototype.setComp = function (comp, eGridBody, eBodyViewport, eTop, eBottom) {\n    this.comp = comp;\n    this.eGridBody = eGridBody;\n    this.eBodyViewport = eBodyViewport;\n    this.eTop = eTop;\n    this.eBottom = eBottom;\n    this.setCellTextSelection(this.gridOptionsWrapper.isEnableCellTextSelect());\n    this.createManagedBean(new LayoutFeature(this.comp));\n    this.bodyScrollFeature = this.createManagedBean(new GridBodyScrollFeature(this.eBodyViewport));\n    this.addRowDragListener();\n    this.setupRowAnimationCssClass();\n    this.ctrlsService.registerGridBodyCtrl(this);\n    this.addEventListeners();\n    this.addFocusListeners([eTop, eBodyViewport, eBottom]);\n    this.onGridColumnsChanged();\n    this.addBodyViewportListener();\n    this.setFloatingHeights();\n    this.disableBrowserDragging();\n    this.addStopEditingWhenGridLosesFocus();\n\n    if (this.$scope) {\n      this.addAngularApplyCheck();\n    }\n  };\n\n  GridBodyCtrl.prototype.getComp = function () {\n    return this.comp;\n  };\n\n  GridBodyCtrl.prototype.addEventListeners = function () {\n    this.addManagedListener(this.eventService, Events.EVENT_GRID_COLUMNS_CHANGED, this.onGridColumnsChanged.bind(this));\n    this.addManagedListener(this.eventService, Events.EVENT_SCROLL_VISIBILITY_CHANGED, this.onScrollVisibilityChanged.bind(this));\n    this.addManagedListener(this.eventService, Events.EVENT_PINNED_ROW_DATA_CHANGED, this.setFloatingHeights.bind(this));\n  };\n\n  GridBodyCtrl.prototype.addFocusListeners = function (elements) {\n    var _this = this;\n\n    elements.forEach(function (element) {\n      _this.addManagedListener(element, 'focusin', function () {\n        addCssClass(element, 'ag-has-focus');\n      });\n\n      _this.addManagedListener(element, 'focusout', function (e) {\n        if (!element.contains(e.relatedTarget)) {\n          removeCssClass(element, 'ag-has-focus');\n        }\n      });\n    });\n  }; // used by ColumnAnimationService\n\n\n  GridBodyCtrl.prototype.setColumnMovingCss = function (moving) {\n    this.comp.setColumnMovingCss(moving ? CSS_CLASS_COLUMN_MOVING : null, moving);\n  };\n\n  GridBodyCtrl.prototype.setCellTextSelection = function (selectable) {\n    if (selectable === void 0) {\n      selectable = false;\n    }\n\n    var cssClass = selectable ? CSS_CLASS_CELL_SELECTABLE : null;\n    this.comp.setCellSelectableCss(cssClass, selectable);\n  };\n\n  GridBodyCtrl.prototype.onScrollVisibilityChanged = function () {\n    var visible = this.scrollVisibleService.isVerticalScrollShowing();\n    this.setVerticalScrollPaddingVisible(visible);\n  };\n\n  GridBodyCtrl.prototype.onGridColumnsChanged = function () {\n    var columns = this.columnModel.getAllGridColumns();\n    this.comp.setColumnCount(columns ? columns.length : 0);\n  }; // if we do not do this, then the user can select a pic in the grid (eg an image in a custom cell renderer)\n  // and then that will start the browser native drag n' drop, which messes up with our own drag and drop.\n\n\n  GridBodyCtrl.prototype.disableBrowserDragging = function () {\n    this.addManagedListener(this.eGridBody, 'dragstart', function (event) {\n      if (event.target instanceof HTMLImageElement) {\n        event.preventDefault();\n        return false;\n      }\n    });\n  };\n\n  GridBodyCtrl.prototype.addStopEditingWhenGridLosesFocus = function () {\n    var _this = this;\n\n    if (!this.gridOptionsWrapper.isStopEditingWhenCellsLoseFocus()) {\n      return;\n    }\n\n    var focusOutListener = function (event) {\n      // this is the element the focus is moving to\n      var elementWithFocus = event.relatedTarget;\n\n      if (getTabIndex(elementWithFocus) === null) {\n        _this.rowRenderer.stopEditing();\n\n        return;\n      }\n\n      var clickInsideGrid = // see if click came from inside the viewports\n      viewports.some(function (viewport) {\n        return viewport.contains(elementWithFocus);\n      }) // and also that it's not from a detail grid\n      && _this.mouseEventService.isElementInThisGrid(elementWithFocus);\n\n      if (!clickInsideGrid) {\n        var popupService = _this.popupService;\n        clickInsideGrid = popupService.getActivePopups().some(function (popup) {\n          return popup.contains(elementWithFocus);\n        }) || popupService.isElementWithinCustomPopup(elementWithFocus);\n      }\n\n      if (!clickInsideGrid) {\n        _this.rowRenderer.stopEditing();\n      }\n    };\n\n    var viewports = [this.eBodyViewport, this.eBottom, this.eTop];\n    viewports.forEach(function (viewport) {\n      return _this.addManagedListener(viewport, 'focusout', focusOutListener);\n    });\n  };\n\n  GridBodyCtrl.prototype.updateRowCount = function () {\n    var headerCount = this.headerNavigationService.getHeaderRowCount();\n    var modelType = this.paginationProxy.getType();\n    var rowCount = -1;\n\n    if (modelType === Constants.ROW_MODEL_TYPE_CLIENT_SIDE) {\n      rowCount = 0;\n      this.paginationProxy.forEachNode(function (node) {\n        if (!node.group) {\n          rowCount++;\n        }\n      });\n    }\n\n    var total = rowCount === -1 ? -1 : headerCount + rowCount;\n    this.comp.setRowCount(total);\n  };\n\n  GridBodyCtrl.prototype.registerBodyViewportResizeListener = function (listener) {\n    this.comp.registerBodyViewportResizeListener(listener);\n  };\n\n  GridBodyCtrl.prototype.setVerticalScrollPaddingVisible = function (visible) {\n    var overflowY = visible ? 'scroll' : 'hidden';\n    this.comp.setPinnedTopBottomOverflowY(overflowY);\n  };\n\n  GridBodyCtrl.prototype.isVerticalScrollShowing = function () {\n    var show = this.gridOptionsWrapper.isAlwaysShowVerticalScroll();\n    var cssClass = show ? CSS_CLASS_FORCE_VERTICAL_SCROLL : null;\n    this.comp.setAlwaysVerticalScrollClass(cssClass, show);\n    return show || isVerticalScrollShowing(this.eBodyViewport);\n  };\n\n  GridBodyCtrl.prototype.setupRowAnimationCssClass = function () {\n    var _this = this;\n\n    var listener = function () {\n      // we don't want to use row animation if scaling, as rows jump strangely as you scroll,\n      // when scaling and doing row animation.\n      var animateRows = _this.gridOptionsWrapper.isAnimateRows() && !_this.rowContainerHeightService.isStretching();\n      var animateRowsCssClass = animateRows ? RowAnimationCssClasses.ANIMATION_ON : RowAnimationCssClasses.ANIMATION_OFF;\n\n      _this.comp.setRowAnimationCssOnBodyViewport(animateRowsCssClass, animateRows);\n    };\n\n    listener();\n    this.addManagedListener(this.eventService, Events.EVENT_HEIGHT_SCALE_CHANGED, listener);\n  };\n\n  GridBodyCtrl.prototype.getGridBodyElement = function () {\n    return this.eGridBody;\n  };\n\n  GridBodyCtrl.prototype.addBodyViewportListener = function () {\n    var _this = this; // we want to listen for clicks directly on the eBodyViewport, so the user has a way of showing\n    // the context menu if no rows or columns are displayed, or user simply clicks outside of a cell\n\n\n    var listener = function (mouseEvent) {\n      if (_this.gridOptionsWrapper.isPreventDefaultOnContextMenu()) {\n        mouseEvent.preventDefault();\n      }\n\n      var target = getTarget(mouseEvent);\n\n      if (target === _this.eBodyViewport || target === _this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()) {\n        // show it\n        if (_this.contextMenuFactory) {\n          _this.contextMenuFactory.onContextMenu(mouseEvent, null, null, null, null, _this.eGridBody);\n        }\n      }\n    };\n\n    this.addManagedListener(this.eBodyViewport, 'contextmenu', listener);\n    this.addManagedListener(this.eBodyViewport, 'wheel', this.onWheel.bind(this));\n  };\n\n  GridBodyCtrl.prototype.onWheel = function (e) {\n    if (!this.gridOptionsWrapper.isSuppressScrollWhenPopupsAreOpen()) {\n      return;\n    }\n\n    if (this.popupService.hasAnchoredPopup()) {\n      e.preventDefault();\n    }\n  };\n\n  GridBodyCtrl.prototype.getGui = function () {\n    return this.eGridBody;\n  }; // called by rowDragFeature\n\n\n  GridBodyCtrl.prototype.scrollVertically = function (pixels) {\n    var oldScrollPosition = this.eBodyViewport.scrollTop;\n    this.bodyScrollFeature.setVerticalScrollPosition(oldScrollPosition + pixels);\n    return this.eBodyViewport.scrollTop - oldScrollPosition;\n  };\n\n  GridBodyCtrl.prototype.addRowDragListener = function () {\n    this.rowDragFeature = this.createManagedBean(new RowDragFeature(this.eBodyViewport));\n    this.dragAndDropService.addDropTarget(this.rowDragFeature);\n  };\n\n  GridBodyCtrl.prototype.getRowDragFeature = function () {\n    return this.rowDragFeature;\n  };\n\n  GridBodyCtrl.prototype.setFloatingHeights = function () {\n    var pinnedRowModel = this.pinnedRowModel;\n    var floatingTopHeight = pinnedRowModel.getPinnedTopTotalHeight();\n\n    if (floatingTopHeight) {\n      // adding 1px for cell bottom border\n      floatingTopHeight += 1;\n    }\n\n    var floatingBottomHeight = pinnedRowModel.getPinnedBottomTotalHeight();\n\n    if (floatingBottomHeight) {\n      // adding 1px for cell bottom border\n      floatingBottomHeight += 1;\n    }\n\n    this.comp.setTopHeight(floatingTopHeight);\n    this.comp.setBottomHeight(floatingBottomHeight);\n    this.comp.setTopDisplay(floatingTopHeight ? 'inherit' : 'none');\n    this.comp.setBottomDisplay(floatingBottomHeight ? 'inherit' : 'none');\n  }; // method will call itself if no available width. this covers if the grid\n  // isn't visible, but is just about to be visible.\n\n\n  GridBodyCtrl.prototype.sizeColumnsToFit = function (nextTimeout) {\n    var _this = this; // IE is different to the other browsers, it already removes the scroll width\n    // while calling window.getComputedStyle() (which is called by getInnerWidth())\n\n\n    var removeScrollWidth = this.isVerticalScrollShowing() && !isBrowserIE();\n    var scrollWidthToRemove = removeScrollWidth ? this.gridOptionsWrapper.getScrollbarWidth() : 0;\n    var bodyViewportWidth = getInnerWidth(this.eBodyViewport);\n    var availableWidth = bodyViewportWidth - scrollWidthToRemove;\n\n    if (availableWidth > 0) {\n      this.columnModel.sizeColumnsToFit(availableWidth, \"sizeColumnsToFit\");\n      return;\n    }\n\n    if (nextTimeout === undefined) {\n      window.setTimeout(function () {\n        _this.sizeColumnsToFit(100);\n      }, 0);\n    } else if (nextTimeout === 100) {\n      window.setTimeout(function () {\n        _this.sizeColumnsToFit(500);\n      }, 100);\n    } else if (nextTimeout === 500) {\n      window.setTimeout(function () {\n        _this.sizeColumnsToFit(-1);\n      }, 500);\n    } else {\n      console.warn('AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with ' + 'zero width, maybe the grid is not visible yet on the screen?');\n    }\n  }; // + rangeService\n\n\n  GridBodyCtrl.prototype.addScrollEventListener = function (listener) {\n    this.eBodyViewport.addEventListener('scroll', listener);\n  }; // + focusService\n\n\n  GridBodyCtrl.prototype.removeScrollEventListener = function (listener) {\n    this.eBodyViewport.removeEventListener('scroll', listener);\n  };\n\n  GridBodyCtrl.prototype.requestAngularApply = function () {\n    var _this = this;\n\n    if (this.angularApplyTriggered) {\n      return;\n    }\n\n    this.angularApplyTriggered = true;\n    window.setTimeout(function () {\n      _this.angularApplyTriggered = false;\n\n      _this.$scope.$apply();\n    }, 0);\n  };\n\n  GridBodyCtrl.prototype.addAngularApplyCheck = function () {\n    var _this = this; // these are the events we need to do an apply after - these are the ones that can end up\n    // with columns added or removed\n\n\n    this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, function () {\n      return _this.requestAngularApply();\n    });\n    this.addManagedListener(this.eventService, Events.EVENT_VIRTUAL_COLUMNS_CHANGED, function () {\n      return _this.requestAngularApply();\n    });\n  };\n\n  __decorate([Autowired('rowContainerHeightService')], GridBodyCtrl.prototype, \"rowContainerHeightService\", void 0);\n\n  __decorate([Autowired('ctrlsService')], GridBodyCtrl.prototype, \"ctrlsService\", void 0);\n\n  __decorate([Autowired('columnModel')], GridBodyCtrl.prototype, \"columnModel\", void 0);\n\n  __decorate([Autowired('scrollVisibleService')], GridBodyCtrl.prototype, \"scrollVisibleService\", void 0);\n\n  __decorate([Optional('contextMenuFactory')], GridBodyCtrl.prototype, \"contextMenuFactory\", void 0);\n\n  __decorate([Autowired('headerNavigationService')], GridBodyCtrl.prototype, \"headerNavigationService\", void 0);\n\n  __decorate([Autowired('paginationProxy')], GridBodyCtrl.prototype, \"paginationProxy\", void 0);\n\n  __decorate([Autowired('dragAndDropService')], GridBodyCtrl.prototype, \"dragAndDropService\", void 0);\n\n  __decorate([Autowired('pinnedRowModel')], GridBodyCtrl.prototype, \"pinnedRowModel\", void 0);\n\n  __decorate([Autowired('rowRenderer')], GridBodyCtrl.prototype, \"rowRenderer\", void 0);\n\n  __decorate([Autowired('popupService')], GridBodyCtrl.prototype, \"popupService\", void 0);\n\n  __decorate([Autowired('mouseEventService')], GridBodyCtrl.prototype, \"mouseEventService\", void 0);\n\n  __decorate([Autowired('$scope')], GridBodyCtrl.prototype, \"$scope\", void 0);\n\n  return GridBodyCtrl;\n}(BeanStub);\n\nexport { GridBodyCtrl };","map":{"version":3,"sources":["/Users/rongxuan/Desktop/reactmap/reactmap/node_modules/@ag-grid-community/core/dist/es6/gridBodyComp/gridBodyCtrl.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","BeanStub","Autowired","Optional","LayoutFeature","Constants","Events","getTarget","GridBodyScrollFeature","getInnerWidth","isVerticalScrollShowing","addCssClass","removeCssClass","RowDragFeature","getTabIndex","isBrowserIE","RowAnimationCssClasses","CSS_CLASS_CELL_SELECTABLE","CSS_CLASS_FORCE_VERTICAL_SCROLL","CSS_CLASS_COLUMN_MOVING","GridBodyCtrl","_super","_this","apply","angularApplyTriggered","getScrollFeature","bodyScrollFeature","getBodyViewportElement","eBodyViewport","setComp","comp","eGridBody","eTop","eBottom","setCellTextSelection","gridOptionsWrapper","isEnableCellTextSelect","createManagedBean","addRowDragListener","setupRowAnimationCssClass","ctrlsService","registerGridBodyCtrl","addEventListeners","addFocusListeners","onGridColumnsChanged","addBodyViewportListener","setFloatingHeights","disableBrowserDragging","addStopEditingWhenGridLosesFocus","$scope","addAngularApplyCheck","getComp","addManagedListener","eventService","EVENT_GRID_COLUMNS_CHANGED","bind","EVENT_SCROLL_VISIBILITY_CHANGED","onScrollVisibilityChanged","EVENT_PINNED_ROW_DATA_CHANGED","elements","forEach","element","e","contains","relatedTarget","setColumnMovingCss","moving","selectable","cssClass","setCellSelectableCss","visible","scrollVisibleService","setVerticalScrollPaddingVisible","columns","columnModel","getAllGridColumns","setColumnCount","event","HTMLImageElement","preventDefault","isStopEditingWhenCellsLoseFocus","focusOutListener","elementWithFocus","rowRenderer","stopEditing","clickInsideGrid","viewports","some","viewport","mouseEventService","isElementInThisGrid","popupService","getActivePopups","popup","isElementWithinCustomPopup","updateRowCount","headerCount","headerNavigationService","getHeaderRowCount","modelType","paginationProxy","getType","rowCount","ROW_MODEL_TYPE_CLIENT_SIDE","forEachNode","node","group","total","setRowCount","registerBodyViewportResizeListener","listener","overflowY","setPinnedTopBottomOverflowY","show","isAlwaysShowVerticalScroll","setAlwaysVerticalScrollClass","animateRows","isAnimateRows","rowContainerHeightService","isStretching","animateRowsCssClass","ANIMATION_ON","ANIMATION_OFF","setRowAnimationCssOnBodyViewport","EVENT_HEIGHT_SCALE_CHANGED","getGridBodyElement","mouseEvent","isPreventDefaultOnContextMenu","getCenterRowContainerCtrl","getViewportElement","contextMenuFactory","onContextMenu","onWheel","isSuppressScrollWhenPopupsAreOpen","hasAnchoredPopup","getGui","scrollVertically","pixels","oldScrollPosition","scrollTop","setVerticalScrollPosition","rowDragFeature","dragAndDropService","addDropTarget","getRowDragFeature","pinnedRowModel","floatingTopHeight","getPinnedTopTotalHeight","floatingBottomHeight","getPinnedBottomTotalHeight","setTopHeight","setBottomHeight","setTopDisplay","setBottomDisplay","sizeColumnsToFit","nextTimeout","removeScrollWidth","scrollWidthToRemove","getScrollbarWidth","bodyViewportWidth","availableWidth","undefined","window","setTimeout","console","warn","addScrollEventListener","addEventListener","removeScrollEventListener","removeEventListener","requestAngularApply","$apply","EVENT_DISPLAYED_COLUMNS_CHANGED","EVENT_VIRTUAL_COLUMNS_CHANGED"],"mappings":"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","sourcesContent":["/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v26.2.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { BeanStub } from \"../context/beanStub\";\nimport { Autowired, Optional } from \"../context/context\";\nimport { LayoutFeature } from \"../styling/layoutFeature\";\nimport { Constants } from \"../constants/constants\";\nimport { Events } from \"../eventKeys\";\nimport { getTarget } from \"../utils/event\";\nimport { GridBodyScrollFeature } from \"./gridBodyScrollFeature\";\nimport { getInnerWidth, isVerticalScrollShowing, addCssClass, removeCssClass } from \"../utils/dom\";\nimport { RowDragFeature } from \"./rowDragFeature\";\nimport { getTabIndex, isBrowserIE } from \"../utils/browser\";\nexport var RowAnimationCssClasses;\n(function (RowAnimationCssClasses) {\n    RowAnimationCssClasses[\"ANIMATION_ON\"] = \"ag-row-animation\";\n    RowAnimationCssClasses[\"ANIMATION_OFF\"] = \"ag-row-no-animation\";\n})(RowAnimationCssClasses || (RowAnimationCssClasses = {}));\nexport var CSS_CLASS_CELL_SELECTABLE = 'ag-selectable';\nexport var CSS_CLASS_FORCE_VERTICAL_SCROLL = 'ag-force-vertical-scroll';\nexport var CSS_CLASS_COLUMN_MOVING = 'ag-column-moving';\nvar GridBodyCtrl = /** @class */ (function (_super) {\n    __extends(GridBodyCtrl, _super);\n    function GridBodyCtrl() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.angularApplyTriggered = false;\n        return _this;\n    }\n    GridBodyCtrl.prototype.getScrollFeature = function () {\n        return this.bodyScrollFeature;\n    };\n    GridBodyCtrl.prototype.getBodyViewportElement = function () {\n        return this.eBodyViewport;\n    };\n    GridBodyCtrl.prototype.setComp = function (comp, eGridBody, eBodyViewport, eTop, eBottom) {\n        this.comp = comp;\n        this.eGridBody = eGridBody;\n        this.eBodyViewport = eBodyViewport;\n        this.eTop = eTop;\n        this.eBottom = eBottom;\n        this.setCellTextSelection(this.gridOptionsWrapper.isEnableCellTextSelect());\n        this.createManagedBean(new LayoutFeature(this.comp));\n        this.bodyScrollFeature = this.createManagedBean(new GridBodyScrollFeature(this.eBodyViewport));\n        this.addRowDragListener();\n        this.setupRowAnimationCssClass();\n        this.ctrlsService.registerGridBodyCtrl(this);\n        this.addEventListeners();\n        this.addFocusListeners([eTop, eBodyViewport, eBottom]);\n        this.onGridColumnsChanged();\n        this.addBodyViewportListener();\n        this.setFloatingHeights();\n        this.disableBrowserDragging();\n        this.addStopEditingWhenGridLosesFocus();\n        if (this.$scope) {\n            this.addAngularApplyCheck();\n        }\n    };\n    GridBodyCtrl.prototype.getComp = function () {\n        return this.comp;\n    };\n    GridBodyCtrl.prototype.addEventListeners = function () {\n        this.addManagedListener(this.eventService, Events.EVENT_GRID_COLUMNS_CHANGED, this.onGridColumnsChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_SCROLL_VISIBILITY_CHANGED, this.onScrollVisibilityChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_PINNED_ROW_DATA_CHANGED, this.setFloatingHeights.bind(this));\n    };\n    GridBodyCtrl.prototype.addFocusListeners = function (elements) {\n        var _this = this;\n        elements.forEach(function (element) {\n            _this.addManagedListener(element, 'focusin', function () {\n                addCssClass(element, 'ag-has-focus');\n            });\n            _this.addManagedListener(element, 'focusout', function (e) {\n                if (!element.contains(e.relatedTarget)) {\n                    removeCssClass(element, 'ag-has-focus');\n                }\n            });\n        });\n    };\n    // used by ColumnAnimationService\n    GridBodyCtrl.prototype.setColumnMovingCss = function (moving) {\n        this.comp.setColumnMovingCss(moving ? CSS_CLASS_COLUMN_MOVING : null, moving);\n    };\n    GridBodyCtrl.prototype.setCellTextSelection = function (selectable) {\n        if (selectable === void 0) { selectable = false; }\n        var cssClass = selectable ? CSS_CLASS_CELL_SELECTABLE : null;\n        this.comp.setCellSelectableCss(cssClass, selectable);\n    };\n    GridBodyCtrl.prototype.onScrollVisibilityChanged = function () {\n        var visible = this.scrollVisibleService.isVerticalScrollShowing();\n        this.setVerticalScrollPaddingVisible(visible);\n    };\n    GridBodyCtrl.prototype.onGridColumnsChanged = function () {\n        var columns = this.columnModel.getAllGridColumns();\n        this.comp.setColumnCount(columns ? columns.length : 0);\n    };\n    // if we do not do this, then the user can select a pic in the grid (eg an image in a custom cell renderer)\n    // and then that will start the browser native drag n' drop, which messes up with our own drag and drop.\n    GridBodyCtrl.prototype.disableBrowserDragging = function () {\n        this.addManagedListener(this.eGridBody, 'dragstart', function (event) {\n            if (event.target instanceof HTMLImageElement) {\n                event.preventDefault();\n                return false;\n            }\n        });\n    };\n    GridBodyCtrl.prototype.addStopEditingWhenGridLosesFocus = function () {\n        var _this = this;\n        if (!this.gridOptionsWrapper.isStopEditingWhenCellsLoseFocus()) {\n            return;\n        }\n        var focusOutListener = function (event) {\n            // this is the element the focus is moving to\n            var elementWithFocus = event.relatedTarget;\n            if (getTabIndex(elementWithFocus) === null) {\n                _this.rowRenderer.stopEditing();\n                return;\n            }\n            var clickInsideGrid = \n            // see if click came from inside the viewports\n            viewports.some(function (viewport) { return viewport.contains(elementWithFocus); })\n                // and also that it's not from a detail grid\n                && _this.mouseEventService.isElementInThisGrid(elementWithFocus);\n            if (!clickInsideGrid) {\n                var popupService = _this.popupService;\n                clickInsideGrid =\n                    popupService.getActivePopups().some(function (popup) { return popup.contains(elementWithFocus); }) ||\n                        popupService.isElementWithinCustomPopup(elementWithFocus);\n            }\n            if (!clickInsideGrid) {\n                _this.rowRenderer.stopEditing();\n            }\n        };\n        var viewports = [this.eBodyViewport, this.eBottom, this.eTop];\n        viewports.forEach(function (viewport) { return _this.addManagedListener(viewport, 'focusout', focusOutListener); });\n    };\n    GridBodyCtrl.prototype.updateRowCount = function () {\n        var headerCount = this.headerNavigationService.getHeaderRowCount();\n        var modelType = this.paginationProxy.getType();\n        var rowCount = -1;\n        if (modelType === Constants.ROW_MODEL_TYPE_CLIENT_SIDE) {\n            rowCount = 0;\n            this.paginationProxy.forEachNode(function (node) {\n                if (!node.group) {\n                    rowCount++;\n                }\n            });\n        }\n        var total = rowCount === -1 ? -1 : (headerCount + rowCount);\n        this.comp.setRowCount(total);\n    };\n    GridBodyCtrl.prototype.registerBodyViewportResizeListener = function (listener) {\n        this.comp.registerBodyViewportResizeListener(listener);\n    };\n    GridBodyCtrl.prototype.setVerticalScrollPaddingVisible = function (visible) {\n        var overflowY = visible ? 'scroll' : 'hidden';\n        this.comp.setPinnedTopBottomOverflowY(overflowY);\n    };\n    GridBodyCtrl.prototype.isVerticalScrollShowing = function () {\n        var show = this.gridOptionsWrapper.isAlwaysShowVerticalScroll();\n        var cssClass = show ? CSS_CLASS_FORCE_VERTICAL_SCROLL : null;\n        this.comp.setAlwaysVerticalScrollClass(cssClass, show);\n        return show || isVerticalScrollShowing(this.eBodyViewport);\n    };\n    GridBodyCtrl.prototype.setupRowAnimationCssClass = function () {\n        var _this = this;\n        var listener = function () {\n            // we don't want to use row animation if scaling, as rows jump strangely as you scroll,\n            // when scaling and doing row animation.\n            var animateRows = _this.gridOptionsWrapper.isAnimateRows() && !_this.rowContainerHeightService.isStretching();\n            var animateRowsCssClass = animateRows ? RowAnimationCssClasses.ANIMATION_ON : RowAnimationCssClasses.ANIMATION_OFF;\n            _this.comp.setRowAnimationCssOnBodyViewport(animateRowsCssClass, animateRows);\n        };\n        listener();\n        this.addManagedListener(this.eventService, Events.EVENT_HEIGHT_SCALE_CHANGED, listener);\n    };\n    GridBodyCtrl.prototype.getGridBodyElement = function () {\n        return this.eGridBody;\n    };\n    GridBodyCtrl.prototype.addBodyViewportListener = function () {\n        var _this = this;\n        // we want to listen for clicks directly on the eBodyViewport, so the user has a way of showing\n        // the context menu if no rows or columns are displayed, or user simply clicks outside of a cell\n        var listener = function (mouseEvent) {\n            if (_this.gridOptionsWrapper.isPreventDefaultOnContextMenu()) {\n                mouseEvent.preventDefault();\n            }\n            var target = getTarget(mouseEvent);\n            if (target === _this.eBodyViewport || target === _this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()) {\n                // show it\n                if (_this.contextMenuFactory) {\n                    _this.contextMenuFactory.onContextMenu(mouseEvent, null, null, null, null, _this.eGridBody);\n                }\n            }\n        };\n        this.addManagedListener(this.eBodyViewport, 'contextmenu', listener);\n        this.addManagedListener(this.eBodyViewport, 'wheel', this.onWheel.bind(this));\n    };\n    GridBodyCtrl.prototype.onWheel = function (e) {\n        if (!this.gridOptionsWrapper.isSuppressScrollWhenPopupsAreOpen()) {\n            return;\n        }\n        if (this.popupService.hasAnchoredPopup()) {\n            e.preventDefault();\n        }\n    };\n    GridBodyCtrl.prototype.getGui = function () {\n        return this.eGridBody;\n    };\n    // called by rowDragFeature\n    GridBodyCtrl.prototype.scrollVertically = function (pixels) {\n        var oldScrollPosition = this.eBodyViewport.scrollTop;\n        this.bodyScrollFeature.setVerticalScrollPosition(oldScrollPosition + pixels);\n        return this.eBodyViewport.scrollTop - oldScrollPosition;\n    };\n    GridBodyCtrl.prototype.addRowDragListener = function () {\n        this.rowDragFeature = this.createManagedBean(new RowDragFeature(this.eBodyViewport));\n        this.dragAndDropService.addDropTarget(this.rowDragFeature);\n    };\n    GridBodyCtrl.prototype.getRowDragFeature = function () {\n        return this.rowDragFeature;\n    };\n    GridBodyCtrl.prototype.setFloatingHeights = function () {\n        var pinnedRowModel = this.pinnedRowModel;\n        var floatingTopHeight = pinnedRowModel.getPinnedTopTotalHeight();\n        if (floatingTopHeight) {\n            // adding 1px for cell bottom border\n            floatingTopHeight += 1;\n        }\n        var floatingBottomHeight = pinnedRowModel.getPinnedBottomTotalHeight();\n        if (floatingBottomHeight) {\n            // adding 1px for cell bottom border\n            floatingBottomHeight += 1;\n        }\n        this.comp.setTopHeight(floatingTopHeight);\n        this.comp.setBottomHeight(floatingBottomHeight);\n        this.comp.setTopDisplay(floatingTopHeight ? 'inherit' : 'none');\n        this.comp.setBottomDisplay(floatingBottomHeight ? 'inherit' : 'none');\n    };\n    // method will call itself if no available width. this covers if the grid\n    // isn't visible, but is just about to be visible.\n    GridBodyCtrl.prototype.sizeColumnsToFit = function (nextTimeout) {\n        var _this = this;\n        // IE is different to the other browsers, it already removes the scroll width\n        // while calling window.getComputedStyle() (which is called by getInnerWidth())\n        var removeScrollWidth = this.isVerticalScrollShowing() && !isBrowserIE();\n        var scrollWidthToRemove = removeScrollWidth ? this.gridOptionsWrapper.getScrollbarWidth() : 0;\n        var bodyViewportWidth = getInnerWidth(this.eBodyViewport);\n        var availableWidth = bodyViewportWidth - scrollWidthToRemove;\n        if (availableWidth > 0) {\n            this.columnModel.sizeColumnsToFit(availableWidth, \"sizeColumnsToFit\");\n            return;\n        }\n        if (nextTimeout === undefined) {\n            window.setTimeout(function () {\n                _this.sizeColumnsToFit(100);\n            }, 0);\n        }\n        else if (nextTimeout === 100) {\n            window.setTimeout(function () {\n                _this.sizeColumnsToFit(500);\n            }, 100);\n        }\n        else if (nextTimeout === 500) {\n            window.setTimeout(function () {\n                _this.sizeColumnsToFit(-1);\n            }, 500);\n        }\n        else {\n            console.warn('AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with ' +\n                'zero width, maybe the grid is not visible yet on the screen?');\n        }\n    };\n    // + rangeService\n    GridBodyCtrl.prototype.addScrollEventListener = function (listener) {\n        this.eBodyViewport.addEventListener('scroll', listener);\n    };\n    // + focusService\n    GridBodyCtrl.prototype.removeScrollEventListener = function (listener) {\n        this.eBodyViewport.removeEventListener('scroll', listener);\n    };\n    GridBodyCtrl.prototype.requestAngularApply = function () {\n        var _this = this;\n        if (this.angularApplyTriggered) {\n            return;\n        }\n        this.angularApplyTriggered = true;\n        window.setTimeout(function () {\n            _this.angularApplyTriggered = false;\n            _this.$scope.$apply();\n        }, 0);\n    };\n    GridBodyCtrl.prototype.addAngularApplyCheck = function () {\n        var _this = this;\n        // these are the events we need to do an apply after - these are the ones that can end up\n        // with columns added or removed\n        this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, function () { return _this.requestAngularApply(); });\n        this.addManagedListener(this.eventService, Events.EVENT_VIRTUAL_COLUMNS_CHANGED, function () { return _this.requestAngularApply(); });\n    };\n    __decorate([\n        Autowired('rowContainerHeightService')\n    ], GridBodyCtrl.prototype, \"rowContainerHeightService\", void 0);\n    __decorate([\n        Autowired('ctrlsService')\n    ], GridBodyCtrl.prototype, \"ctrlsService\", void 0);\n    __decorate([\n        Autowired('columnModel')\n    ], GridBodyCtrl.prototype, \"columnModel\", void 0);\n    __decorate([\n        Autowired('scrollVisibleService')\n    ], GridBodyCtrl.prototype, \"scrollVisibleService\", void 0);\n    __decorate([\n        Optional('contextMenuFactory')\n    ], GridBodyCtrl.prototype, \"contextMenuFactory\", void 0);\n    __decorate([\n        Autowired('headerNavigationService')\n    ], GridBodyCtrl.prototype, \"headerNavigationService\", void 0);\n    __decorate([\n        Autowired('paginationProxy')\n    ], GridBodyCtrl.prototype, \"paginationProxy\", void 0);\n    __decorate([\n        Autowired('dragAndDropService')\n    ], GridBodyCtrl.prototype, \"dragAndDropService\", void 0);\n    __decorate([\n        Autowired('pinnedRowModel')\n    ], GridBodyCtrl.prototype, \"pinnedRowModel\", void 0);\n    __decorate([\n        Autowired('rowRenderer')\n    ], GridBodyCtrl.prototype, \"rowRenderer\", void 0);\n    __decorate([\n        Autowired('popupService')\n    ], GridBodyCtrl.prototype, \"popupService\", void 0);\n    __decorate([\n        Autowired('mouseEventService')\n    ], GridBodyCtrl.prototype, \"mouseEventService\", void 0);\n    __decorate([\n        Autowired('$scope')\n    ], GridBodyCtrl.prototype, \"$scope\", void 0);\n    return GridBodyCtrl;\n}(BeanStub));\nexport { GridBodyCtrl };\n"]},"metadata":{},"sourceType":"module"}