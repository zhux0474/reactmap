{"version":3,"sources":["../../src/ts/gridBodyComp/rowDragFeature.ts"],"names":[],"mappings":"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","file":"rowDragFeature.js","sourcesContent":["import {\n    DragAndDropService,\n    DraggingEvent,\n    DragSourceType,\n    DropTarget,\n    VerticalDirection\n} from \"../dragAndDrop/dragAndDropService\";\nimport { Autowired, Optional, PostConstruct } from \"../context/context\";\nimport { ColumnModel } from \"../columns/columnModel\";\nimport { FocusService } from \"../focusService\";\nimport { IRangeService } from \"../interfaces/IRangeService\";\nimport { RowDragEndEvent, RowDragEnterEvent, RowDragEvent, RowDragLeaveEvent, RowDragMoveEvent } from \"../events\";\nimport { Events } from \"../eventKeys\";\nimport { IRowModel } from \"../interfaces/iRowModel\";\nimport { IClientSideRowModel } from \"../interfaces/iClientSideRowModel\";\nimport { RowHighlightPosition, RowNode } from \"../entities/rowNode\";\nimport { SelectionService } from \"../selectionService\";\nimport { MouseEventService } from \"./mouseEventService\";\nimport { last } from '../utils/array';\nimport { SortController } from \"../sortController\";\nimport { FilterManager } from \"../filter/filterManager\";\nimport { BeanStub } from \"../context/beanStub\";\nimport { missingOrEmpty } from \"../utils/generic\";\nimport { doOnce } from \"../utils/function\";\nimport { PaginationProxy } from \"../pagination/paginationProxy\";\nimport { CtrlsService } from \"../ctrlsService\";\nimport { AutoScrollService } from \"../autoScrollService\";\n\nexport interface RowDropZoneEvents {\n    /** Callback function that will be executed when the rowDrag enters the target. */\n    onDragEnter?: (params: RowDragEnterEvent) => void;\n    /** Callback function that will be executed when the rowDrag leaves the target */\n    onDragLeave?: (params: RowDragLeaveEvent) => void;\n    /** \n     * Callback function that will be executed when the rowDrag is dragged inside the target.\n     * Note: this gets called multiple times.\n     */\n    onDragging?: (params: RowDragMoveEvent) => void;\n    /** Callback function that will be executed when the rowDrag drops rows within the target. */\n    onDragStop?: (params: RowDragEndEvent) => void;\n}\n\nexport interface RowDropZoneParams extends RowDropZoneEvents {\n    /** A callback method that returns the DropZone HTMLElement. */\n    getContainer: () => HTMLElement;\n}\n\nexport class RowDragFeature extends BeanStub implements DropTarget {\n\n    @Autowired('dragAndDropService') private dragAndDropService: DragAndDropService;\n    // this feature is only created when row model is ClientSide, so we can type it as ClientSide\n    @Autowired('rowModel') private rowModel: IRowModel;\n    @Autowired('paginationProxy') private paginationProxy: PaginationProxy;\n    @Autowired('columnModel') private columnModel: ColumnModel;\n    @Autowired('focusService') private focusService: FocusService;\n    @Autowired('sortController') private sortController: SortController;\n    @Autowired('filterManager') private filterManager: FilterManager;\n    @Autowired('selectionService') private selectionService: SelectionService;\n    @Autowired('mouseEventService') private mouseEventService: MouseEventService;\n    @Autowired('ctrlsService') private ctrlsService: CtrlsService;\n    @Optional('rangeService') private rangeService: IRangeService;\n\n    private clientSideRowModel: IClientSideRowModel;\n    private eContainer: HTMLElement;\n    private isMultiRowDrag: boolean = false;\n    private isGridSorted: boolean = false;\n    private isGridFiltered: boolean = false;\n    private isRowGroupActive: boolean = false;\n    private lastDraggingEvent: DraggingEvent;\n    private autoScrollService: AutoScrollService;\n\n    constructor(eContainer: HTMLElement) {\n        super();\n        this.eContainer = eContainer;\n    }\n\n    @PostConstruct\n    private postConstruct(): void {\n        if (this.gridOptionsWrapper.isRowModelDefault()) {\n            this.clientSideRowModel = this.rowModel as IClientSideRowModel;\n        }\n\n        const refreshStatus = () => {\n            this.onSortChanged();\n            this.onFilterChanged();\n            this.onRowGroupChanged();\n        }\n\n        this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, this.onSortChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_FILTER_CHANGED, this.onFilterChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.onRowGroupChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_MODEL_UPDATED, () => {\n            refreshStatus();\n        });\n\n        refreshStatus();\n\n        this.ctrlsService.whenReady(() => {\n            const gridBodyCon = this.ctrlsService.getGridBodyCtrl();\n            this.autoScrollService = new AutoScrollService({\n                scrollContainer: gridBodyCon.getBodyViewportElement(),\n                scrollAxis: 'y',\n                getVerticalPosition: () => gridBodyCon.getScrollFeature().getVScrollPosition().top,\n                setVerticalPosition: (position) => gridBodyCon.getScrollFeature().setVerticalScrollPosition(position),\n                onScrollCallback: () => { this.onDragging(this.lastDraggingEvent); }\n            });\n        });\n    }\n\n    private onSortChanged(): void {\n        this.isGridSorted = this.sortController.isSortActive();\n    }\n\n    private onFilterChanged(): void {\n        this.isGridFiltered = this.filterManager.isAnyFilterPresent();\n    }\n\n    private onRowGroupChanged(): void {\n        const rowGroups = this.columnModel.getRowGroupColumns();\n        this.isRowGroupActive = !missingOrEmpty(rowGroups);\n    }\n\n    public getContainer(): HTMLElement {\n        return this.eContainer;\n    }\n\n    public isInterestedIn(type: DragSourceType): boolean {\n        return type === DragSourceType.RowDrag;\n    }\n\n    public getIconName(): string {\n        const managedDrag = this.gridOptionsWrapper.isRowDragManaged();\n\n        if (managedDrag && this.shouldPreventRowMove()) {\n            return DragAndDropService.ICON_NOT_ALLOWED;\n        }\n\n        return DragAndDropService.ICON_MOVE;\n    }\n\n    public shouldPreventRowMove(): boolean {\n        return this.isGridSorted || this.isGridFiltered || this.isRowGroupActive;\n    }\n\n    private getRowNodes(draggingEvent: DraggingEvent): RowNode[] {\n        if (!this.isFromThisGrid(draggingEvent)) {\n            return draggingEvent.dragItem.rowNodes || [];\n        }\n\n        const isRowDragMultiRow = this.gridOptionsWrapper.isRowDragMultiRow();\n        const selectedNodes = this.selectionService.getSelectedNodes();\n        const currentNode = draggingEvent.dragItem.rowNode!;\n\n        if (isRowDragMultiRow && selectedNodes.indexOf(currentNode) !== -1) {\n            this.isMultiRowDrag = true;\n            return [...selectedNodes];\n        }\n\n        this.isMultiRowDrag = false;\n\n        return [currentNode];\n    }\n\n    public onDragEnter(draggingEvent: DraggingEvent): void {\n        // when entering, we fire the enter event, then in onEnterOrDragging,\n        // we also fire the move event. so we get both events when entering.\n        this.dispatchGridEvent(Events.EVENT_ROW_DRAG_ENTER, draggingEvent);\n\n        this.getRowNodes(draggingEvent).forEach(rowNode => {\n            rowNode.setDragging(true);\n        });\n\n        this.onEnterOrDragging(draggingEvent);\n    }\n\n    public onDragging(draggingEvent: DraggingEvent): void {\n        this.onEnterOrDragging(draggingEvent);\n    }\n\n    private isFromThisGrid(draggingEvent: DraggingEvent) {\n        const { dragSourceDomDataKey } = draggingEvent.dragSource;\n\n        return dragSourceDomDataKey === this.gridOptionsWrapper.getDomDataKey();\n    }\n\n    private isDropZoneWithinThisGrid(draggingEvent: DraggingEvent): boolean {\n        const gridBodyCon = this.ctrlsService.getGridBodyCtrl();\n        const gridGui = gridBodyCon.getGui();\n        const { dropZoneTarget } = draggingEvent;\n\n        return !gridGui.contains(dropZoneTarget);\n    }\n\n    private onEnterOrDragging(draggingEvent: DraggingEvent): void {\n        // this event is fired for enter and move\n        this.dispatchGridEvent(Events.EVENT_ROW_DRAG_MOVE, draggingEvent);\n\n        this.lastDraggingEvent = draggingEvent;\n\n        const pixel = this.mouseEventService.getNormalisedPosition(draggingEvent).y;\n        const managedDrag = this.gridOptionsWrapper.isRowDragManaged();\n\n        if (managedDrag) {\n            this.doManagedDrag(draggingEvent, pixel);\n        }\n\n        this.autoScrollService.check(draggingEvent.event);\n    }\n\n    private doManagedDrag(draggingEvent: DraggingEvent, pixel: number): void {\n        let rowNodes: RowNode[];\n        const isFromThisGrid = this.isFromThisGrid(draggingEvent);\n\n        if (isFromThisGrid) {\n            rowNodes = [draggingEvent.dragItem.rowNode!];\n\n            if (this.isMultiRowDrag) {\n                rowNodes = [...this.selectionService.getSelectedNodes()].sort(\n                    (a, b) => this.getRowIndexNumber(a) - this.getRowIndexNumber(b)\n                );\n            }\n\n            draggingEvent.dragItem.rowNodes = rowNodes;\n        } else {\n            rowNodes = draggingEvent.dragItem.rowNodes!;\n        }\n\n        const managedDrag = this.gridOptionsWrapper.isRowDragManaged();\n\n        if (managedDrag && this.shouldPreventRowMove()) {\n            return;\n        }\n\n        if (this.gridOptionsWrapper.isSuppressMoveWhenRowDragging() || !isFromThisGrid) {\n            if (!this.isDropZoneWithinThisGrid(draggingEvent)) {\n                this.clientSideRowModel.highlightRowAtPixel(rowNodes[0], pixel);\n            }\n        } else {\n            this.moveRows(rowNodes, pixel);\n        }\n    }\n\n    private getRowIndexNumber(rowNode: RowNode): number {\n        return parseInt(last(rowNode.getRowIndexString().split('-')), 10);\n    }\n\n    private moveRowAndClearHighlight(draggingEvent: DraggingEvent): void {\n        const lastHighlightedRowNode = this.clientSideRowModel.getLastHighlightedRowNode();\n        const isBelow = lastHighlightedRowNode && lastHighlightedRowNode.highlighted === RowHighlightPosition.Below;\n        const pixel = this.mouseEventService.getNormalisedPosition(draggingEvent).y;\n        const rowNodes = draggingEvent.dragItem.rowNodes;\n\n        let increment = isBelow ? 1 : 0;\n\n        if (this.isFromThisGrid(draggingEvent)) {\n            rowNodes!.forEach(rowNode => {\n                if (rowNode.rowTop! < pixel) {\n                    increment -= 1;\n                }\n            });\n            this.moveRows(rowNodes!, pixel, increment);\n        } else {\n            const getRowNodeId = this.gridOptionsWrapper.getRowNodeIdFunc();\n\n            let addIndex = this.clientSideRowModel.getRowIndexAtPixel(pixel) + 1;\n\n            if (this.clientSideRowModel.getHighlightPosition(pixel) === RowHighlightPosition.Above) {\n                addIndex--;\n            }\n\n            this.clientSideRowModel.updateRowData({\n                add: rowNodes!\n                    .map(node => node.data)\n                    .filter(data => !this.clientSideRowModel.getRowNode(\n                        getRowNodeId ? getRowNodeId(data) : data.id)\n                    ),\n                addIndex\n            });\n        }\n\n        this.clearRowHighlight();\n    }\n\n    private clearRowHighlight(): void {\n        this.clientSideRowModel.highlightRowAtPixel(null);\n    }\n\n    private moveRows(rowNodes: RowNode[], pixel: number, increment: number = 0): void {\n        const rowWasMoved = this.clientSideRowModel.ensureRowsAtPixel(rowNodes, pixel, increment);\n\n        if (rowWasMoved) {\n            this.focusService.clearFocusedCell();\n            if (this.rangeService) {\n                this.rangeService.removeAllCellRanges();\n            }\n        }\n    }\n\n    public addRowDropZone(params: RowDropZoneParams): void {\n        if (!params.getContainer()) {\n            doOnce(() => console.warn('AG Grid: addRowDropZone - A container target needs to be provided'), 'add-drop-zone-empty-target');\n            return;\n        }\n\n        if (this.dragAndDropService.findExternalZone(params)) {\n            console.warn('AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.');\n            return;\n        }\n\n        let processedParams: RowDropZoneParams = {\n            getContainer: params.getContainer\n        };\n\n        if ((params as any).fromGrid) {\n            (params as any).fromGrid = undefined;\n            processedParams = params;\n        } else {\n            if (params.onDragEnter) {\n                processedParams.onDragEnter = (e) => {\n                    params.onDragEnter!(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_ENTER, e as any));\n                };\n            }\n            if (params.onDragLeave) {\n                processedParams.onDragLeave = (e) => {\n                    params.onDragLeave!(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_LEAVE, e as any));\n                };\n            }\n            if (params.onDragging) {\n                processedParams.onDragging = (e) => {\n                    params.onDragging!(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_MOVE, e as any));\n                };\n            }\n            if (params.onDragStop) {\n                processedParams.onDragStop = (e) => {\n                    params.onDragStop!(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_END, e as any));\n                };\n            }\n        }\n\n        this.dragAndDropService.addDropTarget({\n            isInterestedIn: (type: DragSourceType) => type === DragSourceType.RowDrag,\n            getIconName: () => DragAndDropService.ICON_MOVE,\n            external: true,\n            ...processedParams as any\n        });\n    }\n\n    public getRowDropZone(events: RowDropZoneEvents): RowDropZoneParams {\n        const getContainer = this.getContainer.bind(this);\n        const onDragEnter = this.onDragEnter.bind(this);\n        const onDragLeave = this.onDragLeave.bind(this);\n        const onDragging = this.onDragging.bind(this);\n        const onDragStop = this.onDragStop.bind(this);\n\n        if (!events) {\n            return { getContainer, onDragEnter, onDragLeave, onDragging, onDragStop, /* @private */ fromGrid: true } as RowDropZoneParams;\n        }\n\n        return {\n            getContainer,\n            onDragEnter: events.onDragEnter\n                ? ((e) => {\n                    onDragEnter(e);\n                    events.onDragEnter!(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_ENTER, e as any));\n                })\n                : onDragEnter,\n            onDragLeave: events.onDragLeave\n                ? ((e) => {\n                    onDragLeave(e);\n                    events.onDragLeave!(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_LEAVE, e as any));\n                })\n                : onDragLeave,\n            onDragging: events.onDragging\n                ? ((e) => {\n                    onDragging(e);\n                    events.onDragging!(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_MOVE, e as any));\n                })\n                : onDragging,\n            onDragStop: events.onDragStop\n                ? ((e) => {\n                    onDragStop(e);\n                    events.onDragStop!(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_END, e as any));\n                })\n                : onDragStop,\n            fromGrid: true /* @private */\n        } as RowDropZoneParams;\n    }\n\n    private draggingToRowDragEvent(type: string, draggingEvent: DraggingEvent): RowDragEvent {\n        const yNormalised = this.mouseEventService.getNormalisedPosition(draggingEvent).y;\n        const mouseIsPastLastRow = yNormalised > this.paginationProxy.getCurrentPageHeight();\n\n        let overIndex = -1;\n        let overNode: RowNode | undefined;\n\n        if (!mouseIsPastLastRow) {\n            overIndex = this.rowModel.getRowIndexAtPixel(yNormalised);\n            overNode = this.rowModel.getRow(overIndex);\n        }\n\n        let vDirectionString: string | null;\n\n        switch (draggingEvent.vDirection) {\n            case VerticalDirection.Down:\n                vDirectionString = 'down';\n                break;\n            case VerticalDirection.Up:\n                vDirectionString = 'up';\n                break;\n            default:\n                vDirectionString = null;\n                break;\n        }\n\n        const event: RowDragEvent = {\n            type: type,\n            api: this.gridOptionsWrapper.getApi()!,\n            columnApi: this.gridOptionsWrapper.getColumnApi()!,\n            event: draggingEvent.event,\n            node: draggingEvent.dragItem.rowNode!,\n            nodes: draggingEvent.dragItem.rowNodes!,\n            overIndex: overIndex,\n            overNode: overNode,\n            y: yNormalised,\n            vDirection: vDirectionString!\n        };\n\n        return event;\n    }\n\n    private dispatchGridEvent(type: string, draggingEvent: DraggingEvent): void {\n        const event = this.draggingToRowDragEvent(type, draggingEvent);\n\n        this.eventService.dispatchEvent(event);\n    }\n\n    public onDragLeave(draggingEvent: DraggingEvent): void {\n        this.dispatchGridEvent(Events.EVENT_ROW_DRAG_LEAVE, draggingEvent);\n        this.stopDragging(draggingEvent);\n\n        if (this.gridOptionsWrapper.isRowDragManaged()) {\n            this.clearRowHighlight();\n        }\n\n        if (this.isFromThisGrid(draggingEvent)) {\n            this.isMultiRowDrag = false;\n        }\n    }\n\n    public onDragStop(draggingEvent: DraggingEvent): void {\n        this.dispatchGridEvent(Events.EVENT_ROW_DRAG_END, draggingEvent);\n        this.stopDragging(draggingEvent);\n\n        if (\n            this.gridOptionsWrapper.isRowDragManaged() &&\n            (this.gridOptionsWrapper.isSuppressMoveWhenRowDragging() || !this.isFromThisGrid(draggingEvent)) &&\n            !this.isDropZoneWithinThisGrid(draggingEvent)\n        ) {\n            this.moveRowAndClearHighlight(draggingEvent);\n        }\n    }\n\n    private stopDragging(draggingEvent: DraggingEvent): void {\n        this.autoScrollService.ensureCleared();\n\n        this.getRowNodes(draggingEvent).forEach(rowNode => {\n            rowNode.setDragging(false);\n        });\n    }\n}\n"]}