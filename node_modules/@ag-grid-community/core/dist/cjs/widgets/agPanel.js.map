{"version":3,"sources":["../../src/ts/widgets/agPanel.ts"],"names":[],"mappings":"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","file":"agPanel.js","sourcesContent":["import { RefSelector } from \"./componentAnnotations\";\nimport { PostConstruct } from \"../context/context\";\nimport { Component } from \"./component\";\nimport { addCssClass, getInnerHeight, getInnerWidth } from \"../utils/dom\";\nimport { createIconNoSpan } from \"../utils/icon\";\nimport { PositionableFeature, PositionableOptions, ResizableStructure } from \"../rendering/features/positionableFeature\";\n\nexport interface PanelOptions extends PositionableOptions {\n    component?: Component;\n    hideTitleBar?: boolean | null;\n    closable?: boolean | null;\n    resizable?: boolean | ResizableStructure;\n    title?: string | null;\n    cssIdentifier?: string | null;\n}\n\nexport class AgPanel extends Component {\n\n    protected static CLOSE_BTN_TEMPLATE = /* html */ `<div class=\"ag-button\"></div>`;\n    protected closable = true;\n    protected config: PanelOptions | undefined;\n\n    protected closeButtonComp: Component | undefined;\n    protected positionableFeature: PositionableFeature;\n    public close: () => void;\n\n    @RefSelector('eContentWrapper') protected readonly eContentWrapper: HTMLElement;\n    @RefSelector('eTitleBar') protected readonly eTitleBar: HTMLElement;\n    @RefSelector('eTitleBarButtons') protected readonly eTitleBarButtons: HTMLElement;\n    @RefSelector('eTitle') protected readonly eTitle: HTMLElement;\n\n    constructor(config?: PanelOptions) {\n        super(AgPanel.getTemplate(config));\n        this.config = config;\n    }\n\n    private static getTemplate(config?: PanelOptions) {\n        const cssIdentifier = (config && config.cssIdentifier) || 'default';\n        return /* html */ `<div class=\"ag-panel ag-${cssIdentifier}-panel\" tabindex=\"-1\">\n            <div ref=\"eTitleBar\" class=\"ag-panel-title-bar ag-${cssIdentifier}-panel-title-bar ag-unselectable\">\n                <span ref=\"eTitle\" class=\"ag-panel-title-bar-title ag-${cssIdentifier}-panel-title-bar-title\"></span>\n                <div ref=\"eTitleBarButtons\" class=\"ag-panel-title-bar-buttons ag-${cssIdentifier}-panel-title-bar-buttons\"></div>\n            </div>\n            <div ref=\"eContentWrapper\" class=\"ag-panel-content-wrapper ag-${cssIdentifier}-panel-content-wrapper\"></div>\n        </div>`;\n    }\n\n    @PostConstruct\n    protected postConstruct() {\n        const {\n            component,\n            closable,\n            hideTitleBar,\n            title,\n            minWidth = 250,\n            width,\n            minHeight = 250,\n            height,\n            centered,\n            popup,\n            x,\n            y\n        } = this.config as PanelOptions;\n\n        this.positionableFeature = new PositionableFeature(this.getGui(), {\n            minWidth, width, minHeight, height, centered, x, y, popup,\n            calculateTopBuffer: () => this.positionableFeature.getHeight()! - this.getBodyHeight()\n        });\n\n        this.createManagedBean(this.positionableFeature);\n\n        const eGui = this.getGui();\n\n        if (component) { this.setBodyComponent(component); }\n\n        if (!hideTitleBar) {\n            if (title) { this.setTitle(title); }\n            this.setClosable(closable != null ? closable : this.closable);\n        } else {\n            addCssClass(this.eTitleBar, 'ag-hidden');\n        }\n\n        this.addManagedListener(this.eTitleBar, 'mousedown', (e: MouseEvent) => {\n            if (\n                eGui.contains(e.relatedTarget as HTMLElement) ||\n                eGui.contains(document.activeElement) ||\n                this.eTitleBarButtons.contains(e.target as HTMLElement)\n            ) {\n                e.preventDefault();\n                return;\n            }\n\n            const focusEl = this.eContentWrapper.querySelector('button, [href], input, select, textarea, [tabindex]');\n\n            if (focusEl) {\n                (focusEl as HTMLElement).focus();\n            }\n        });\n\n        if (popup && this.positionableFeature.isPositioned()) { return; }\n\n        if (this.renderComponent) {\n            this.renderComponent();\n        }\n\n        this.positionableFeature.initialisePosition();\n        this.eContentWrapper.style.height = '0';\n    }\n\n    protected renderComponent() {\n        const eGui = this.getGui();\n        eGui.focus();\n\n        this.close = () => {\n            eGui.parentElement!.removeChild(eGui);\n            this.destroy();\n        };\n    }\n\n    public getHeight(): number | undefined {\n        return this.positionableFeature.getHeight();\n    }\n\n    public setHeight(height: number | string): void {\n        this.positionableFeature.setHeight(height);\n    }\n\n    public getWidth(): number | undefined {\n        return this.positionableFeature.getWidth();\n    }\n\n    public setWidth(width: number | string): void {\n        this.positionableFeature.setWidth(width);\n    }\n\n    public setClosable(closable: boolean) {\n        if (closable !== this.closable) {\n            this.closable = closable;\n        }\n\n        if (closable) {\n            const closeButtonComp = this.closeButtonComp = new Component(AgPanel.CLOSE_BTN_TEMPLATE);\n            this.getContext().createBean(closeButtonComp);\n\n            const eGui = closeButtonComp.getGui();\n            eGui.appendChild(addCssClass(\n                createIconNoSpan('close', this.gridOptionsWrapper)!,\n                'ag-panel-title-bar-button-icon')!\n            );\n\n            this.addTitleBarButton(closeButtonComp);\n            closeButtonComp.addManagedListener(eGui, 'click', this.onBtClose.bind(this));\n        } else if (this.closeButtonComp) {\n            const eGui = this.closeButtonComp.getGui();\n            eGui.parentElement!.removeChild(eGui);\n\n            this.closeButtonComp = this.destroyBean(this.closeButtonComp);\n        }\n    }\n\n    public setBodyComponent(bodyComponent: Component) {\n        bodyComponent.setParentComponent(this);\n        this.eContentWrapper.appendChild(bodyComponent.getGui());\n    }\n\n    public addTitleBarButton(button: Component, position?: number) {\n        const eTitleBarButtons = this.eTitleBarButtons;\n        const buttons = eTitleBarButtons.children;\n        const len = buttons.length;\n\n        if (position == null) {\n            position = len;\n        }\n\n        position = Math.max(0, Math.min(position, len));\n\n        const eGui = button.getGui();\n\n        addCssClass(eGui, 'ag-panel-title-bar-button');\n\n        if (position === 0) {\n            eTitleBarButtons.insertAdjacentElement('afterbegin', eGui);\n        } else if (position === len) {\n            eTitleBarButtons.insertAdjacentElement('beforeend', eGui);\n        } else {\n            buttons[position - 1].insertAdjacentElement('afterend', eGui);\n        }\n\n        button.setParentComponent(this);\n    }\n\n    public getBodyHeight(): number {\n        return getInnerHeight(this.eContentWrapper);\n    }\n\n    public getBodyWidth(): number {\n        return getInnerWidth(this.eContentWrapper);\n    }\n\n    public setTitle(title: string) {\n        this.eTitle.innerText = title;\n    }\n\n    // called when user hits the 'x' in the top right\n    private onBtClose() {\n        this.close();\n    }\n\n    protected destroy(): void {\n        if (this.closeButtonComp) {\n            this.closeButtonComp = this.destroyBean(this.closeButtonComp);\n        }\n\n        const eGui = this.getGui();\n\n        if (eGui && eGui.offsetParent) {\n            this.close();\n        }\n\n        super.destroy();\n    }\n}\n"]}