{"version":3,"sources":["../../src/ts/rendering/features/positionableFeature.ts"],"names":[],"mappings":"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","file":"positionableFeature.js","sourcesContent":["import { BeanStub } from \"../../context/beanStub\";\nimport { Autowired } from \"../../context/context\";\nimport { DragListenerParams, DragService } from \"../../dragAndDrop/dragService\";\nimport { addCssClass, containsClass, getAbsoluteHeight, getAbsoluteWidth, removeCssClass, setFixedHeight, setFixedWidth } from \"../../utils/dom\";\nimport { assign } from \"../../utils/object\";\nimport { PopupService } from \"../../widgets/popupService\";\n\nconst RESIZE_CONTAINER_STYLE = 'ag-resizer-wrapper';\n\nconst RESIZE_TEMPLATE = /* html */\n    `<div class=\"${RESIZE_CONTAINER_STYLE}\">\n        <div ref=\"eTopLeftResizer\" class=\"ag-resizer ag-resizer-topLeft\"></div>\n        <div ref=\"eTopResizer\" class=\"ag-resizer ag-resizer-top\"></div>\n        <div ref=\"eTopRightResizer\" class=\"ag-resizer ag-resizer-topRight\"></div>\n        <div ref=\"eRightResizer\" class=\"ag-resizer ag-resizer-right\"></div>\n        <div ref=\"eBottomRightResizer\" class=\"ag-resizer ag-resizer-bottomRight\"></div>\n        <div ref=\"eBottomResizer\" class=\"ag-resizer ag-resizer-bottom\"></div>\n        <div ref=\"eBottomLeftResizer\" class=\"ag-resizer ag-resizer-bottomLeft\"></div>\n        <div ref=\"eLeftResizer\" class=\"ag-resizer ag-resizer-left\"></div>\n    </div>`;\n\nexport interface PositionableOptions {\n    popup?: boolean;\n    minWidth?: number | null;\n    width?: number | string | null;\n    minHeight?: number | null;\n    height?: number | string | null;\n    centered?: boolean | null;\n    calculateTopBuffer?: () => number;\n    /**\n     * Used for when a popup needs to be resized by an element within itself\n     * In that case, the feature will configured as `popup=false` but the offsetParent\n     * needs to be the popupParent.\n     */\n    forcePopupParentAsOffsetParent?: boolean;\n    x?: number | null;\n    y?: number | null;\n}\n\nexport type ResizableSides = 'topLeft' |\n    'top' |\n    'topRight' |\n    'right' |\n    'bottomRight' |\n    'bottom' |\n    'bottomLeft' |\n    'left';\n\nexport type ResizableStructure = {\n    [key in ResizableSides]?: boolean;\n};\n\ninterface MappedResizer {\n    element: HTMLElement;\n    dragSource?: DragListenerParams;\n}\n\nexport class PositionableFeature extends BeanStub {\n\n    private dragStartPosition = {\n        x: 0,\n        y: 0\n    };\n\n    private position = {\n        x: 0,\n        y: 0\n    };\n\n    private lastSize = {\n        width: -1,\n        height: -1\n    };\n\n    private resizerMap: {\n        [key in ResizableSides]: MappedResizer\n    } | undefined;\n\n    private minWidth: number;\n    private minHeight?: number;\n    private positioned = false;\n    private resizersAdded = false;\n    private config: PositionableOptions;\n\n    private resizeListeners: DragListenerParams[] = [];\n    private moveElementDragListener: DragListenerParams | undefined;\n\n    private offsetParent: HTMLElement;\n    private boundaryEl: HTMLElement | null = null;\n\n    private isResizing: boolean = false;\n    private isMoving = false;\n    private resizable: ResizableStructure = {};\n    private movable = false;\n    private currentResizer: { isTop: boolean, isRight: boolean, isBottom: boolean, isLeft: boolean } | null = null;\n\n    @Autowired('popupService') protected readonly popupService: PopupService;\n    @Autowired('dragService') private readonly dragService: DragService;\n\n    constructor(\n        private readonly element: HTMLElement,\n        config?: PositionableOptions\n    ) {\n        super();\n        this.config = assign({}, { popup: false }, config);\n    }\n\n    public center() {\n        const { clientHeight, clientWidth } = this.offsetParent;\n\n        const x = (clientWidth / 2) - (this.getWidth()! / 2);\n        const y = (clientHeight / 2) - (this.getHeight()! / 2);\n\n        this.offsetElement(x, y);\n    }\n\n    public initialisePosition(): void {\n        const { centered, forcePopupParentAsOffsetParent, minWidth, width, minHeight, height, x, y } = this.config;\n\n        if (!this.offsetParent) { this.setOffsetParent(); }\n\n        let computedMinHeight = 0;\n        let computedMinWidth = 0;\n\n        // here we don't use the main offset parent but the element's offsetParent\n        // in order to calculated the minWidth and minHeight correctly\n        const isVisible = !!this.element.offsetParent;\n        if (isVisible) {\n            const boundaryEl = this.findBoundaryElement();\n            const offsetParentComputedStyles = window.getComputedStyle(boundaryEl);\n            if (offsetParentComputedStyles.minWidth != null) {\n                const paddingWidth = boundaryEl.offsetWidth - this.element.offsetWidth;\n                computedMinWidth = parseInt(offsetParentComputedStyles.minWidth, 10) - paddingWidth;\n            }\n\n            if (offsetParentComputedStyles.minHeight != null) {\n                const paddingHeight = boundaryEl.offsetHeight - this.element.offsetHeight;\n                computedMinHeight = parseInt(offsetParentComputedStyles.minHeight, 10) - paddingHeight;\n            }\n        }\n\n        this.minHeight = minHeight || computedMinHeight;\n        this.minWidth = minWidth || computedMinWidth;\n\n        if (width) {\n            this.setWidth(width);\n        }\n\n        if (height) {\n            this.setHeight(height);\n        }\n\n        if (!width || !height) {\n            this.refreshSize();\n        }\n\n        if (centered) {\n            this.center();\n        } else if (x || y) {\n            this.offsetElement(x!, y!);\n        } else if (isVisible && forcePopupParentAsOffsetParent && this.boundaryEl) {\n            const top = parseFloat(this.boundaryEl.style.top!);\n            const left = parseFloat(this.boundaryEl.style.left!);\n\n            this.offsetElement(\n                isNaN(left) ? 0 : left,\n                isNaN(top) ? 0 : top\n            );\n        }\n\n        this.positioned = !!this.offsetParent;\n    }\n\n    public isPositioned(): boolean {\n        return this.positioned;\n    }\n\n    public getPosition(): { x: number; y: number } {\n        return this.position;\n    }\n\n    public setMovable(movable: boolean, moveElement: HTMLElement) {\n        if (!this.config.popup || movable === this.movable) { return; }\n\n        this.movable = movable;\n\n        const params: DragListenerParams = this.moveElementDragListener || {\n            eElement: moveElement,\n            onDragStart: this.onMoveStart.bind(this),\n            onDragging: this.onMove.bind(this),\n            onDragStop: this.onMoveEnd.bind(this)\n        };\n\n        if (movable) {\n            this.dragService.addDragSource(params);\n            this.moveElementDragListener = params;\n        } else {\n            this.dragService.removeDragSource(params);\n            this.moveElementDragListener = undefined;\n        }\n    }\n\n    public setResizable(resizable: boolean | ResizableStructure) {\n        this.clearResizeListeners();\n\n        if (resizable) {\n            this.addResizers();\n        } else {\n            this.removeResizers();\n        }\n\n        if (typeof resizable === 'boolean') {\n            if (resizable === false) { return; }\n\n            resizable = {\n                topLeft: resizable,\n                top: resizable,\n                topRight: resizable,\n                right: resizable,\n                bottomRight: resizable,\n                bottom: resizable,\n                bottomLeft: resizable,\n                left: resizable\n            } as ResizableStructure;\n        }\n\n        Object.keys(resizable).forEach((side: ResizableSides) => {\n            const resizableStructure = resizable as ResizableStructure;\n            const val = !!resizableStructure[side];\n            const resizerEl = this.getResizerElement(side);\n\n            const params: DragListenerParams = {\n                dragStartPixels: 0,\n                eElement: resizerEl!,\n                onDragStart: (e: MouseEvent) => this.onResizeStart(e, side),\n                onDragging: this.onResize.bind(this),\n                onDragStop: (e: MouseEvent) => this.onResizeEnd(e, side),\n            };\n\n            if (!!this.resizable[side] !== val || (!this.isAlive() && !val)) {\n                if (val) {\n                    this.dragService.addDragSource(params);\n                    this.resizeListeners.push(params);\n                    resizerEl!.style.pointerEvents = 'all';\n                } else {\n                    resizerEl!.style.pointerEvents = 'none';\n                }\n            }\n        });\n    }\n\n    public removeSizeFromEl(): void {\n        this.element.style.removeProperty('height');\n        this.element.style.removeProperty('width');\n        this.element.style.removeProperty('flex');\n    }\n\n    public restoreLastSize(): void {\n        this.element.style.flex = '0 0 auto';\n\n        const { height, width } = this.lastSize;\n\n        if (width !== -1) {\n            this.element.style.width = `${width}px`;\n        }\n\n        if (height !== -1) {\n            this.element.style.height = `${height}px`;\n        }\n    }\n\n    public getHeight(): number | undefined {\n        return this.element.offsetHeight;\n    }\n\n    public setHeight(height: number | string) {\n        const { popup } = this.config;\n        const eGui = this.element;\n\n        let isPercent = false;\n\n        if (typeof height === 'string' && height.indexOf('%') !== -1) {\n            setFixedHeight(eGui, height);\n            height = getAbsoluteHeight(eGui);\n            isPercent = true;\n        } else if (this.positioned) {\n            const elRect = this.element.getBoundingClientRect();\n            const parentRect = this.offsetParent.getBoundingClientRect();\n\n            height = Math.max(this.minHeight!, height as number);\n            const { clientHeight } = this.offsetParent;\n            const yPosition = popup ? this.position.y : elRect.top;\n            const parentTop = popup ? 0 : parentRect.top;\n\n            if (clientHeight && (height + yPosition > clientHeight + parentTop)) {\n                height = clientHeight - yPosition;\n            }\n        }\n\n        if (this.getHeight() === height) { return; }\n\n        if (!isPercent) {\n            if (popup) {\n                setFixedHeight(eGui, height);\n            } else {\n                eGui.style.height = `${height}px`;\n                eGui.style.flex = '0 0 auto';\n                this.lastSize.height = typeof height === 'number' ? height : parseFloat(height);\n            }\n        } else {\n            eGui.style.maxHeight = 'unset';\n            eGui.style.minHeight = 'unset';\n        }\n    }\n\n    public getWidth(): number | undefined {\n        return this.element.offsetWidth;\n    }\n\n    public setWidth(width: number | string) {\n        const eGui = this.element;\n        const { popup } = this.config;\n\n        let isPercent = false;\n\n        if (typeof width === 'string' && width.indexOf('%') !== -1) {\n            setFixedWidth(eGui, width);\n            width = getAbsoluteWidth(eGui);\n            isPercent = true;\n        } else if (this.positioned) {\n            width = Math.max(this.minWidth, width as number);\n            const { clientWidth } = this.offsetParent;\n            const xPosition = popup ? this.position.x : this.element.getBoundingClientRect().left;\n\n            if (clientWidth && (width + xPosition > clientWidth)) {\n                width = clientWidth - xPosition;\n            }\n        }\n\n        if (this.getWidth() === width) { return; }\n\n        if (!isPercent) {\n            if (this.config.popup) {\n                setFixedWidth(eGui, width);\n            } else {\n                eGui.style.width = `${width}px`;\n                eGui.style.flex = ' unset';\n                this.lastSize.width = typeof width === 'number' ? width : parseFloat(width);\n            }\n        } else {\n            eGui.style.maxWidth = 'unset';\n            eGui.style.minWidth = 'unset';\n        }\n    }\n\n    public offsetElement(x = 0, y = 0) {\n        const ePopup = this.config.forcePopupParentAsOffsetParent ? this.boundaryEl! : this.element;\n\n        this.popupService.positionPopup({\n            ePopup,\n            x,\n            y,\n            keepWithinBounds: true\n        });\n\n        this.setPosition(\n            parseFloat(ePopup.style.left!),\n            parseFloat(ePopup.style.top!)\n        );\n    }\n\n    private setPosition(x: number, y: number): void {\n        this.position.x = x;\n        this.position.y = y;\n    }\n\n    private updateDragStartPosition(x: number, y: number) {\n        this.dragStartPosition = { x, y };\n    }\n\n    private calculateMouseMovement(params: {\n        e: MouseEvent,\n        topBuffer?: number,\n        anywhereWithin?: boolean,\n        isLeft?: boolean,\n        isTop?: boolean;\n    }): { movementX: number, movementY: number; } {\n        const { e, isLeft, isTop, anywhereWithin, topBuffer } = params;\n\n        const xDiff = e.clientX - this.dragStartPosition.x;\n        const yDiff = e.clientY - this.dragStartPosition.y;\n\n        const movementX = this.shouldSkipX(e, !!isLeft, !!anywhereWithin, xDiff) ? 0 : xDiff;\n        const movementY = this.shouldSkipY(e, !!isTop, topBuffer, yDiff) ? 0 : yDiff;\n\n        return { movementX, movementY };\n    }\n\n    private shouldSkipX(e: MouseEvent, isLeft: boolean, anywhereWithin: boolean, diff: number): boolean {\n        const elRect = this.element.getBoundingClientRect();\n        const parentRect = this.offsetParent.getBoundingClientRect();\n        const boundaryElRect = this.boundaryEl!.getBoundingClientRect();\n        const xPosition = this.config.popup ? this.position.x : elRect.left;\n        // skip if cursor is outside of popupParent horizontally\n        let skipX = (\n            (xPosition <= 0 && parentRect.left >= e.clientX) ||\n            (parentRect.right <= e.clientX && parentRect.right <= boundaryElRect.right)\n        );\n\n        if (skipX) { return true; }\n\n        if (isLeft) {\n            skipX = (\n                // skip if we are moving to the left and the cursor\n                // is positioned to the right of the left side anchor\n                (diff < 0 && e.clientX > xPosition + parentRect.left) ||\n                // skip if we are moving to the right and the cursor\n                // is positioned to the left of the dialog\n                (diff > 0 && e.clientX < xPosition + parentRect.left)\n            );\n        } else {\n            if (anywhereWithin) {\n                // if anywhereWithin is true, we allow to move\n                // as long as the cursor is within the dialog\n                skipX = (\n                    (diff < 0 && e.clientX > boundaryElRect.right) ||\n                    (diff > 0 && e.clientX < xPosition + parentRect.left)\n                );\n            } else {\n                skipX = (\n                    // if the movement is bound to the right side of the dialog\n                    // we skip if we are moving to the left and the cursor\n                    // is to the right of the dialog\n                    (diff < 0 && e.clientX > boundaryElRect.right) ||\n                    // or skip if we are moving to the right and the cursor\n                    // is to the left of the right side anchor\n                    (diff > 0 && e.clientX < boundaryElRect.right)\n                );\n            }\n        }\n\n        return skipX;\n    }\n\n    private shouldSkipY(e: MouseEvent, isTop: boolean, topBuffer: number = 0, diff: number): boolean {\n        const elRect = this.element.getBoundingClientRect();\n        const parentRect = this.offsetParent.getBoundingClientRect();\n        const boundaryElRect = this.boundaryEl!.getBoundingClientRect();\n        const yPosition = this.config.popup ? this.position.y : elRect.top;\n\n        // skip if cursor is outside of popupParent vertically\n        let skipY = (\n            (yPosition <= 0 && parentRect.top >= e.clientY) ||\n            (parentRect.bottom <= e.clientY && parentRect.bottom <= boundaryElRect.bottom)\n        );\n\n        if (skipY) { return true; }\n\n        if (isTop) {\n            skipY = (\n                // skip if we are moving to towards top and the cursor is\n                // below the top anchor + topBuffer\n                // note: topBuffer is used when moving the dialog using the title bar\n                (diff < 0 && e.clientY > yPosition + parentRect.top + topBuffer) ||\n                // skip if we are moving to the bottom and the cursor is\n                // above the top anchor\n                (diff > 0 && e.clientY < yPosition + parentRect.top)\n            );\n        } else {\n            skipY = (\n                // skip if we are moving towards the top and the cursor\n                // is below the bottom anchor\n                (diff < 0 && e.clientY > boundaryElRect.bottom) ||\n                // skip if we are moving towards the bottom and the cursor\n                // is above the bottom anchor\n                (diff > 0 && e.clientY < boundaryElRect.bottom)\n            );\n        }\n\n        return skipY;\n    }\n\n    private createResizeMap() {\n        const eGui = this.element;\n\n        this.resizerMap = {\n            topLeft: { element: eGui.querySelector('[ref=eTopLeftResizer]') as HTMLElement },\n            top: { element: eGui.querySelector('[ref=eTopResizer]') as HTMLElement },\n            topRight: { element: eGui.querySelector('[ref=eTopRightResizer]') as HTMLElement },\n            right: { element: eGui.querySelector('[ref=eRightResizer]') as HTMLElement },\n            bottomRight: { element: eGui.querySelector('[ref=eBottomRightResizer]') as HTMLElement },\n            bottom: { element: eGui.querySelector('[ref=eBottomResizer]') as HTMLElement },\n            bottomLeft: { element: eGui.querySelector('[ref=eBottomLeftResizer]') as HTMLElement },\n            left: { element: eGui.querySelector('[ref=eLeftResizer]') as HTMLElement }\n        };\n    }\n\n    private addResizers() {\n        if (this.resizersAdded) { return; }\n\n        const eGui = this.element;\n\n        if (!eGui) { return; }\n\n        const parser = new DOMParser();\n        const resizers = parser.parseFromString(RESIZE_TEMPLATE, 'text/html').body;\n\n        eGui.appendChild(resizers.firstChild!);\n        this.createResizeMap();\n        this.resizersAdded = true;\n    }\n\n    private removeResizers() {\n        this.resizerMap = undefined;\n        const resizerEl = this.element.querySelector(`.${RESIZE_CONTAINER_STYLE}`);\n\n        if (resizerEl) {\n            this.element.removeChild(resizerEl);\n        }\n        this.resizersAdded = false;\n    }\n\n    private getResizerElement(side: ResizableSides): HTMLElement | null {\n        return this.resizerMap![side].element;\n    }\n\n    private onResizeStart(e: MouseEvent, side: ResizableSides) {\n        this.boundaryEl = this.findBoundaryElement();\n\n        if (!this.positioned) { this.initialisePosition(); }\n\n        this.currentResizer = {\n            isTop: !!side.match(/top/i),\n            isRight: !!side.match(/right/i),\n            isBottom: !!side.match(/bottom/i),\n            isLeft: !!side.match(/left/i),\n        };\n\n        addCssClass(this.element, 'ag-resizing');\n        addCssClass(this.resizerMap![side].element, 'ag-active');\n\n        const { popup, forcePopupParentAsOffsetParent } = this.config;\n\n        if (!popup && !forcePopupParentAsOffsetParent) {\n            this.applySizeToSiblings(this.currentResizer.isBottom || this.currentResizer.isTop);\n        }\n\n        this.isResizing = true;\n        this.updateDragStartPosition(e.clientX, e.clientY);\n    }\n\n    private getSiblings(): HTMLElement[] | null {\n        const element = this.element;\n        const parent = element.parentElement;\n        if (!parent) { return null; }\n\n        return Array.prototype.slice.call(parent.children).filter((el: HTMLElement) => !containsClass(el, 'ag-hidden'));\n    }\n\n    private getMinSizeOfSiblings(): { height: number, width: number } {\n        const siblings = this.getSiblings() || [];\n\n        let height = 0;\n        let width = 0;\n\n        for (let i = 0; i < siblings.length; i++) {\n            const currentEl = siblings[i];\n            const isFlex = !!currentEl.style.flex && currentEl.style.flex !== '0 0 auto';\n\n            if (currentEl === this.element) { continue; }\n\n            let nextHeight = this.minHeight || 0;\n            let nextWidth = this.minWidth || 0;\n\n            if (isFlex) {\n                const computedStyle = window.getComputedStyle(currentEl);\n                if (computedStyle.minHeight) {\n                    nextHeight = parseInt(computedStyle.minHeight, 10);\n                }\n                if (computedStyle.minWidth) {\n                    nextWidth = parseInt(computedStyle.minWidth, 10);\n                }\n            } else {\n                nextHeight = currentEl.offsetHeight;\n                nextWidth = currentEl.offsetWidth;\n            }\n\n            height += nextHeight;\n            width += nextWidth;\n        }\n\n        return { height, width };\n    }\n\n    private applySizeToSiblings(vertical: boolean) {\n        let containerToFlex: HTMLElement | null = null;\n        const siblings = this.getSiblings();\n\n        if (!siblings) { return; }\n\n        for (let i = 0; i < siblings.length; i++) {\n            const el = siblings[i];\n\n            if (el === containerToFlex) { continue; }\n\n            if (vertical) {\n                el.style.height = `${el.offsetHeight}px`;\n            } else {\n                el.style.width = `${el.offsetWidth}px`;\n            }\n            el.style.flex = '0 0 auto';\n\n            if (el === this.element) {\n                containerToFlex = siblings[i + 1];\n            }\n        }\n\n        if (containerToFlex) {\n            containerToFlex.style.removeProperty('height');\n            containerToFlex.style.removeProperty('min-height');\n            containerToFlex.style.removeProperty('max-height');\n            containerToFlex.style.flex = '1 1 auto';\n        }\n    }\n\n    private onResize(e: MouseEvent) {\n        if (!this.isResizing || !this.currentResizer) { return; }\n\n        const { popup, forcePopupParentAsOffsetParent } = this.config;\n        const { isTop, isRight, isBottom, isLeft } = this.currentResizer;\n        const isHorizontal = isRight || isLeft;\n        const isVertical = isBottom || isTop;\n        const { movementX, movementY } = this.calculateMouseMovement({ e, isLeft, isTop });\n\n        const xPosition = this.position.x;\n        const yPosition = this.position.y;\n\n        let offsetLeft = 0;\n        let offsetTop = 0;\n\n        if (isHorizontal && movementX) {\n            const direction = isLeft ? -1 : 1;\n            const oldWidth = this.getWidth();\n            const newWidth = oldWidth! + (movementX * direction);\n            let skipWidth = false;\n\n            if (isLeft) {\n                offsetLeft = oldWidth! - newWidth;\n                if (xPosition + offsetLeft <= 0 || newWidth <= this.minWidth) {\n                    skipWidth = true;\n                    offsetLeft = 0;\n                }\n            }\n\n            if (!skipWidth) {\n                this.setWidth(newWidth);\n            }\n        }\n\n        if (isVertical && movementY) {\n            const direction = isTop ? -1 : 1;\n            const oldHeight = this.getHeight();\n            const newHeight = oldHeight! + (movementY * direction);\n            let skipHeight = false;\n\n            if (isTop) {\n                offsetTop = oldHeight! - newHeight;\n                if (yPosition + offsetTop <= 0 || newHeight <= this.minHeight!) {\n                    skipHeight = true;\n                    offsetTop = 0;\n                }\n            } else {\n                // do not let the size of all siblings be higher than the parent container\n                if (\n                    !this.config.popup &&\n                    !this.config.forcePopupParentAsOffsetParent &&\n                    oldHeight! < newHeight &&\n                    (this.getMinSizeOfSiblings().height + newHeight) > this.element.parentElement!.offsetHeight\n                ) {\n                    skipHeight = true;\n                }\n            }\n\n            if (!skipHeight) {\n                this.setHeight(newHeight);\n            }\n        }\n\n        this.updateDragStartPosition(e.clientX, e.clientY);\n\n        if ((popup || forcePopupParentAsOffsetParent) && offsetLeft || offsetTop) {\n            this.offsetElement(\n                xPosition + offsetLeft,\n                yPosition + offsetTop\n            );\n        }\n    }\n\n    private onResizeEnd(e: MouseEvent, side: ResizableSides) {\n        this.isResizing = false;\n        this.currentResizer = null;\n        this.boundaryEl = null;\n\n        const params = {\n            type: 'resize',\n            api: this.gridOptionsWrapper.getApi(),\n            columnApi: this.gridOptionsWrapper.getColumnApi()\n        };\n\n        removeCssClass(this.element, 'ag-resizing');\n        removeCssClass(this.resizerMap![side].element, 'ag-active');\n\n        this.dispatchEvent(params);\n    }\n\n    private refreshSize() {\n        const eGui = this.element;\n\n        if (this.config.popup) {\n            if (!this.config.width) {\n                this.setWidth(eGui.offsetWidth);\n            }\n\n            if (!this.config.height) {\n                this.setHeight(eGui.offsetHeight);\n            }\n        }\n    }\n\n    private onMoveStart(e: MouseEvent) {\n        this.boundaryEl = this.findBoundaryElement();\n\n        if (!this.positioned) { this.initialisePosition(); }\n\n        this.isMoving = true;\n\n        addCssClass(this.element, 'ag-moving');\n        this.updateDragStartPosition(e.clientX, e.clientY);\n    }\n\n    private onMove(e: MouseEvent) {\n        if (!this.isMoving) { return; }\n\n        const { x, y } = this.position;\n        let topBuffer;\n\n        if (this.config.calculateTopBuffer) {\n            topBuffer = this.config.calculateTopBuffer();\n        }\n\n        const { movementX, movementY } = this.calculateMouseMovement({\n            e,\n            isTop: true,\n            anywhereWithin: true,\n            topBuffer\n        });\n\n        this.offsetElement(x + movementX, y + movementY);\n        this.updateDragStartPosition(e.clientX, e.clientY);\n    }\n\n    private onMoveEnd() {\n        this.isMoving = false;\n        this.boundaryEl = null;\n        removeCssClass(this.element, 'ag-moving');\n    }\n\n    private setOffsetParent() {\n        if (this.config.forcePopupParentAsOffsetParent) {\n            this.offsetParent = this.popupService.getPopupParent();\n        } else {\n            this.offsetParent = this.element.offsetParent as HTMLElement;\n        }\n    }\n\n    private findBoundaryElement(): HTMLElement {\n        let el = this.element;\n        while (el) {\n            if (window.getComputedStyle(el).position !== 'static') { return el; }\n            el = el.parentElement as HTMLElement;\n        }\n\n        return this.element;\n    }\n\n    private clearResizeListeners(): void {\n        while (this.resizeListeners.length) {\n            const params = this.resizeListeners.pop()!;\n            this.dragService.removeDragSource(params);\n        }\n    }\n\n    protected destroy() {\n        super.destroy();\n\n        if (this.moveElementDragListener) {\n            this.dragService.removeDragSource(this.moveElementDragListener);\n        }\n\n        this.clearResizeListeners();\n        this.removeResizers();\n    }\n}"]}