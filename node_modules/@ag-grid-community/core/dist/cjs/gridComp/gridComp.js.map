{"version":3,"sources":["../../src/ts/gridComp/gridComp.ts"],"names":[],"mappings":"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","file":"gridComp.js","sourcesContent":["import { GridBodyComp } from \"../gridBodyComp/gridBodyComp\";\nimport { Logger, LoggerFactory } from \"../logger\";\nimport { Autowired, PostConstruct } from \"../context/context\";\nimport { Component } from \"../widgets/component\";\nimport { ISideBar } from \"../interfaces/iSideBar\";\nimport { RefSelector } from \"../widgets/componentAnnotations\";\nimport { addCssClass, addOrRemoveCssClass, isVisible } from \"../utils/dom\";\nimport { FocusService } from \"../focusService\";\nimport { GridCtrl, IGridComp } from \"./gridCtrl\";\nimport { LayoutCssClasses, UpdateLayoutClassesParams } from \"../styling/layoutFeature\";\nimport { TabGuardComp } from \"../widgets/tabGuardComp\";\n\nexport class GridComp extends TabGuardComp {\n\n    @Autowired('loggerFactory') private readonly loggerFactory: LoggerFactory;\n\n    @RefSelector('gridBody') private readonly gridBodyComp: GridBodyComp;\n    @RefSelector('sideBar') private readonly sideBarComp: ISideBar & Component;\n    @RefSelector('rootWrapperBody') private readonly eRootWrapperBody: HTMLElement;\n\n    private logger: Logger;\n    private eGridDiv: HTMLElement;\n    private ctrl: GridCtrl;\n\n    constructor(eGridDiv: HTMLElement) {\n        super(undefined);\n        this.eGridDiv = eGridDiv;\n    }\n\n    @PostConstruct\n    private postConstruct(): void {\n        this.logger = this.loggerFactory.create('GridComp');\n\n        const compProxy: IGridComp = {\n            destroyGridUi:\n                () => this.destroyBean(this),\n            setRtlClass:\n                (cssClass: string) => addCssClass(this.getGui(), cssClass),\n            addOrRemoveKeyboardFocusClass:\n                (addOrRemove: boolean) => this.addOrRemoveCssClass(FocusService.AG_KEYBOARD_FOCUS, addOrRemove),\n            forceFocusOutOfContainer: this.forceFocusOutOfContainer.bind(this),\n            updateLayoutClasses: this.updateLayoutClasses.bind(this),\n            getFocusableContainers: this.getFocusableContainers.bind(this),\n            setUserSelect: value => {\n                this.getGui().style.userSelect = value != null ? value : '';\n                this.getGui().style.webkitUserSelect = value != null ? value : '';\n            },\n            setCursor: value => {\n                this.getGui().style.cursor = value != null ? value : '';\n            }\n        };\n\n        this.ctrl = this.createManagedBean(new GridCtrl());\n\n        const template = this.createTemplate();\n        this.setTemplate(template);\n\n        this.ctrl.setComp(compProxy, this.eGridDiv, this.getGui());\n\n        this.insertGridIntoDom();\n\n        this.initialiseTabGuard({\n            // we want to override the default behaviour to do nothing for onTabKeyDown\n            onTabKeyDown: () => undefined,\n            focusInnerElement: fromBottom => this.ctrl.focusInnerElement(fromBottom)\n        });\n    }\n\n    private insertGridIntoDom(): void {\n        const eGui = this.getGui();\n        this.eGridDiv.appendChild(eGui);\n        this.addDestroyFunc(() => {\n            this.eGridDiv.removeChild(eGui);\n            this.logger.log('Grid removed from DOM');\n        });\n    }\n\n    private updateLayoutClasses(cssClass: string, params: UpdateLayoutClassesParams): void {\n        addOrRemoveCssClass(this.eRootWrapperBody, LayoutCssClasses.AUTO_HEIGHT, params.autoHeight);\n        addOrRemoveCssClass(this.eRootWrapperBody, LayoutCssClasses.NORMAL, params.normal);\n        addOrRemoveCssClass(this.eRootWrapperBody, LayoutCssClasses.PRINT, params.print);\n\n        this.addOrRemoveCssClass(LayoutCssClasses.AUTO_HEIGHT, params.autoHeight);\n        this.addOrRemoveCssClass(LayoutCssClasses.NORMAL, params.normal);\n        this.addOrRemoveCssClass(LayoutCssClasses.PRINT, params.print);\n    }\n\n    private createTemplate(): string {\n        const dropZones = this.ctrl.showDropZones() ? '<ag-grid-header-drop-zones></ag-grid-header-drop-zones>' : '';\n        const sideBar = this.ctrl.showSideBar() ? '<ag-side-bar ref=\"sideBar\"></ag-side-bar>' : '';\n        const statusBar = this.ctrl.showStatusBar() ? '<ag-status-bar ref=\"statusBar\"></ag-status-bar>' : '';\n        const watermark = this.ctrl.showWatermark() ? '<ag-watermark></ag-watermark>' : '';\n\n        const template = /* html */\n            `<div class=\"ag-root-wrapper\">\n                ${dropZones}\n                <div class=\"ag-root-wrapper-body\" ref=\"rootWrapperBody\">\n                    <ag-grid-body ref=\"gridBody\"></ag-grid-body>\n                    ${sideBar}\n                </div>\n                ${statusBar}\n                <ag-pagination></ag-pagination>\n                ${watermark}\n            </div>`;\n\n        return template;\n    }\n\n    public getFocusableElement(): HTMLElement {\n        return this.eRootWrapperBody;\n    }\n\n    protected getFocusableContainers(): HTMLElement[] {\n        const focusableContainers = [\n            this.gridBodyComp.getGui()\n        ];\n\n        if (this.sideBarComp) {\n            focusableContainers.push(\n                this.sideBarComp.getGui()\n            );\n        }\n\n        return focusableContainers.filter(el => isVisible(el));\n    }\n\n}\n"]}