{"version":3,"sources":["reactUi/header/headerFilterCellComp.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,6CAAmG;AACnG,gDAA+C;AAC/C,gDAA6J;AAC7J,kCAA4D;AAC5D,oCAAuC;AAEvC,IAAM,oBAAoB,GAAG,UAAC,KAAmC;IAEtD,IAAA,iEAAO,CAA6B;IAErC,IAAA,+CAAoE,EAAnE,kBAAU,EAAE,qBAAuD,CAAC;IACrE,IAAA,+CAA4E,EAA3E,sBAAc,EAAE,yBAA2D,CAAC;IAC7E,IAAA,+CAA8F,EAA7F,+BAAuB,EAAE,kCAAoE,CAAC;IAC/F,IAAA,uBAAsC,EAArC,aAAK,EAAE,gBAA8B,CAAC;IACvC,IAAA,uBAAmE,EAAlE,uBAAe,EAAE,0BAAiD,CAAC;IAE1E,IAAM,IAAI,GAAG,cAAM,CAAiB,IAAI,CAAC,CAAC;IAC1C,IAAM,mBAAmB,GAAG,cAAM,CAAiB,IAAI,CAAC,CAAC;IACzD,IAAM,cAAc,GAAG,cAAM,CAAiB,IAAI,CAAC,CAAC;IACpD,IAAM,qBAAqB,GAAG,cAAM,CAAoB,IAAI,CAAC,CAAC;IAC9D,IAAM,WAAW,GAAG,cAAM,EAAmB,CAAC;IAEtC,IAAA,iBAAI,CAAW;IAEvB,iBAAS,CAAC;QAEN,IAAM,SAAS,GAA0B;YACrC,mBAAmB,EAAE,UAAC,IAAI,EAAE,EAAE,IAAK,OAAA,aAAa,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,EAAvB,CAAuB,CAAC,EAA9C,CAA8C;YACjF,uBAAuB,EAAE,UAAC,IAAI,EAAE,EAAE,IAAK,OAAA,iBAAiB,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,EAAvB,CAAuB,CAAC,EAAlD,CAAkD;YACzF,gCAAgC,EAAE,UAAC,IAAI,EAAE,EAAE,IAAK,OAAA,0BAA0B,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,EAAvB,CAAuB,CAAC,EAA3D,CAA2D;YAC3G,QAAQ,EAAE,UAAA,KAAK,IAAI,OAAA,QAAQ,CAAC,KAAK,CAAC,EAAf,CAAe;YAClC,cAAc,EAAE,UAAA,WAAW,IAAI,OAAA,kBAAkB,CAAC,WAAW,CAAC,EAA/B,CAA+B;YAC9D,qBAAqB,EAAE,cAAK,OAAA,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,gBAAS,CAAC,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,EAAnE,CAAmE;YAC/F,WAAW,EAAE,UAAA,KAAK,IAAI,OAAA,qBAAqB,CAAC,OAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,EAAjD,CAAiD;SAC1E,CAAC;QAEF,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,OAAQ,EAAE,qBAAqB,CAAC,OAAQ,EAAE,mBAAmB,CAAC,OAAQ,CAAC,CAAC;IAEzG,CAAC,EAAE,EAAE,CAAC,CAAC;IAEP,WAAW;IACX,iBAAS,CAAC;QACN,OAAO,mBAAU,CAAC,eAAe,EAAE,OAAO,EAAE,mBAAmB,CAAC,OAAQ,EAAE,WAAW,CAAC,CAAC;IAC3F,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC;IAEtB,IAAM,KAAK,GAAG,eAAO,CAAE,cAAK,OAAA,CAAC;QACzB,KAAK,EAAE,KAAK;KACf,CAAC,EAF0B,CAE1B,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;IAEb,IAAM,SAAS,GAAG,eAAO,CAAE,cAAK,OAAA,oCAAoC,GAAG,UAAU,CAAC,QAAQ,EAAE,EAA5D,CAA4D,EAAE,CAAC,UAAU,CAAC,CAAE,CAAC;IAC7G,IAAM,aAAa,GAAG,eAAO,CAAE,cAAK,OAAA,cAAc,CAAC,QAAQ,EAAE,EAAzB,CAAyB,EAAE,CAAC,cAAc,CAAC,CAAE,CAAC;IAClF,IAAM,sBAAsB,GAAG,eAAO,CAAE,cAAK,OAAA,4BAA4B,GAAG,uBAAuB,CAAC,QAAQ,EAAE,EAAjE,CAAiE,EAAE,CAAC,cAAc,CAAC,CAAE,CAAC;IAEnI,IAAM,iBAAiB,GAAG,eAAO,CAAE;QAC/B,IAAM,GAAG,GAAG,eAAe;eACZ,eAAe,CAAC,sBAAsB;eACtC,4BAAoB,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC;QACpE,OAAO,CAAC,CAAC,GAAG,CAAC;IACjB,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC;IAEtB,IAAM,aAAa,GAAG,eAAe,IAAI,eAAe,CAAC,sBAAsB,CAAC;IAChF,IAAM,aAAa,GAAG,eAAe,IAAI,eAAe,CAAC,cAAc,CAAC;IAExE,OAAO,CACH,uCAAK,GAAG,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAC,UAAU,EAAC,QAAQ,EAAE,CAAC,CAAC;QAC5E,uCAAK,GAAG,EAAE,mBAAmB,EAAE,SAAS,EAAE,aAAa,EAAE,IAAI,EAAC,cAAc;YACtE,aAAa,IAAI,iBAAiB,IAAI,8BAAC,aAAa,eAAM,eAAgB,CAAC,MAAM,EAAK;YACtF,aAAa,IAAI,CAAC,iBAAiB,IAAI,8BAAC,aAAa,eAAM,eAAgB,CAAC,MAAM,IAAG,GAAG,EAAG,WAAW,IAAI,CAC1G;QACN,uCAAK,GAAG,EAAE,cAAc,EAAE,SAAS,EAAE,sBAAsB,EAAE,IAAI,EAAC,cAAc;YAC5E,0CAAQ,GAAG,EAAE,qBAAqB,EAAE,IAAI,EAAC,QAAQ,gBAAY,kBAAkB,EAAC,SAAS,EAAC,kCAAkC,EAAC,QAAQ,EAAE,CAAC,CAAC,GAAW,CAClJ,CACJ,CACT,CAAC;AACN,CAAC,CAAC;AAEF,kBAAe,YAAI,CAAC,oBAAoB,CAAC,CAAC","file":"headerFilterCellComp.js","sourcesContent":["import React, { memo, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { BeansContext } from '../beansContext';\nimport { AgPromise, ColumnSortState, HeaderFilterCellCtrl, IFloatingFilter, IHeader, IHeaderFilterCellComp, UserCompDetails } from '@ag-grid-community/core';\nimport { CssClasses, isComponentStateless } from '../utils';\nimport { showJsComp } from '../jsComp';\n\nconst HeaderFilterCellComp = (props: {ctrl: HeaderFilterCellCtrl}) => {\n\n    const {context} = useContext(BeansContext);\n\n    const [cssClasses, setCssClasses] = useState<CssClasses>(new CssClasses());\n    const [cssBodyClasses, setBodyCssClasses] = useState<CssClasses>(new CssClasses());\n    const [cssButtonWrapperClasses, setButtonWrapperCssClasses] = useState<CssClasses>(new CssClasses());\n    const [width, setWidth] = useState<string>();\n    const [userCompDetails, setUserCompDetails] = useState<UserCompDetails>();\n\n    const eGui = useRef<HTMLDivElement>(null);\n    const eFloatingFilterBody = useRef<HTMLDivElement>(null);\n    const eButtonWrapper = useRef<HTMLDivElement>(null);\n    const eButtonShowMainFilter = useRef<HTMLButtonElement>(null);\n    const userCompRef = useRef<IFloatingFilter>();\n\n    const { ctrl } = props;\n\n    useEffect(() => {\n\n        const compProxy: IHeaderFilterCellComp = {\n            addOrRemoveCssClass: (name, on) => setCssClasses(prev => prev.setClass(name, on)),\n            addOrRemoveBodyCssClass: (name, on) => setBodyCssClasses(prev => prev.setClass(name, on)),\n            addOrRemoveButtonWrapperCssClass: (name, on) => setButtonWrapperCssClasses(prev => prev.setClass(name, on)),\n            setWidth: width => setWidth(width),\n            setCompDetails: compDetails => setUserCompDetails(compDetails),\n            getFloatingFilterComp: ()=> userCompRef.current ? AgPromise.resolve(userCompRef.current) : null,\n            setMenuIcon: eIcon => eButtonShowMainFilter.current!.appendChild(eIcon)\n        };\n\n        ctrl.setComp(compProxy, eGui.current!, eButtonShowMainFilter.current!, eFloatingFilterBody.current!);\n\n    }, []);\n\n    // js comps\n    useEffect(() => {\n        return showJsComp(userCompDetails, context, eFloatingFilterBody.current!, userCompRef);\n    }, [userCompDetails]);\n\n    const style = useMemo( ()=> ({\n        width: width\n    }), [width]);\n    \n    const className = useMemo( ()=> 'ag-header-cell ag-floating-filter ' + cssClasses.toString(), [cssClasses] );\n    const bodyClassName = useMemo( ()=> cssBodyClasses.toString(), [cssBodyClasses] );\n    const buttonWrapperClassName = useMemo( ()=> 'ag-floating-filter-button ' + cssButtonWrapperClasses.toString(), [cssBodyClasses] );\n\n    const userCompStateless = useMemo( ()=> {\n        const res = userCompDetails \n                    && userCompDetails.componentFromFramework \n                    && isComponentStateless(userCompDetails.componentClass);\n        return !!res;\n    }, [userCompDetails]);\n\n    const reactUserComp = userCompDetails && userCompDetails.componentFromFramework;\n    const UserCompClass = userCompDetails && userCompDetails.componentClass;\n\n    return (\n        <div ref={eGui} className={className} style={style} role=\"gridcell\" tabIndex={-1}>\n            <div ref={eFloatingFilterBody} className={bodyClassName} role=\"presentation\">\n                { reactUserComp && userCompStateless && <UserCompClass { ...userCompDetails!.params } /> }\n                { reactUserComp && !userCompStateless && <UserCompClass { ...userCompDetails!.params } ref={ userCompRef }/> }\n            </div>\n            <div ref={eButtonWrapper} className={buttonWrapperClassName} role=\"presentation\">\n                <button ref={eButtonShowMainFilter} type=\"button\" aria-label=\"Open Filter Menu\" className=\"ag-floating-filter-button-button\" tabIndex={-1}></button>\n            </div>\n        </div>\n    );\n};\n\nexport default memo(HeaderFilterCellComp);"]}