{"version":3,"sources":["reactUi/header/headerRowComp.tsx"],"names":[],"mappings":"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","file":"headerRowComp.js","sourcesContent":["import { AbstractHeaderCellCtrl, HeaderGroupCellCtrl, HeaderCellCtrl, HeaderFilterCellCtrl, HeaderRowCtrl, HeaderRowType, IHeaderRowComp, _ } from '@ag-grid-community/core';\nimport React, { memo, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { BeansContext } from '../beansContext';\nimport HeaderCellComp from './headerCellComp';\nimport HeaderGroupCellComp from './headerGroupCellComp';\nimport HeaderFilterCellComp from './headerFilterCellComp';\n\nconst HeaderRowComp = (props: {ctrl: HeaderRowCtrl}) => {\n\n    const {gridOptionsWrapper} = useContext(BeansContext);\n\n    const [ transform, setTransform ] = useState<string>();\n    const [ height, setHeight ] = useState<string>();\n    const [ top, setTop ] = useState<string>();\n    const [ width, setWidth ] = useState<string>();\n    const [ ariaRowIndex, setAriaRowIndex ] = useState<number>();\n    const [ cellCtrls, setCellCtrls ] = useState<AbstractHeaderCellCtrl[]>([]);\n\n    const eGui = useRef<HTMLDivElement>(null);\n\n    const { ctrl } = props;\n\n    const typeColumn = ctrl.getType() === HeaderRowType.COLUMN;\n    const typeGroup = ctrl.getType() === HeaderRowType.COLUMN_GROUP;\n    const typeFilter = ctrl.getType() === HeaderRowType.FLOATING_FILTER;\n\n    const setCellCtrlsMaintainOrder = useCallback( (prev: AbstractHeaderCellCtrl[], next: AbstractHeaderCellCtrl[]) => {\n\n        // if we are ensuring dom order, we set the ctrls into the dom in the same order they appear on screen\n        if (gridOptionsWrapper.isEnsureDomOrder()) {\n            return next;\n        }\n\n        // if not maintaining order, we want to keep the dom elements we have and add new ones to the end,\n        // otherwise we will loose transition effects as elements are placed in different dom locations\n        const prevMap = _.mapById(prev, c => c.getInstanceId());\n        const nextMap = _.mapById(next, c => c.getInstanceId());\n\n        const oldCtrlsWeAreKeeping = prev.filter( c => nextMap.has(c.getInstanceId()) );\n        const newCtrls = next.filter( c => !prevMap.has(c.getInstanceId()) )\n\n        return [...oldCtrlsWeAreKeeping, ...newCtrls];\n    }, []);\n\n    useEffect(() => {\n\n        const compProxy: IHeaderRowComp = {\n            setTransform: transform => setTransform(transform),\n            setHeight: height => setHeight(height),\n            setTop: top => setTop(top),\n            setHeaderCtrls: ctrls => setCellCtrls(prev => setCellCtrlsMaintainOrder(prev, ctrls)),\n            setWidth: width => setWidth(width),\n            setAriaRowIndex: rowIndex => setAriaRowIndex(rowIndex)\n        };\n\n        ctrl.setComp(compProxy);\n\n    }, []);\n\n    const style = useMemo( ()=> ({\n        transform: transform,\n        height: height,\n        top: top,\n        width: width\n    }), [transform, height, top, width]);\n\n    const className = useMemo( ()=> {\n        const res: string[] = [`ag-header-row`];\n        \n        typeColumn && res.push(`ag-header-row-column`);\n        typeGroup && res.push(`ag-header-row-column-group`);\n        typeFilter && res.push(`ag-header-row-column-filter`);\n\n        return res.join(' ');\n    }, []);\n\n    const createCellJsx = useCallback( (cellCtrl: AbstractHeaderCellCtrl) => {\n        switch (ctrl.getType()) {\n            case HeaderRowType.COLUMN_GROUP :\n                return <HeaderGroupCellComp ctrl={cellCtrl as HeaderGroupCellCtrl} key={cellCtrl.getInstanceId()} />;\n\n            case HeaderRowType.FLOATING_FILTER :\n                return <HeaderFilterCellComp ctrl={cellCtrl as HeaderFilterCellCtrl} key={cellCtrl.getInstanceId()} />;\n                \n            default :\n                return <HeaderCellComp ctrl={cellCtrl as HeaderCellCtrl} key={cellCtrl.getInstanceId()} />;\n        }\n    }, []);\n\n    // below, we are not doing floating filters, not yet\n    return (\n        <div ref={eGui} className={className} role=\"row\" style={style} aria-rowindex={ariaRowIndex}>\n            { cellCtrls.map( createCellJsx ) }\n        </div>\n    );\n};\n\nexport default memo(HeaderRowComp);\n"]}